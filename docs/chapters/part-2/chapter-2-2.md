# Ğ“Ğ»Ğ°Ğ²Ğ° 2.2: Ğ¤Ğ¾Ñ€Ğ¼Ñ‹ Ğ¸ Ğ²Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ñ

## ĞĞ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ° Ñ„Ğ¾Ñ€Ğ¼, Ñ„Ğ¸Ğ»ÑŒÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ, ÑĞ°Ğ½Ğ¸Ñ‚Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…

---

## ĞŸĞ¾Ñ‡ĞµĞ¼Ñƒ Ğ²Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ñ ĞºÑ€Ğ¸Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸ Ğ²Ğ°Ğ¶Ğ½Ğ°?

Ğ”Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ¾Ñ‚ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ â€” ÑÑ‚Ğ¾ **Ğ³Ğ»Ğ°Ğ²Ğ½Ñ‹Ğ¹ Ğ¸ÑÑ‚Ğ¾Ñ‡Ğ½Ğ¸Ğº ÑƒĞ³Ñ€Ğ¾Ğ·** Ğ´Ğ»Ñ Ğ²ĞµĞ±-Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ. ĞĞ¸ĞºĞ¾Ğ³Ğ´Ğ° Ğ½Ğµ Ğ´Ğ¾Ğ²ĞµÑ€ÑĞ¹ Ğ²Ñ…Ğ¾Ğ´Ğ½Ñ‹Ğ¼ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğ¼!

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Ğ—ĞĞ§Ğ•Ğœ ĞĞ£Ğ–ĞĞ Ğ’ĞĞ›Ğ˜Ğ”ĞĞ¦Ğ˜Ğ¯                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚   ğŸ›¡ï¸ Ğ‘ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾ÑÑ‚ÑŒ      SQL-Ğ¸Ğ½ÑŠĞµĞºÑ†Ğ¸Ğ¸, XSS, Ğ¸Ğ½ÑŠĞµĞºÑ†Ğ¸Ğ¸ ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´      â”‚
â”‚   ğŸ“Š Ğ¦ĞµĞ»Ğ¾ÑÑ‚Ğ½Ğ¾ÑÑ‚ÑŒ       ĞšĞ¾Ñ€Ñ€ĞµĞºÑ‚Ğ½Ñ‹Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ² Ğ±Ğ°Ğ·Ğµ                â”‚
â”‚   ğŸ’¡ UX               ĞŸĞ¾Ğ½ÑÑ‚Ğ½Ñ‹Ğµ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ñ Ğ¾Ğ± Ğ¾ÑˆĞ¸Ğ±ĞºĞ°Ñ…            â”‚
â”‚   ğŸ”„ ĞĞ°Ğ´Ñ‘Ğ¶Ğ½Ğ¾ÑÑ‚ÑŒ       ĞŸÑ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğµ Ğ½Ğµ Ğ¿Ğ°Ğ´Ğ°ĞµÑ‚ Ğ¾Ñ‚ Ğ¼ÑƒÑĞ¾Ñ€Ğ°           â”‚
â”‚   ğŸ“ˆ SEO              Ğ’Ğ°Ğ»Ğ¸Ğ´Ğ½Ñ‹Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ = Ğ²Ğ°Ğ»Ğ¸Ğ´Ğ½Ñ‹Ğ¹ ĞºĞ¾Ğ½Ñ‚ĞµĞ½Ñ‚       â”‚
â”‚                                                                 â”‚
â”‚   "Ğ”Ğ¾Ğ²ĞµÑ€ÑĞ¹, Ğ½Ğ¾ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ÑĞ¹" â€” ĞĞ• Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚ Ğ² Ğ²ĞµĞ±-Ñ€Ğ°Ğ·Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞµ!       â”‚
â”‚   ĞŸÑ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ğ¾: "ĞĞµ Ğ´Ğ¾Ğ²ĞµÑ€ÑĞ¹. ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑĞ¹. Ğ’ÑĞµĞ³Ğ´Ğ°."                   â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 1. Ğ¢Ñ€Ğ¸ ÑÑ‚Ğ°Ğ¿Ğ° Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ¸ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                  â”‚
â”‚   Ğ’Ğ¥ĞĞ”ĞĞ«Ğ• Ğ”ĞĞĞĞ«Ğ•                                                â”‚
â”‚        â†“                                                        â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                            â”‚
â”‚   â”‚  Ğ¤Ğ˜Ğ›Ğ¬Ğ¢Ğ ĞĞ¦Ğ˜Ğ¯    â”‚  ĞŸÑ€Ğ¸Ğ²ĞµĞ´ĞµĞ½Ğ¸Ğµ Ğº Ğ½ÑƒĞ¶Ğ½Ğ¾Ğ¼Ñƒ Ñ‚Ğ¸Ğ¿Ñƒ                 â”‚
â”‚   â”‚  (Filtering)   â”‚  Ğ£Ğ´Ğ°Ğ»ĞµĞ½Ğ¸Ğµ Ğ»Ğ¸ÑˆĞ½Ğ¸Ñ… ÑĞ¸Ğ¼Ğ²Ğ¾Ğ»Ğ¾Ğ²                  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                            â”‚
â”‚           â†“                                                     â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                            â”‚
â”‚   â”‚  Ğ’ĞĞ›Ğ˜Ğ”ĞĞ¦Ğ˜Ğ¯     â”‚  ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ½Ğ° ÑĞ¾Ğ¾Ñ‚Ğ²ĞµÑ‚ÑÑ‚Ğ²Ğ¸Ğµ Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»Ğ°Ğ¼         â”‚
â”‚   â”‚  (Validation)  â”‚  Ğ’Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‚ Ğ¾ÑˆĞ¸Ğ±Ğ¾Ğº ĞµÑĞ»Ğ¸ Ğ½Ğµ Ğ¿Ñ€Ğ¾ÑˆĞ»Ğ¾             â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                            â”‚
â”‚           â†“                                                     â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                            â”‚
â”‚   â”‚  Ğ¡ĞĞĞ˜Ğ¢Ğ˜Ğ—ĞĞ¦Ğ˜Ğ¯   â”‚  Ğ­ĞºÑ€Ğ°Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ´Ğ»Ñ Ğ±ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾Ğ³Ğ¾             â”‚
â”‚   â”‚  (Sanitization)â”‚  Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ (Ğ²Ñ‹Ğ²Ğ¾Ğ´, Ğ‘Ğ”, Ñ„Ğ°Ğ¹Ğ»Ñ‹)          â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                            â”‚
â”‚           â†“                                                     â”‚
â”‚   Ğ‘Ğ•Ğ—ĞĞŸĞĞ¡ĞĞ«Ğ• Ğ”ĞĞĞĞ«Ğ•                                             â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Ğ Ğ°Ğ·Ğ½Ğ¸Ñ†Ğ° Ğ¼ĞµĞ¶Ğ´Ñƒ Ğ¿Ğ¾Ğ½ÑÑ‚Ğ¸ÑĞ¼Ğ¸

```php
<?php
$input = "  <script>alert('XSS')</script>  123abc  ";

// Ğ¤Ğ˜Ğ›Ğ¬Ğ¢Ğ ĞĞ¦Ğ˜Ğ¯ â€” Ğ¿Ñ€Ğ¸Ğ²ĞµĞ´ĞµĞ½Ğ¸Ğµ Ğº Ğ½ÑƒĞ¶Ğ½Ğ¾Ğ¼Ñƒ Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚Ñƒ
$filtered = trim($input);           // Ğ£Ğ±Ñ€Ğ°Ñ‚ÑŒ Ğ¿Ñ€Ğ¾Ğ±ĞµĞ»Ñ‹
$filtered = preg_replace('/\D/', '', $input);  // ĞÑÑ‚Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ñ†Ğ¸Ñ„Ñ€Ñ‹: "123"

// Ğ’ĞĞ›Ğ˜Ğ”ĞĞ¦Ğ˜Ğ¯ â€” Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ½Ğ° ÑĞ¾Ğ¾Ñ‚Ğ²ĞµÑ‚ÑÑ‚Ğ²Ğ¸Ğµ Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»Ğ°Ğ¼
$isValid = is_numeric($input);      // false
$isValid = strlen($input) <= 100;   // true

// Ğ¡ĞĞĞ˜Ğ¢Ğ˜Ğ—ĞĞ¦Ğ˜Ğ¯ â€” Ğ¿Ğ¾Ğ´Ğ³Ğ¾Ñ‚Ğ¾Ğ²ĞºĞ° Ğ´Ğ»Ñ Ğ±ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾Ğ³Ğ¾ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ
$sanitized = htmlspecialchars($input);  // Ğ”Ğ»Ñ HTML Ğ²Ñ‹Ğ²Ğ¾Ğ´Ğ°
$sanitized = addslashes($input);        // âŒ ĞĞµ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞ¹ Ğ´Ğ»Ñ SQL!
// Ğ”Ğ»Ñ SQL Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞ¹ prepared statements
```

---

## 2. Ğ¤Ğ¸Ğ»ÑŒÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…

### Ğ‘Ğ°Ğ·Ğ¾Ğ²Ñ‹Ğµ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¸ Ğ¾Ñ‡Ğ¸ÑÑ‚ĞºĞ¸

```php
<?php
// trim â€” ÑƒĞ´Ğ°Ğ»ĞµĞ½Ğ¸Ğµ Ğ¿Ñ€Ğ¾Ğ±ĞµĞ»Ğ¾Ğ² Ğ¿Ğ¾ ĞºÑ€Ğ°ÑĞ¼
$name = trim($_POST['name']);           // "  Ğ˜Ğ²Ğ°Ğ½  " â†’ "Ğ˜Ğ²Ğ°Ğ½"
$name = trim($_POST['name'], " \t\n");  // Ğ£ĞºĞ°Ğ·Ğ°Ñ‚ÑŒ ÑĞ¸Ğ¼Ğ²Ğ¾Ğ»Ñ‹ Ğ´Ğ»Ñ ÑƒĞ´Ğ°Ğ»ĞµĞ½Ğ¸Ñ

// ĞŸÑ€Ğ¸Ğ²ĞµĞ´ĞµĞ½Ğ¸Ğµ Ñ‚Ğ¸Ğ¿Ğ¾Ğ²
$age = (int) $_POST['age'];             // "25abc" â†’ 25
$price = (float) $_POST['price'];       // "99.99Ñ€ÑƒĞ±" â†’ 99.99
$active = (bool) $_POST['active'];      // "1" â†’ true

// Ğ£Ğ´Ğ°Ğ»ĞµĞ½Ğ¸Ğµ HTML Ñ‚ĞµĞ³Ğ¾Ğ²
$text = strip_tags($_POST['bio']);
$text = strip_tags($_POST['bio'], '<p><br><b><i>');  // Ğ Ğ°Ğ·Ñ€ĞµÑˆĞ¸Ñ‚ÑŒ Ğ½ĞµĞºĞ¾Ñ‚Ğ¾Ñ€Ñ‹Ğµ

// ĞŸÑ€Ğ¸Ğ²ĞµĞ´ĞµĞ½Ğ¸Ğµ Ğº Ğ½Ğ¸Ğ¶Ğ½ĞµĞ¼Ñƒ/Ğ²ĞµÑ€Ñ…Ğ½ĞµĞ¼Ñƒ Ñ€ĞµĞ³Ğ¸ÑÑ‚Ñ€Ñƒ
$email = strtolower(trim($_POST['email']));
$code = strtoupper(trim($_POST['code']));

// Ğ£Ğ´Ğ°Ğ»ĞµĞ½Ğ¸Ğµ Ğ¼Ğ½Ğ¾Ğ¶ĞµÑÑ‚Ğ²ĞµĞ½Ğ½Ñ‹Ñ… Ğ¿Ñ€Ğ¾Ğ±ĞµĞ»Ğ¾Ğ²
$text = preg_replace('/\s+/', ' ', $text);

// ĞÑÑ‚Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ñ†Ğ¸Ñ„Ñ€Ñ‹
$phone = preg_replace('/\D/', '', $_POST['phone']);

// ĞÑÑ‚Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ğ±ÑƒĞºĞ²Ñ‹ Ğ¸ Ñ†Ğ¸Ñ„Ñ€Ñ‹
$username = preg_replace('/[^a-zA-Z0-9_]/', '', $_POST['username']);
```

### filter_var â€” Ñ„Ğ¸Ğ»ÑŒÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ Ñ Ñ„Ğ»Ğ°Ğ³Ğ°Ğ¼Ğ¸

```php
<?php
// FILTER_SANITIZE_* â€” Ğ¾Ñ‡Ğ¸ÑÑ‚ĞºĞ° Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…

// Email â€” ÑƒĞ±Ñ€Ğ°Ñ‚ÑŒ Ğ²ÑĞµ ÑĞ¸Ğ¼Ğ²Ğ¾Ğ»Ñ‹ ĞºÑ€Ğ¾Ğ¼Ğµ Ğ´Ğ¾Ğ¿ÑƒÑÑ‚Ğ¸Ğ¼Ñ‹Ñ… Ğ² email
$email = filter_var($_POST['email'], FILTER_SANITIZE_EMAIL);
// "john doe@exam ple.com" â†’ "johndoe@example.com"

// URL â€” ÑƒĞ±Ñ€Ğ°Ñ‚ÑŒ Ğ½ĞµĞ´Ğ¾Ğ¿ÑƒÑÑ‚Ğ¸Ğ¼Ñ‹Ğµ ÑĞ¸Ğ¼Ğ²Ğ¾Ğ»Ñ‹
$url = filter_var($_POST['url'], FILTER_SANITIZE_URL);

// Ğ¡Ñ‚Ñ€Ğ¾ĞºĞ° â€” ÑƒĞ±Ñ€Ğ°Ñ‚ÑŒ Ğ¸Ğ»Ğ¸ Ğ·Ğ°ĞºĞ¾Ğ´Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ ÑĞ¿ĞµÑ†Ğ¸Ğ°Ğ»ÑŒĞ½Ñ‹Ğµ ÑĞ¸Ğ¼Ğ²Ğ¾Ğ»Ñ‹
$name = filter_var($_POST['name'], FILTER_SANITIZE_STRING);  // Deprecated Ğ² PHP 8.1!
$name = filter_var($_POST['name'], FILTER_SANITIZE_FULL_SPECIAL_CHARS);

// Ğ§Ğ¸ÑĞ»Ğ¾ â€” ÑƒĞ±Ñ€Ğ°Ñ‚ÑŒ Ğ²ÑÑ‘ ĞºÑ€Ğ¾Ğ¼Ğµ Ñ†Ğ¸Ñ„Ñ€ Ğ¸ Ğ·Ğ½Ğ°ĞºĞ¾Ğ²
$number = filter_var($_POST['number'], FILTER_SANITIZE_NUMBER_INT);
// "123abc-456" â†’ "123-456"

$float = filter_var($_POST['price'], FILTER_SANITIZE_NUMBER_FLOAT, FILTER_FLAG_ALLOW_FRACTION);
// "99.99Ñ€ÑƒĞ±" â†’ "99.99"

// Ğ¡Ğ¿ĞµÑ†Ğ¸Ğ°Ğ»ÑŒĞ½Ñ‹Ğµ ÑĞ¸Ğ¼Ğ²Ğ¾Ğ»Ñ‹ Ğ´Ğ»Ñ HTML
$html = filter_var($_POST['content'], FILTER_SANITIZE_SPECIAL_CHARS);
// Ğ­ĞºĞ²Ğ¸Ğ²Ğ°Ğ»ĞµĞ½Ñ‚ htmlspecialchars()
```

### filter_input â€” Ñ„Ğ¸Ğ»ÑŒÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ Ğ½Ğ°Ğ¿Ñ€ÑĞ¼ÑƒÑ Ğ¸Ğ· Ğ¸ÑÑ‚Ğ¾Ñ‡Ğ½Ğ¸ĞºĞ°

```php
<?php
// Ğ‘ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½ĞµĞµ Ñ‡ĞµĞ¼ $_GET/$_POST â€” Ğ²Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‰Ğ°ĞµÑ‚ null ĞµÑĞ»Ğ¸ Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ğ° Ğ½ĞµÑ‚

// Ğ˜Ğ· GET
$page = filter_input(INPUT_GET, 'page', FILTER_SANITIZE_NUMBER_INT);
$search = filter_input(INPUT_GET, 'q', FILTER_SANITIZE_FULL_SPECIAL_CHARS);

// Ğ˜Ğ· POST
$email = filter_input(INPUT_POST, 'email', FILTER_SANITIZE_EMAIL);
$age = filter_input(INPUT_POST, 'age', FILTER_SANITIZE_NUMBER_INT);

// Ğ˜Ğ· COOKIE
$theme = filter_input(INPUT_COOKIE, 'theme', FILTER_SANITIZE_FULL_SPECIAL_CHARS);

// Ğ˜Ğ· SERVER
$ip = filter_input(INPUT_SERVER, 'REMOTE_ADDR', FILTER_VALIDATE_IP);

// Ğ¢Ğ¸Ğ¿Ñ‹ Ğ¸ÑÑ‚Ğ¾Ñ‡Ğ½Ğ¸ĞºĞ¾Ğ²:
// INPUT_GET, INPUT_POST, INPUT_COOKIE, INPUT_SERVER, INPUT_ENV
```

### Ğ¤ÑƒĞ½ĞºÑ†Ğ¸Ñ Ğ¾Ñ‡Ğ¸ÑÑ‚ĞºĞ¸ ÑÑ‚Ñ€Ğ¾ĞºĞ¸

```php
<?php
/**
 * ĞÑ‡Ğ¸ÑÑ‚ĞºĞ° ÑÑ‚Ñ€Ğ¾ĞºĞ¾Ğ²Ğ¾Ğ³Ğ¾ Ğ²Ğ²Ğ¾Ğ´Ğ°
 */
function cleanString(?string $input, int $maxLength = 0): string {
    if ($input === null) {
        return '';
    }
    
    // Ğ£Ğ±Ñ€Ğ°Ñ‚ÑŒ Ğ¿Ñ€Ğ¾Ğ±ĞµĞ»Ñ‹ Ğ¿Ğ¾ ĞºÑ€Ğ°ÑĞ¼
    $clean = trim($input);
    
    // Ğ£Ğ±Ñ€Ğ°Ñ‚ÑŒ Ğ¼Ğ½Ğ¾Ğ¶ĞµÑÑ‚Ğ²ĞµĞ½Ğ½Ñ‹Ğµ Ğ¿Ñ€Ğ¾Ğ±ĞµĞ»Ñ‹
    $clean = preg_replace('/\s+/', ' ', $clean);
    
    // ĞĞ±Ñ€ĞµĞ·Ğ°Ñ‚ÑŒ ĞµÑĞ»Ğ¸ Ğ½ÑƒĞ¶Ğ½Ğ¾
    if ($maxLength > 0 && mb_strlen($clean) > $maxLength) {
        $clean = mb_substr($clean, 0, $maxLength);
    }
    
    return $clean;
}

/**
 * ĞÑ‡Ğ¸ÑÑ‚ĞºĞ° Ğ´Ğ»Ñ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ Ğ² HTML
 */
function cleanForHtml(?string $input): string {
    return htmlspecialchars(cleanString($input), ENT_QUOTES, 'UTF-8');
}

// Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ
$name = cleanString($_POST['name'] ?? null, 100);
$bio = cleanForHtml($_POST['bio'] ?? null);
```

---

## 3. Ğ’Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ñ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…

### filter_var Ğ´Ğ»Ñ Ğ²Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ğ¸

```php
<?php
// FILTER_VALIDATE_* â€” Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… (Ğ²Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‰Ğ°ĞµÑ‚ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ Ğ¸Ğ»Ğ¸ false)

// Email
$email = 'user@example.com';
if (filter_var($email, FILTER_VALIDATE_EMAIL) === false) {
    echo "ĞĞµĞºĞ¾Ñ€Ñ€ĞµĞºÑ‚Ğ½Ñ‹Ğ¹ email";
}

// URL
$url = 'https://example.com';
if (filter_var($url, FILTER_VALIDATE_URL) === false) {
    echo "ĞĞµĞºĞ¾Ñ€Ñ€ĞµĞºÑ‚Ğ½Ñ‹Ğ¹ URL";
}

// IP Ğ°Ğ´Ñ€ĞµÑ
$ip = '192.168.1.1';
filter_var($ip, FILTER_VALIDATE_IP);                    // Ğ›ÑĞ±Ğ¾Ğ¹ IP
filter_var($ip, FILTER_VALIDATE_IP, FILTER_FLAG_IPV4);  // Ğ¢Ğ¾Ğ»ÑŒĞºĞ¾ IPv4
filter_var($ip, FILTER_VALIDATE_IP, FILTER_FLAG_IPV6);  // Ğ¢Ğ¾Ğ»ÑŒĞºĞ¾ IPv6
filter_var($ip, FILTER_VALIDATE_IP, FILTER_FLAG_NO_PRIV_RANGE);  // ĞĞµ Ğ¿Ñ€Ğ¸Ğ²Ğ°Ñ‚Ğ½Ñ‹Ğ¹

// Ğ¦ĞµĞ»Ğ¾Ğµ Ñ‡Ğ¸ÑĞ»Ğ¾
$age = filter_var($_POST['age'], FILTER_VALIDATE_INT);
if ($age === false) {
    echo "Ğ”Ğ¾Ğ»Ğ¶Ğ½Ğ¾ Ğ±Ñ‹Ñ‚ÑŒ Ñ†ĞµĞ»Ñ‹Ğ¼ Ñ‡Ğ¸ÑĞ»Ğ¾Ğ¼";
}

// Ğ¡ Ğ´Ğ¸Ğ°Ğ¿Ğ°Ğ·Ğ¾Ğ½Ğ¾Ğ¼
$age = filter_var($_POST['age'], FILTER_VALIDATE_INT, [
    'options' => [
        'min_range' => 1,
        'max_range' => 150
    ]
]);

// Ğ§Ğ¸ÑĞ»Ğ¾ Ñ Ğ¿Ğ»Ğ°Ğ²Ğ°ÑÑ‰ĞµĞ¹ Ñ‚Ğ¾Ñ‡ĞºĞ¾Ğ¹
$price = filter_var($_POST['price'], FILTER_VALIDATE_FLOAT);

// Boolean
$active = filter_var($_POST['active'], FILTER_VALIDATE_BOOLEAN, FILTER_NULL_ON_FAILURE);
// "yes", "true", "1", "on" â†’ true
// "no", "false", "0", "off" â†’ false
// Ğ´Ñ€ÑƒĞ³Ğ¾Ğµ â†’ null

// Ğ”Ğ¾Ğ¼ĞµĞ½Ğ½Ğ¾Ğµ Ğ¸Ğ¼Ñ (PHP 7+)
filter_var($domain, FILTER_VALIDATE_DOMAIN, FILTER_FLAG_HOSTNAME);

// MAC Ğ°Ğ´Ñ€ĞµÑ
filter_var($mac, FILTER_VALIDATE_MAC);

// Ğ ĞµĞ³ÑƒĞ»ÑÑ€Ğ½Ğ¾Ğµ Ğ²Ñ‹Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ğµ
$username = filter_var($_POST['username'], FILTER_VALIDATE_REGEXP, [
    'options' => ['regexp' => '/^[a-zA-Z][a-zA-Z0-9_]{2,19}$/']
]);
```

### Ğ’Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ñ Ñ filter_input

```php
<?php
// ĞŸĞ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğµ Ğ¸ Ğ²Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ñ Ğ¾Ğ´Ğ½Ğ¾Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ½Ğ¾
$email = filter_input(INPUT_POST, 'email', FILTER_VALIDATE_EMAIL);

if ($email === null) {
    echo "Email Ğ½Ğµ Ğ¿ĞµÑ€ĞµĞ´Ğ°Ğ½";
} elseif ($email === false) {
    echo "ĞĞµĞºĞ¾Ñ€Ñ€ĞµĞºÑ‚Ğ½Ñ‹Ğ¹ email";
} else {
    echo "Email: $email";
}

// Ğ£Ğ´Ğ¾Ğ±Ğ½Ğ°Ñ Ğ¾Ğ±Ñ‘Ñ€Ñ‚ĞºĞ°
function getValidatedInput(int $type, string $name, int $filter, $options = null) {
    $value = filter_input($type, $name, $filter, $options);
    
    return [
        'value' => $value,
        'exists' => $value !== null,
        'valid' => $value !== false && $value !== null,
    ];
}

$result = getValidatedInput(INPUT_POST, 'age', FILTER_VALIDATE_INT, [
    'options' => ['min_range' => 1, 'max_range' => 150]
]);

if (!$result['exists']) {
    echo "Ğ’Ğ¾Ğ·Ñ€Ğ°ÑÑ‚ Ğ½Ğµ ÑƒĞºĞ°Ğ·Ğ°Ğ½";
} elseif (!$result['valid']) {
    echo "ĞĞµĞºĞ¾Ñ€Ñ€ĞµĞºÑ‚Ğ½Ñ‹Ğ¹ Ğ²Ğ¾Ğ·Ñ€Ğ°ÑÑ‚";
} else {
    echo "Ğ’Ğ¾Ğ·Ñ€Ğ°ÑÑ‚: " . $result['value'];
}
```

### Ğ ÑƒÑ‡Ğ½Ğ°Ñ Ğ²Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ñ

```php
<?php
// ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ¾Ğ±ÑĞ·Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚Ğ¸
function required($value): bool {
    return $value !== null && $value !== '' && $value !== [];
}

// ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ´Ğ»Ğ¸Ğ½Ñ‹ ÑÑ‚Ñ€Ğ¾ĞºĞ¸
function lengthBetween(string $value, int $min, int $max): bool {
    $length = mb_strlen($value);
    return $length >= $min && $length <= $max;
}

// ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ½Ğ° Ñ‡Ğ¸ÑĞ»Ğ¾ Ğ² Ğ´Ğ¸Ğ°Ğ¿Ğ°Ğ·Ğ¾Ğ½Ğµ
function numberBetween($value, $min, $max): bool {
    return is_numeric($value) && $value >= $min && $value <= $max;
}

// ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚Ğ° Ğ´Ğ°Ñ‚Ñ‹
function isValidDate(string $date, string $format = 'Y-m-d'): bool {
    $d = DateTime::createFromFormat($format, $date);
    return $d && $d->format($format) === $date;
}

// ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° ÑĞ¾Ğ²Ğ¿Ğ°Ğ´ĞµĞ½Ğ¸Ñ Ğ¿Ğ¾Ğ»ĞµĞ¹
function matches(string $value1, string $value2): bool {
    return $value1 === $value2;
}

// ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ½Ğ° ÑƒĞ½Ğ¸ĞºĞ°Ğ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ (Ğ¿Ñ€Ğ¸Ğ¼ĞµÑ€ Ñ Ğ‘Ğ”)
function isUnique(string $table, string $column, string $value, ?int $exceptId = null): bool {
    global $pdo;
    
    $sql = "SELECT COUNT(*) FROM $table WHERE $column = ?";
    $params = [$value];
    
    if ($exceptId !== null) {
        $sql .= " AND id != ?";
        $params[] = $exceptId;
    }
    
    $stmt = $pdo->prepare($sql);
    $stmt->execute($params);
    
    return $stmt->fetchColumn() === 0;
}

// ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ¼Ğ°ÑÑĞ¸Ğ²Ğ°
function inArray($value, array $allowed): bool {
    return in_array($value, $allowed, true);
}
```

### Ğ’Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ñ Ñ€ĞµĞ³ÑƒĞ»ÑÑ€Ğ½Ñ‹Ğ¼Ğ¸ Ğ²Ñ‹Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸ÑĞ¼Ğ¸

```php
<?php
class RegexValidator {
    // Ğ¢ĞµĞ»ĞµÑ„Ğ¾Ğ½ (Ñ€Ğ¾ÑÑĞ¸Ğ¹ÑĞºĞ¸Ğ¹)
    public static function phone(string $phone): bool {
        $cleaned = preg_replace('/\D/', '', $phone);
        return preg_match('/^[78]\d{10}$/', $cleaned) === 1;
    }
    
    // Ğ˜Ğ¼Ñ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ (Ğ»Ğ°Ñ‚Ğ¸Ğ½Ğ¸Ñ†Ğ°, Ñ†Ğ¸Ñ„Ñ€Ñ‹, Ğ¿Ğ¾Ğ´Ñ‡Ñ‘Ñ€ĞºĞ¸Ğ²Ğ°Ğ½Ğ¸Ğµ)
    public static function username(string $username): bool {
        return preg_match('/^[a-zA-Z][a-zA-Z0-9_]{2,29}$/', $username) === 1;
    }
    
    // Slug (URL-friendly ÑÑ‚Ñ€Ğ¾ĞºĞ°)
    public static function slug(string $slug): bool {
        return preg_match('/^[a-z0-9]+(?:-[a-z0-9]+)*$/', $slug) === 1;
    }
    
    // ĞŸĞ°Ñ€Ğ¾Ğ»ÑŒ (Ğ¼Ğ¸Ğ½Ğ¸Ğ¼ÑƒĞ¼ 8 ÑĞ¸Ğ¼Ğ²Ğ¾Ğ»Ğ¾Ğ², Ğ±ÑƒĞºĞ²Ñ‹ Ğ¸ Ñ†Ğ¸Ñ„Ñ€Ñ‹)
    public static function password(string $password): bool {
        return mb_strlen($password) >= 8 
            && preg_match('/[a-zA-Z]/', $password) === 1
            && preg_match('/\d/', $password) === 1;
    }
    
    // Ğ¡Ğ¸Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ¿Ğ°Ñ€Ğ¾Ğ»ÑŒ (+ ÑĞ¿ĞµÑ†ÑĞ¸Ğ¼Ğ²Ğ¾Ğ»Ñ‹ Ğ¸ Ñ€Ğ°Ğ·Ğ½Ñ‹Ğ¹ Ñ€ĞµĞ³Ğ¸ÑÑ‚Ñ€)
    public static function strongPassword(string $password): bool {
        return mb_strlen($password) >= 8
            && preg_match('/[a-z]/', $password) === 1
            && preg_match('/[A-Z]/', $password) === 1
            && preg_match('/\d/', $password) === 1
            && preg_match('/[^a-zA-Z\d]/', $password) === 1;
    }
    
    // ĞŸĞ¾Ñ‡Ñ‚Ğ¾Ğ²Ñ‹Ğ¹ Ğ¸Ğ½Ğ´ĞµĞºÑ (6 Ñ†Ğ¸Ñ„Ñ€)
    public static function postalCode(string $code): bool {
        return preg_match('/^\d{6}$/', $code) === 1;
    }
    
    // Ğ˜ĞĞ (10 Ğ¸Ğ»Ğ¸ 12 Ñ†Ğ¸Ñ„Ñ€)
    public static function inn(string $inn): bool {
        return preg_match('/^\d{10}$|^\d{12}$/', $inn) === 1;
    }
    
    // Ğ¢Ğ¾Ğ»ÑŒĞºĞ¾ ĞºĞ¸Ñ€Ğ¸Ğ»Ğ»Ğ¸Ñ†Ğ°
    public static function cyrillic(string $text): bool {
        return preg_match('/^[\p{Cyrillic}\s]+$/u', $text) === 1;
    }
    
    // Ğ¢Ğ¾Ğ»ÑŒĞºĞ¾ Ğ±ÑƒĞºĞ²Ñ‹ (Ğ»ÑĞ±Ğ¾Ğ¹ Ğ°Ğ»Ñ„Ğ°Ğ²Ğ¸Ñ‚)
    public static function alpha(string $text): bool {
        return preg_match('/^[\p{L}]+$/u', $text) === 1;
    }
    
    // Ğ‘ÑƒĞºĞ²Ñ‹ Ğ¸ Ğ¿Ñ€Ğ¾Ğ±ĞµĞ»Ñ‹
    public static function alphaSpaces(string $text): bool {
        return preg_match('/^[\p{L}\s]+$/u', $text) === 1;
    }
}

// Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ
if (!RegexValidator::phone($_POST['phone'])) {
    $errors['phone'] = 'ĞĞµĞºĞ¾Ñ€Ñ€ĞµĞºÑ‚Ğ½Ñ‹Ğ¹ Ğ½Ğ¾Ğ¼ĞµÑ€ Ñ‚ĞµĞ»ĞµÑ„Ğ¾Ğ½Ğ°';
}

if (!RegexValidator::strongPassword($_POST['password'])) {
    $errors['password'] = 'ĞŸĞ°Ñ€Ğ¾Ğ»ÑŒ Ğ´Ğ¾Ğ»Ğ¶ĞµĞ½ ÑĞ¾Ğ´ĞµÑ€Ğ¶Ğ°Ñ‚ÑŒ Ğ±ÑƒĞºĞ²Ñ‹ Ñ€Ğ°Ğ·Ğ½Ğ¾Ğ³Ğ¾ Ñ€ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ°, Ñ†Ğ¸Ñ„Ñ€Ñ‹ Ğ¸ ÑĞ¿ĞµÑ†ÑĞ¸Ğ¼Ğ²Ğ¾Ğ»Ñ‹';
}
```

---

## 4. ĞšĞ»Ğ°ÑÑ Ğ²Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ‚Ğ¾Ñ€Ğ°

### ĞŸÑ€Ğ¾ÑÑ‚Ğ¾Ğ¹ Ğ²Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ‚Ğ¾Ñ€

```php
<?php
class Validator {
    private array $data;
    private array $errors = [];
    private array $validated = [];
    
    public function __construct(array $data) {
        $this->data = $data;
    }
    
    public function validate(array $rules): self {
        foreach ($rules as $field => $fieldRules) {
            $value = $this->data[$field] ?? null;
            
            // Ğ Ğ°Ğ·Ğ±Ğ¸Ñ‚ÑŒ Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»Ğ° ĞµÑĞ»Ğ¸ Ğ¿ĞµÑ€ĞµĞ´Ğ°Ğ½Ñ‹ ÑÑ‚Ñ€Ğ¾ĞºĞ¾Ğ¹
            if (is_string($fieldRules)) {
                $fieldRules = explode('|', $fieldRules);
            }
            
            foreach ($fieldRules as $rule) {
                $this->applyRule($field, $value, $rule);
                
                // Ğ•ÑĞ»Ğ¸ ÑƒĞ¶Ğµ ĞµÑÑ‚ÑŒ Ğ¾ÑˆĞ¸Ğ±ĞºĞ° Ğ´Ğ»Ñ Ğ¿Ğ¾Ğ»Ñ, Ğ½Ğµ Ğ¿Ñ€Ğ¾Ğ´Ğ¾Ğ»Ğ¶Ğ°Ñ‚ÑŒ
                if (isset($this->errors[$field])) {
                    break;
                }
            }
            
            // Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½Ğ¸Ñ‚ÑŒ Ğ²Ğ°Ğ»Ğ¸Ğ´Ğ½Ğ¾Ğµ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ
            if (!isset($this->errors[$field])) {
                $this->validated[$field] = $value;
            }
        }
        
        return $this;
    }
    
    private function applyRule(string $field, $value, string $rule): void {
        // Ğ Ğ°Ğ·Ğ±Ğ¾Ñ€ Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ğ¾Ğ² Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»Ğ° (Ğ½Ğ°Ğ¿Ñ€Ğ¸Ğ¼ĞµÑ€: "min:3" â†’ ["min", "3"])
        $params = [];
        if (strpos($rule, ':') !== false) {
            [$rule, $paramStr] = explode(':', $rule, 2);
            $params = explode(',', $paramStr);
        }
        
        $label = $this->getLabel($field);
        
        switch ($rule) {
            case 'required':
                if ($value === null || $value === '' || $value === []) {
                    $this->errors[$field] = "ĞŸĞ¾Ğ»Ğµ Â«$labelÂ» Ğ¾Ğ±ÑĞ·Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ Ğ´Ğ»Ñ Ğ·Ğ°Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ñ";
                }
                break;
                
            case 'email':
                if ($value && filter_var($value, FILTER_VALIDATE_EMAIL) === false) {
                    $this->errors[$field] = "ĞŸĞ¾Ğ»Ğµ Â«$labelÂ» Ğ´Ğ¾Ğ»Ğ¶Ğ½Ğ¾ Ğ±Ñ‹Ñ‚ÑŒ ĞºĞ¾Ñ€Ñ€ĞµĞºÑ‚Ğ½Ñ‹Ğ¼ email";
                }
                break;
                
            case 'url':
                if ($value && filter_var($value, FILTER_VALIDATE_URL) === false) {
                    $this->errors[$field] = "ĞŸĞ¾Ğ»Ğµ Â«$labelÂ» Ğ´Ğ¾Ğ»Ğ¶Ğ½Ğ¾ Ğ±Ñ‹Ñ‚ÑŒ ĞºĞ¾Ñ€Ñ€ĞµĞºÑ‚Ğ½Ñ‹Ğ¼ URL";
                }
                break;
                
            case 'min':
                $min = (int) $params[0];
                if ($value && mb_strlen($value) < $min) {
                    $this->errors[$field] = "ĞŸĞ¾Ğ»Ğµ Â«$labelÂ» Ğ´Ğ¾Ğ»Ğ¶Ğ½Ğ¾ Ğ±Ñ‹Ñ‚ÑŒ Ğ½Ğµ ĞºĞ¾Ñ€Ğ¾Ñ‡Ğµ $min ÑĞ¸Ğ¼Ğ²Ğ¾Ğ»Ğ¾Ğ²";
                }
                break;
                
            case 'max':
                $max = (int) $params[0];
                if ($value && mb_strlen($value) > $max) {
                    $this->errors[$field] = "ĞŸĞ¾Ğ»Ğµ Â«$labelÂ» Ğ´Ğ¾Ğ»Ğ¶Ğ½Ğ¾ Ğ±Ñ‹Ñ‚ÑŒ Ğ½Ğµ Ğ´Ğ»Ğ¸Ğ½Ğ½ĞµĞµ $max ÑĞ¸Ğ¼Ğ²Ğ¾Ğ»Ğ¾Ğ²";
                }
                break;
                
            case 'between':
                $min = (int) $params[0];
                $max = (int) $params[1];
                $length = mb_strlen($value ?? '');
                if ($value && ($length < $min || $length > $max)) {
                    $this->errors[$field] = "ĞŸĞ¾Ğ»Ğµ Â«$labelÂ» Ğ´Ğ¾Ğ»Ğ¶Ğ½Ğ¾ Ğ±Ñ‹Ñ‚ÑŒ Ğ¾Ñ‚ $min Ğ´Ğ¾ $max ÑĞ¸Ğ¼Ğ²Ğ¾Ğ»Ğ¾Ğ²";
                }
                break;
                
            case 'numeric':
                if ($value && !is_numeric($value)) {
                    $this->errors[$field] = "ĞŸĞ¾Ğ»Ğµ Â«$labelÂ» Ğ´Ğ¾Ğ»Ğ¶Ğ½Ğ¾ Ğ±Ñ‹Ñ‚ÑŒ Ñ‡Ğ¸ÑĞ»Ğ¾Ğ¼";
                }
                break;
                
            case 'integer':
                if ($value && filter_var($value, FILTER_VALIDATE_INT) === false) {
                    $this->errors[$field] = "ĞŸĞ¾Ğ»Ğµ Â«$labelÂ» Ğ´Ğ¾Ğ»Ğ¶Ğ½Ğ¾ Ğ±Ñ‹Ñ‚ÑŒ Ñ†ĞµĞ»Ñ‹Ğ¼ Ñ‡Ğ¸ÑĞ»Ğ¾Ğ¼";
                }
                break;
                
            case 'min_value':
                $min = $params[0];
                if ($value !== null && $value !== '' && $value < $min) {
                    $this->errors[$field] = "ĞŸĞ¾Ğ»Ğµ Â«$labelÂ» Ğ´Ğ¾Ğ»Ğ¶Ğ½Ğ¾ Ğ±Ñ‹Ñ‚ÑŒ Ğ½Ğµ Ğ¼ĞµĞ½ÑŒÑˆĞµ $min";
                }
                break;
                
            case 'max_value':
                $max = $params[0];
                if ($value !== null && $value !== '' && $value > $max) {
                    $this->errors[$field] = "ĞŸĞ¾Ğ»Ğµ Â«$labelÂ» Ğ´Ğ¾Ğ»Ğ¶Ğ½Ğ¾ Ğ±Ñ‹Ñ‚ÑŒ Ğ½Ğµ Ğ±Ğ¾Ğ»ÑŒÑˆĞµ $max";
                }
                break;
                
            case 'in':
                if ($value && !in_array($value, $params, true)) {
                    $allowed = implode(', ', $params);
                    $this->errors[$field] = "ĞŸĞ¾Ğ»Ğµ Â«$labelÂ» Ğ´Ğ¾Ğ»Ğ¶Ğ½Ğ¾ Ğ±Ñ‹Ñ‚ÑŒ Ğ¾Ğ´Ğ½Ğ¸Ğ¼ Ğ¸Ğ·: $allowed";
                }
                break;
                
            case 'regex':
                $pattern = $params[0];
                if ($value && preg_match($pattern, $value) !== 1) {
                    $this->errors[$field] = "ĞŸĞ¾Ğ»Ğµ Â«$labelÂ» Ğ¸Ğ¼ĞµĞµÑ‚ Ğ½ĞµĞ²ĞµÑ€Ğ½Ñ‹Ğ¹ Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚";
                }
                break;
                
            case 'confirmed':
                $confirmField = $field . '_confirmation';
                $confirmValue = $this->data[$confirmField] ?? null;
                if ($value !== $confirmValue) {
                    $this->errors[$field] = "ĞŸĞ¾Ğ»Ğµ Â«$labelÂ» Ğ½Ğµ ÑĞ¾Ğ²Ğ¿Ğ°Ğ´Ğ°ĞµÑ‚ Ñ Ğ¿Ğ¾Ğ´Ñ‚Ğ²ĞµÑ€Ğ¶Ğ´ĞµĞ½Ğ¸ĞµĞ¼";
                }
                break;
                
            case 'date':
                $format = $params[0] ?? 'Y-m-d';
                $d = DateTime::createFromFormat($format, $value ?? '');
                if ($value && (!$d || $d->format($format) !== $value)) {
                    $this->errors[$field] = "ĞŸĞ¾Ğ»Ğµ Â«$labelÂ» Ğ´Ğ¾Ğ»Ğ¶Ğ½Ğ¾ Ğ±Ñ‹Ñ‚ÑŒ Ğ´Ğ°Ñ‚Ğ¾Ğ¹ Ğ² Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚Ğµ $format";
                }
                break;
                
            case 'alpha':
                if ($value && !preg_match('/^[\p{L}]+$/u', $value)) {
                    $this->errors[$field] = "ĞŸĞ¾Ğ»Ğµ Â«$labelÂ» Ğ´Ğ¾Ğ»Ğ¶Ğ½Ğ¾ ÑĞ¾Ğ´ĞµÑ€Ğ¶Ğ°Ñ‚ÑŒ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ğ±ÑƒĞºĞ²Ñ‹";
                }
                break;
                
            case 'alpha_spaces':
                if ($value && !preg_match('/^[\p{L}\s]+$/u', $value)) {
                    $this->errors[$field] = "ĞŸĞ¾Ğ»Ğµ Â«$labelÂ» Ğ´Ğ¾Ğ»Ğ¶Ğ½Ğ¾ ÑĞ¾Ğ´ĞµÑ€Ğ¶Ğ°Ñ‚ÑŒ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ğ±ÑƒĞºĞ²Ñ‹ Ğ¸ Ğ¿Ñ€Ğ¾Ğ±ĞµĞ»Ñ‹";
                }
                break;
                
            case 'alpha_num':
                if ($value && !preg_match('/^[\p{L}\d]+$/u', $value)) {
                    $this->errors[$field] = "ĞŸĞ¾Ğ»Ğµ Â«$labelÂ» Ğ´Ğ¾Ğ»Ğ¶Ğ½Ğ¾ ÑĞ¾Ğ´ĞµÑ€Ğ¶Ğ°Ñ‚ÑŒ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ğ±ÑƒĞºĞ²Ñ‹ Ğ¸ Ñ†Ğ¸Ñ„Ñ€Ñ‹";
                }
                break;
                
            case 'phone':
                $cleaned = preg_replace('/\D/', '', $value ?? '');
                if ($value && !preg_match('/^[78]\d{10}$/', $cleaned)) {
                    $this->errors[$field] = "ĞŸĞ¾Ğ»Ğµ Â«$labelÂ» Ğ´Ğ¾Ğ»Ğ¶Ğ½Ğ¾ Ğ±Ñ‹Ñ‚ÑŒ ĞºĞ¾Ñ€Ñ€ĞµĞºÑ‚Ğ½Ñ‹Ğ¼ Ğ½Ğ¾Ğ¼ĞµÑ€Ğ¾Ğ¼ Ñ‚ĞµĞ»ĞµÑ„Ğ¾Ğ½Ğ°";
                }
                break;
                
            case 'nullable':
                // Ğ Ğ°Ğ·Ñ€ĞµÑˆĞ¸Ñ‚ÑŒ null/Ğ¿ÑƒÑÑ‚ÑƒÑ ÑÑ‚Ñ€Ğ¾ĞºÑƒ, Ğ¿Ñ€Ğ¾ÑÑ‚Ğ¾ Ğ¿Ñ€Ğ¾Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚ÑŒ
                break;
        }
    }
    
    private function getLabel(string $field): string {
        // ĞœĞ¾Ğ¶Ğ½Ğ¾ Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ mapping Ğ´Ğ»Ñ Ñ‡ĞµĞ»Ğ¾Ğ²ĞµĞºĞ¾Ñ‡Ğ¸Ñ‚Ğ°ĞµĞ¼Ñ‹Ñ… Ğ½Ğ°Ğ·Ğ²Ğ°Ğ½Ğ¸Ğ¹
        $labels = [
            'name' => 'Ğ˜Ğ¼Ñ',
            'email' => 'Email',
            'password' => 'ĞŸĞ°Ñ€Ğ¾Ğ»ÑŒ',
            'phone' => 'Ğ¢ĞµĞ»ĞµÑ„Ğ¾Ğ½',
            // ...
        ];
        
        return $labels[$field] ?? $field;
    }
    
    public function fails(): bool {
        return !empty($this->errors);
    }
    
    public function passes(): bool {
        return empty($this->errors);
    }
    
    public function errors(): array {
        return $this->errors;
    }
    
    public function firstError(): ?string {
        return $this->errors ? reset($this->errors) : null;
    }
    
    public function validated(): array {
        return $this->validated;
    }
    
    public function addError(string $field, string $message): self {
        $this->errors[$field] = $message;
        return $this;
    }
}

// Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ
$validator = new Validator($_POST);

$validator->validate([
    'name' => 'required|alpha_spaces|between:2,100',
    'email' => 'required|email|max:255',
    'age' => 'nullable|integer|min_value:1|max_value:150',
    'password' => 'required|min:8',
    'password_confirmation' => 'required',
    'role' => 'required|in:user,moderator,admin',
]);

// ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° ÑƒĞ½Ğ¸ĞºĞ°Ğ»ÑŒĞ½Ğ¾ÑÑ‚Ğ¸ (Ğ¾Ñ‚Ğ´ĞµĞ»ÑŒĞ½Ğ¾)
if ($validator->passes() && !isUniqueEmail($_POST['email'])) {
    $validator->addError('email', 'Ğ­Ñ‚Ğ¾Ñ‚ email ÑƒĞ¶Ğµ Ğ·Ğ°Ñ€ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½');
}

if ($validator->fails()) {
    $errors = $validator->errors();
    // ĞŸĞ¾ĞºĞ°Ğ·Ğ°Ñ‚ÑŒ Ğ¾ÑˆĞ¸Ğ±ĞºĞ¸...
} else {
    $data = $validator->validated();
    // Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½Ğ¸Ñ‚ÑŒ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ...
}
```

### Ğ Ğ°ÑÑˆĞ¸Ñ€ĞµĞ½Ğ½Ñ‹Ğ¹ Ğ²Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ‚Ğ¾Ñ€ Ñ ĞºĞ°ÑÑ‚Ğ¾Ğ¼Ğ½Ñ‹Ğ¼Ğ¸ Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»Ğ°Ğ¼Ğ¸

```php
<?php
class ExtendedValidator extends Validator {
    private static array $customRules = [];
    private static array $customMessages = [];
    
    /**
     * Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ ĞºĞ°ÑÑ‚Ğ¾Ğ¼Ğ½Ğ¾Ğµ Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»Ğ¾
     */
    public static function extend(string $rule, callable $callback, string $message): void {
        self::$customRules[$rule] = $callback;
        self::$customMessages[$rule] = $message;
    }
    
    /**
     * ĞŸÑ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ ĞºĞ°ÑÑ‚Ğ¾Ğ¼Ğ½Ñ‹Ğµ Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»Ğ°
     */
    protected function applyCustomRule(string $field, $value, string $rule, array $params): bool {
        if (!isset(self::$customRules[$rule])) {
            return false;
        }
        
        $callback = self::$customRules[$rule];
        $isValid = $callback($value, $params, $this->data);
        
        if (!$isValid) {
            $message = self::$customMessages[$rule];
            $message = str_replace(':field', $this->getLabel($field), $message);
            $message = str_replace(':value', $value ?? '', $message);
            
            foreach ($params as $i => $param) {
                $message = str_replace(":param$i", $param, $message);
            }
            
            $this->errors[$field] = $message;
        }
        
        return true;
    }
}

// Ğ ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ ĞºĞ°ÑÑ‚Ğ¾Ğ¼Ğ½Ñ‹Ñ… Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»
ExtendedValidator::extend(
    'unique',
    function ($value, $params, $data) {
        [$table, $column] = $params;
        $exceptId = $params[2] ?? null;
        return isUnique($table, $column, $value, $exceptId);
    },
    'Ğ—Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ Ğ¿Ğ¾Ğ»Ñ Â«:fieldÂ» ÑƒĞ¶Ğµ ÑÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒĞµÑ‚'
);

ExtendedValidator::extend(
    'strong_password',
    function ($value) {
        return mb_strlen($value) >= 8
            && preg_match('/[a-z]/', $value)
            && preg_match('/[A-Z]/', $value)
            && preg_match('/\d/', $value)
            && preg_match('/[^a-zA-Z\d]/', $value);
    },
    'ĞŸĞ°Ñ€Ğ¾Ğ»ÑŒ Ğ´Ğ¾Ğ»Ğ¶ĞµĞ½ ÑĞ¾Ğ´ĞµÑ€Ğ¶Ğ°Ñ‚ÑŒ Ğ¼Ğ¸Ğ½Ğ¸Ğ¼ÑƒĞ¼ 8 ÑĞ¸Ğ¼Ğ²Ğ¾Ğ»Ğ¾Ğ², Ğ±ÑƒĞºĞ²Ñ‹ Ñ€Ğ°Ğ·Ğ½Ğ¾Ğ³Ğ¾ Ñ€ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ°, Ñ†Ğ¸Ñ„Ñ€Ñ‹ Ğ¸ ÑĞ¿ĞµÑ†ÑĞ¸Ğ¼Ğ²Ğ¾Ğ»Ñ‹'
);

ExtendedValidator::extend(
    'age_from_date',
    function ($value, $params) {
        $minAge = (int) $params[0];
        $date = DateTime::createFromFormat('Y-m-d', $value);
        if (!$date) return false;
        
        $now = new DateTime();
        $age = $now->diff($date)->y;
        return $age >= $minAge;
    },
    'Ğ’Ğ°Ğ¼ Ğ´Ğ¾Ğ»Ğ¶Ğ½Ğ¾ Ğ±Ñ‹Ñ‚ÑŒ Ğ½Ğµ Ğ¼ĞµĞ½ĞµĞµ :param0 Ğ»ĞµÑ‚'
);

// Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ
$validator = new ExtendedValidator($_POST);
$validator->validate([
    'email' => 'required|email|unique:users,email',
    'password' => 'required|strong_password',
    'birthdate' => 'required|date|age_from_date:18',
]);
```

---

## 5. Ğ¡Ğ°Ğ½Ğ¸Ñ‚Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ğ´Ğ»Ñ Ğ²Ñ‹Ğ²Ğ¾Ğ´Ğ°

### Ğ­ĞºÑ€Ğ°Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ HTML

```php
<?php
// htmlspecialchars â€” Ğ¾ÑĞ½Ğ¾Ğ²Ğ½Ğ°Ñ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ñ Ğ´Ğ»Ñ Ğ·Ğ°Ñ‰Ğ¸Ñ‚Ñ‹ Ğ¾Ñ‚ XSS

$userInput = '<script>alert("XSS")</script>';

// âŒ ĞĞŸĞĞ¡ĞĞ!
echo $userInput;

// âœ… Ğ‘Ğ•Ğ—ĞĞŸĞĞ¡ĞĞ
echo htmlspecialchars($userInput, ENT_QUOTES, 'UTF-8');
// Ğ’Ñ‹Ğ²ĞµĞ´ĞµÑ‚: &lt;script&gt;alert("XSS")&lt;/script&gt;

// Ğ¤ÑƒĞ½ĞºÑ†Ğ¸Ñ-Ñ…ĞµĞ»Ğ¿ĞµÑ€ (ĞºĞ¾Ñ€Ğ¾Ñ‚ĞºĞ¾Ğµ Ğ¸Ğ¼Ñ)
function e(?string $value): string {
    return htmlspecialchars($value ?? '', ENT_QUOTES, 'UTF-8');
}

// Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ² ÑˆĞ°Ğ±Ğ»Ğ¾Ğ½Ğ°Ñ…
?>
<p>Ğ˜Ğ¼Ñ: <?= e($user['name']) ?></p>
<input type="text" value="<?= e($search) ?>">
<a href="/user/<?= e($username) ?>">ĞŸÑ€Ğ¾Ñ„Ğ¸Ğ»ÑŒ</a>

<?php
// Ğ”Ğ»Ñ Ğ°Ñ‚Ñ€Ğ¸Ğ±ÑƒÑ‚Ğ¾Ğ² URL
function eUrl(?string $value): string {
    return htmlspecialchars(urlencode($value ?? ''), ENT_QUOTES, 'UTF-8');
}

// Ğ”Ğ»Ñ JavaScript ÑÑ‚Ñ€Ğ¾Ğº
function eJs(?string $value): string {
    return json_encode($value ?? '', JSON_HEX_TAG | JSON_HEX_APOS | JSON_HEX_QUOT | JSON_HEX_AMP);
}
?>
<script>
    var userName = <?= eJs($user['name']) ?>;
</script>
```

### Ğ§Ñ‚Ğ¾ ÑĞºÑ€Ğ°Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ?

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ĞŸĞ ĞĞ’Ğ˜Ğ›Ğ Ğ­ĞšĞ ĞĞĞ˜Ğ ĞĞ’ĞĞĞ˜Ğ¯                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                â”‚
â”‚   ĞšĞĞĞ¢Ğ•ĞšĞ¡Ğ¢                      Ğ§Ğ¢Ğ Ğ˜Ğ¡ĞŸĞĞ›Ğ¬Ğ—ĞĞ’ĞĞ¢Ğ¬               â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”‚
â”‚   HTML Ñ‚ĞµĞ»Ğ¾                     htmlspecialchars()             â”‚
â”‚   HTML Ğ°Ñ‚Ñ€Ğ¸Ğ±ÑƒÑ‚Ñ‹                 htmlspecialchars()             â”‚
â”‚   URL Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ñ‹                 urlencode()                    â”‚
â”‚   JavaScript ÑÑ‚Ñ€Ğ¾ĞºĞ¸             json_encode()                  â”‚
â”‚   CSS Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ñ                  Ğ‘ĞµĞ»Ñ‹Ğ¹ ÑĞ¿Ğ¸ÑĞ¾Ğº                   â”‚
â”‚   SQL Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑÑ‹                   Prepared statements            â”‚
â”‚                                                                â”‚
â”‚   ĞŸĞ ĞĞ’Ğ˜Ğ›Ğ: Ğ­ĞºÑ€Ğ°Ğ½Ğ¸Ñ€ÑƒĞ¹ Ğ² Ğ¼Ğ¾Ğ¼ĞµĞ½Ñ‚ Ğ²Ñ‹Ğ²Ğ¾Ğ´Ğ°, Ğ½Ğµ Ğ¿Ñ€Ğ¸ Ğ¿Ğ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğ¸!       â”‚
â”‚                                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ĞšĞ¾Ğ½Ñ‚ĞµĞºÑÑ‚Ğ½Ğ¾-Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾Ğµ ÑĞºÑ€Ğ°Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ

```php
<?php
class Escape {
    /**
     * Ğ”Ğ»Ñ HTML Ñ‚ĞµĞ»Ğ° Ğ¸ Ğ°Ñ‚Ñ€Ğ¸Ğ±ÑƒÑ‚Ğ¾Ğ²
     */
    public static function html(?string $value): string {
        return htmlspecialchars($value ?? '', ENT_QUOTES | ENT_HTML5, 'UTF-8');
    }
    
    /**
     * Ğ”Ğ»Ñ URL Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ğ¾Ğ²
     */
    public static function url(?string $value): string {
        return rawurlencode($value ?? '');
    }
    
    /**
     * Ğ”Ğ»Ñ JavaScript ÑÑ‚Ñ€Ğ¾Ğº
     */
    public static function js(?string $value): string {
        return json_encode($value ?? '', JSON_HEX_TAG | JSON_HEX_APOS | JSON_HEX_QUOT | JSON_HEX_AMP);
    }
    
    /**
     * Ğ”Ğ»Ñ CSS Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğ¹ (Ğ¾Ñ‡ĞµĞ½ÑŒ Ğ¾Ğ³Ñ€Ğ°Ğ½Ğ¸Ñ‡ĞµĞ½Ğ¾!)
     */
    public static function css(?string $value): string {
        // Ğ¢Ğ¾Ğ»ÑŒĞºĞ¾ Ğ±ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ñ‹Ğµ ÑĞ¸Ğ¼Ğ²Ğ¾Ğ»Ñ‹
        return preg_replace('/[^a-zA-Z0-9_\-]/', '', $value ?? '');
    }
    
    /**
     * Ğ”Ğ»Ñ href/src Ğ°Ñ‚Ñ€Ğ¸Ğ±ÑƒÑ‚Ğ¾Ğ² (Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ° ÑÑ…ĞµĞ¼Ñ‹)
     */
    public static function href(?string $url): string {
        if ($url === null || $url === '') {
            return '';
        }
        
        // Ğ Ğ°Ğ·Ñ€ĞµÑˆÑ‘Ğ½Ğ½Ñ‹Ğµ ÑÑ…ĞµĞ¼Ñ‹
        $allowedSchemes = ['http', 'https', 'mailto', 'tel'];
        
        // ĞŸÑ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ ÑÑ…ĞµĞ¼Ñƒ
        if (preg_match('/^([a-z][a-z0-9+.-]*):/', strtolower($url), $matches)) {
            if (!in_array($matches[1], $allowedSchemes)) {
                return '';  // Ğ—Ğ°Ğ¿Ñ€ĞµÑ‰Ñ‘Ğ½Ğ½Ğ°Ñ ÑÑ…ĞµĞ¼Ğ° (javascript:, data: Ğ¸ Ñ‚.Ğ´.)
            }
        }
        
        return self::html($url);
    }
}

// Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ
?>
<p><?= Escape::html($comment) ?></p>
<a href="<?= Escape::href($link) ?>">Ğ¡ÑÑ‹Ğ»ĞºĞ°</a>
<a href="/search?q=<?= Escape::url($query) ?>">ĞŸĞ¾Ğ¸ÑĞº</a>
<script>var data = <?= Escape::js($userData) ?>;</script>
<div style="color: <?= Escape::css($color) ?>">Ğ¢ĞµĞºÑÑ‚</div>
```

---

## 6. ĞĞ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ° Ñ„Ğ¾Ñ€Ğ¼ Ğ½Ğ° Ğ¿Ñ€Ğ°ĞºÑ‚Ğ¸ĞºĞµ

### ĞŸĞ¾Ğ»Ğ½Ñ‹Ğ¹ Ğ¿Ñ€Ğ¸Ğ¼ĞµÑ€: Ñ„Ğ¾Ñ€Ğ¼Ğ° Ñ€ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ°Ñ†Ğ¸Ğ¸

```php
<?php
// register.php

session_start();

// CSRF Ñ‚Ğ¾ĞºĞµĞ½
if (empty($_SESSION['csrf_token'])) {
    $_SESSION['csrf_token'] = bin2hex(random_bytes(32));
}

// ĞĞ°Ñ‡Ğ°Ğ»ÑŒĞ½Ñ‹Ğµ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ñ
$errors = [];
$old = [
    'name' => '',
    'email' => '',
    'phone' => '',
    'birthdate' => '',
    'agree' => false,
];

// ĞĞ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ° Ñ„Ğ¾Ñ€Ğ¼Ñ‹
if ($_SERVER['REQUEST_METHOD'] === 'POST') {
    // ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° CSRF
    if (!hash_equals($_SESSION['csrf_token'], $_POST['csrf_token'] ?? '')) {
        die('ĞÑˆĞ¸Ğ±ĞºĞ° Ğ±ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾ÑÑ‚Ğ¸');
    }
    
    // Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½Ğ¸Ñ‚ÑŒ Ğ²Ğ²ĞµĞ´Ñ‘Ğ½Ğ½Ñ‹Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ
    $old = [
        'name' => trim($_POST['name'] ?? ''),
        'email' => trim($_POST['email'] ?? ''),
        'phone' => trim($_POST['phone'] ?? ''),
        'birthdate' => trim($_POST['birthdate'] ?? ''),
        'agree' => !empty($_POST['agree']),
    ];
    
    // Ğ’Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ñ
    $validator = new Validator($_POST);
    $validator->validate([
        'name' => 'required|alpha_spaces|between:2,100',
        'email' => 'required|email|max:255',
        'phone' => 'required|phone',
        'birthdate' => 'required|date:Y-m-d',
        'password' => 'required|min:8',
        'password_confirmation' => 'required',
        'agree' => 'required',
    ]);
    
    // ĞŸĞ¾Ğ´Ñ‚Ğ²ĞµÑ€Ğ¶Ğ´ĞµĞ½Ğ¸Ğµ Ğ¿Ğ°Ñ€Ğ¾Ğ»Ñ
    if ($_POST['password'] !== $_POST['password_confirmation']) {
        $validator->addError('password_confirmation', 'ĞŸĞ°Ñ€Ğ¾Ğ»Ğ¸ Ğ½Ğµ ÑĞ¾Ğ²Ğ¿Ğ°Ğ´Ğ°ÑÑ‚');
    }
    
    // ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ²Ğ¾Ğ·Ñ€Ğ°ÑÑ‚Ğ° (18+)
    if (!empty($old['birthdate'])) {
        $birthDate = new DateTime($old['birthdate']);
        $now = new DateTime();
        $age = $now->diff($birthDate)->y;
        
        if ($age < 18) {
            $validator->addError('birthdate', 'Ğ’Ğ°Ğ¼ Ğ´Ğ¾Ğ»Ğ¶Ğ½Ğ¾ Ğ±Ñ‹Ñ‚ÑŒ Ğ½Ğµ Ğ¼ĞµĞ½ĞµĞµ 18 Ğ»ĞµÑ‚');
        }
    }
    
    // ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° ÑƒĞ½Ğ¸ĞºĞ°Ğ»ÑŒĞ½Ğ¾ÑÑ‚Ğ¸ email
    if ($validator->passes()) {
        // Ğ—Ğ´ĞµÑÑŒ Ğ·Ğ°Ğ¿Ñ€Ğ¾Ñ Ğº Ğ‘Ğ”
        // if (emailExists($old['email'])) {
        //     $validator->addError('email', 'Ğ­Ñ‚Ğ¾Ñ‚ email ÑƒĞ¶Ğµ Ğ·Ğ°Ñ€ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½');
        // }
    }
    
    if ($validator->fails()) {
        $errors = $validator->errors();
    } else {
        // Ğ ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ
        $passwordHash = password_hash($_POST['password'], PASSWORD_DEFAULT);
        
        // Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ğµ Ğ² Ğ‘Ğ”...
        // createUser($old['name'], $old['email'], $passwordHash, ...);
        
        // Ğ£ÑĞ¿ĞµÑ… â€” Ñ€ĞµĞ´Ğ¸Ñ€ĞµĞºÑ‚
        $_SESSION['flash_success'] = 'Ğ ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ ÑƒÑĞ¿ĞµÑˆĞ½Ğ°! Ğ’Ğ¾Ğ¹Ğ´Ğ¸Ñ‚Ğµ Ğ² ÑĞ¸ÑÑ‚ĞµĞ¼Ñƒ.';
        header('Location: /login.php');
        exit;
    }
}

// Ğ¤ÑƒĞ½ĞºÑ†Ğ¸Ñ Ğ´Ğ»Ñ Ğ²Ñ‹Ğ²Ğ¾Ğ´Ğ° Ğ¾ÑˆĞ¸Ğ±ĞºĞ¸ Ğ¿Ğ¾Ğ»Ñ
function fieldError(string $field, array $errors): string {
    if (isset($errors[$field])) {
        return '<span class="error">' . htmlspecialchars($errors[$field]) . '</span>';
    }
    return '';
}

// Ğ¤ÑƒĞ½ĞºÑ†Ğ¸Ñ Ğ´Ğ»Ñ ĞºĞ»Ğ°ÑÑĞ° Ğ¿Ğ¾Ğ»Ñ Ñ Ğ¾ÑˆĞ¸Ğ±ĞºĞ¾Ğ¹
function fieldClass(string $field, array $errors): string {
    return isset($errors[$field]) ? 'has-error' : '';
}
?>
<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Ğ ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ</title>
    <style>
        .form-group { margin-bottom: 15px; }
        .form-group label { display: block; margin-bottom: 5px; }
        .form-group input { width: 100%; padding: 8px; box-sizing: border-box; }
        .form-group.has-error input { border-color: #dc3545; }
        .error { color: #dc3545; font-size: 14px; }
        .btn { padding: 10px 20px; background: #007bff; color: white; border: none; cursor: pointer; }
    </style>
</head>
<body>
    <h1>Ğ ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ</h1>
    
    <?php if (!empty($errors)): ?>
        <div class="alert alert-danger">
            <p>ĞŸĞ¾Ğ¶Ğ°Ğ»ÑƒĞ¹ÑÑ‚Ğ°, Ğ¸ÑĞ¿Ñ€Ğ°Ğ²ÑŒÑ‚Ğµ Ğ¾ÑˆĞ¸Ğ±ĞºĞ¸ Ğ² Ñ„Ğ¾Ñ€Ğ¼Ğµ.</p>
        </div>
    <?php endif; ?>
    
    <form method="POST" action="">
        <input type="hidden" name="csrf_token" value="<?= $_SESSION['csrf_token'] ?>">
        
        <div class="form-group <?= fieldClass('name', $errors) ?>">
            <label for="name">Ğ˜Ğ¼Ñ *</label>
            <input type="text" id="name" name="name" value="<?= htmlspecialchars($old['name']) ?>" required>
            <?= fieldError('name', $errors) ?>
        </div>
        
        <div class="form-group <?= fieldClass('email', $errors) ?>">
            <label for="email">Email *</label>
            <input type="email" id="email" name="email" value="<?= htmlspecialchars($old['email']) ?>" required>
            <?= fieldError('email', $errors) ?>
        </div>
        
        <div class="form-group <?= fieldClass('phone', $errors) ?>">
            <label for="phone">Ğ¢ĞµĞ»ĞµÑ„Ğ¾Ğ½ *</label>
            <input type="tel" id="phone" name="phone" value="<?= htmlspecialchars($old['phone']) ?>" 
                   placeholder="+7 (999) 123-45-67" required>
            <?= fieldError('phone', $errors) ?>
        </div>
        
        <div class="form-group <?= fieldClass('birthdate', $errors) ?>">
            <label for="birthdate">Ğ”Ğ°Ñ‚Ğ° Ñ€Ğ¾Ğ¶Ğ´ĞµĞ½Ğ¸Ñ *</label>
            <input type="date" id="birthdate" name="birthdate" value="<?= htmlspecialchars($old['birthdate']) ?>" required>
            <?= fieldError('birthdate', $errors) ?>
        </div>
        
        <div class="form-group <?= fieldClass('password', $errors) ?>">
            <label for="password">ĞŸĞ°Ñ€Ğ¾Ğ»ÑŒ * (Ğ¼Ğ¸Ğ½Ğ¸Ğ¼ÑƒĞ¼ 8 ÑĞ¸Ğ¼Ğ²Ğ¾Ğ»Ğ¾Ğ²)</label>
            <input type="password" id="password" name="password" required minlength="8">
            <?= fieldError('password', $errors) ?>
        </div>
        
        <div class="form-group <?= fieldClass('password_confirmation', $errors) ?>">
            <label for="password_confirmation">ĞŸĞ¾Ğ´Ñ‚Ğ²ĞµÑ€Ğ¶Ğ´ĞµĞ½Ğ¸Ğµ Ğ¿Ğ°Ñ€Ğ¾Ğ»Ñ *</label>
            <input type="password" id="password_confirmation" name="password_confirmation" required>
            <?= fieldError('password_confirmation', $errors) ?>
        </div>
        
        <div class="form-group <?= fieldClass('agree', $errors) ?>">
            <label>
                <input type="checkbox" name="agree" value="1" <?= $old['agree'] ? 'checked' : '' ?>>
                Ğ¯ ÑĞ¾Ğ³Ğ»Ğ°ÑĞµĞ½ Ñ <a href="/terms">ÑƒÑĞ»Ğ¾Ğ²Ğ¸ÑĞ¼Ğ¸ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ</a> *
            </label>
            <?= fieldError('agree', $errors) ?>
        </div>
        
        <button type="submit" class="btn">Ğ—Ğ°Ñ€ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒÑÑ</button>
    </form>
</body>
</html>
```

### ĞĞ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ° Ğ¼Ğ½Ğ¾Ğ¶ĞµÑÑ‚Ğ²ĞµĞ½Ğ½Ñ‹Ñ… Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğ¹

```php
<?php
// ĞœĞ½Ğ¾Ğ¶ĞµÑÑ‚Ğ²ĞµĞ½Ğ½Ñ‹Ğ¹ Ğ²Ñ‹Ğ±Ğ¾Ñ€ (select multiple, checkbox[])

// HTML Ñ„Ğ¾Ñ€Ğ¼Ğ°
?>
<form method="POST">
    <!-- Multiple select -->
    <select name="categories[]" multiple>
        <option value="1">ĞšĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ğ¸Ñ 1</option>
        <option value="2">ĞšĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ğ¸Ñ 2</option>
        <option value="3">ĞšĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ğ¸Ñ 3</option>
    </select>
    
    <!-- Checkbox Ğ³Ñ€ÑƒĞ¿Ğ¿Ğ° -->
    <label><input type="checkbox" name="tags[]" value="php"> PHP</label>
    <label><input type="checkbox" name="tags[]" value="js"> JavaScript</label>
    <label><input type="checkbox" name="tags[]" value="css"> CSS</label>
</form>

<?php
// ĞĞ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ°
if ($_SERVER['REQUEST_METHOD'] === 'POST') {
    // ĞŸĞ¾Ğ»ÑƒÑ‡Ğ°ĞµĞ¼ Ğ¼Ğ°ÑÑĞ¸Ğ²Ñ‹
    $categories = $_POST['categories'] ?? [];
    $tags = $_POST['tags'] ?? [];
    
    // Ğ£Ğ±ĞµĞ´Ğ¸Ñ‚ÑŒÑÑ Ñ‡Ñ‚Ğ¾ ÑÑ‚Ğ¾ Ğ¼Ğ°ÑÑĞ¸Ğ²Ñ‹
    if (!is_array($categories)) {
        $categories = [];
    }
    if (!is_array($tags)) {
        $tags = [];
    }
    
    // Ğ’Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ñ ĞºĞ°Ğ¶Ğ´Ğ¾Ğ³Ğ¾ ÑĞ»ĞµĞ¼ĞµĞ½Ñ‚Ğ°
    $allowedCategories = [1, 2, 3, 4, 5];
    $categories = array_filter($categories, function($cat) use ($allowedCategories) {
        return in_array((int) $cat, $allowedCategories, true);
    });
    $categories = array_map('intval', $categories);
    
    $allowedTags = ['php', 'js', 'css', 'html'];
    $tags = array_filter($tags, function($tag) use ($allowedTags) {
        return in_array($tag, $allowedTags, true);
    });
    
    // Ğ¢ĞµĞ¿ĞµÑ€ÑŒ $categories Ğ¸ $tags ÑĞ¾Ğ´ĞµÑ€Ğ¶Ğ°Ñ‚ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ğ²Ğ°Ğ»Ğ¸Ğ´Ğ½Ñ‹Ğµ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ñ
}

// Ğ”Ğ»Ñ Ğ²Ñ‹Ğ²Ğ¾Ğ´Ğ° Ñ ÑĞ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸ĞµĞ¼ Ğ²Ñ‹Ğ±Ğ¾Ñ€Ğ°
function isSelected($value, array $selected): string {
    return in_array($value, $selected) ? 'selected' : '';
}

function isChecked($value, array $checked): string {
    return in_array($value, $checked) ? 'checked' : '';
}
?>
<select name="categories[]" multiple>
    <option value="1" <?= isSelected(1, $categories) ?>>ĞšĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ğ¸Ñ 1</option>
    <option value="2" <?= isSelected(2, $categories) ?>>ĞšĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ğ¸Ñ 2</option>
</select>

<label><input type="checkbox" name="tags[]" value="php" <?= isChecked('php', $tags) ?>> PHP</label>
```

### Ğ’Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ñ Ñ„Ğ°Ğ¹Ğ»Ğ¾Ğ²

```php
<?php
class FileValidator {
    private array $errors = [];
    
    public function validate(
        array $file,
        array $allowedTypes = [],
        int $maxSize = 5 * 1024 * 1024,  // 5 MB
        array $allowedExtensions = []
    ): bool {
        $this->errors = [];
        
        // ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ¾ÑˆĞ¸Ğ±ĞºĞ¸ Ğ·Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ¸
        if ($file['error'] !== UPLOAD_ERR_OK) {
            $this->errors[] = $this->getUploadError($file['error']);
            return false;
        }
        
        // ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ñ€Ğ°Ğ·Ğ¼ĞµÑ€Ğ°
        if ($file['size'] > $maxSize) {
            $this->errors[] = 'Ğ¤Ğ°Ğ¹Ğ» ÑĞ»Ğ¸ÑˆĞºĞ¾Ğ¼ Ğ±Ğ¾Ğ»ÑŒÑˆĞ¾Ğ¹. ĞœĞ°ĞºÑĞ¸Ğ¼ÑƒĞ¼: ' . $this->formatSize($maxSize);
            return false;
        }
        
        if ($file['size'] === 0) {
            $this->errors[] = 'Ğ¤Ğ°Ğ¹Ğ» Ğ¿ÑƒÑÑ‚Ğ¾Ğ¹';
            return false;
        }
        
        // ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ñ€Ğ°ÑÑˆĞ¸Ñ€ĞµĞ½Ğ¸Ñ
        if (!empty($allowedExtensions)) {
            $ext = strtolower(pathinfo($file['name'], PATHINFO_EXTENSION));
            if (!in_array($ext, $allowedExtensions, true)) {
                $this->errors[] = 'ĞĞµĞ´Ğ¾Ğ¿ÑƒÑÑ‚Ğ¸Ğ¼Ğ¾Ğµ Ñ€Ğ°ÑÑˆĞ¸Ñ€ĞµĞ½Ğ¸Ğµ. Ğ Ğ°Ğ·Ñ€ĞµÑˆĞµĞ½Ñ‹: ' . implode(', ', $allowedExtensions);
                return false;
            }
        }
        
        // ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° MIME Ñ‚Ğ¸Ğ¿Ğ°
        if (!empty($allowedTypes)) {
            $finfo = finfo_open(FILEINFO_MIME_TYPE);
            $mimeType = finfo_file($finfo, $file['tmp_name']);
            finfo_close($finfo);
            
            if (!in_array($mimeType, $allowedTypes, true)) {
                $this->errors[] = 'ĞĞµĞ´Ğ¾Ğ¿ÑƒÑÑ‚Ğ¸Ğ¼Ñ‹Ğ¹ Ñ‚Ğ¸Ğ¿ Ñ„Ğ°Ğ¹Ğ»Ğ°';
                return false;
            }
        }
        
        return true;
    }
    
    public function validateImage(array $file, int $maxWidth = 0, int $maxHeight = 0): bool {
        // Ğ‘Ğ°Ğ·Ğ¾Ğ²Ğ°Ñ Ğ²Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ñ
        if (!$this->validate($file, 
            ['image/jpeg', 'image/png', 'image/gif', 'image/webp'],
            10 * 1024 * 1024,
            ['jpg', 'jpeg', 'png', 'gif', 'webp']
        )) {
            return false;
        }
        
        // ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ñ‡Ñ‚Ğ¾ ÑÑ‚Ğ¾ Ñ€ĞµĞ°Ğ»ÑŒĞ½Ğ¾Ğµ Ğ¸Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ğµ
        $imageInfo = @getimagesize($file['tmp_name']);
        if ($imageInfo === false) {
            $this->errors[] = 'Ğ¤Ğ°Ğ¹Ğ» Ğ½Ğµ ÑĞ²Ğ»ÑĞµÑ‚ÑÑ Ğ¸Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸ĞµĞ¼';
            return false;
        }
        
        // ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ñ€Ğ°Ğ·Ğ¼ĞµÑ€Ğ¾Ğ²
        [$width, $height] = $imageInfo;
        
        if ($maxWidth > 0 && $width > $maxWidth) {
            $this->errors[] = "Ğ¨Ğ¸Ñ€Ğ¸Ğ½Ğ° Ğ¸Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ñ Ğ½Ğµ Ğ´Ğ¾Ğ»Ğ¶Ğ½Ğ° Ğ¿Ñ€ĞµĞ²Ñ‹ÑˆĞ°Ñ‚ÑŒ {$maxWidth}px";
            return false;
        }
        
        if ($maxHeight > 0 && $height > $maxHeight) {
            $this->errors[] = "Ğ’Ñ‹ÑĞ¾Ñ‚Ğ° Ğ¸Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ñ Ğ½Ğµ Ğ´Ğ¾Ğ»Ğ¶Ğ½Ğ° Ğ¿Ñ€ĞµĞ²Ñ‹ÑˆĞ°Ñ‚ÑŒ {$maxHeight}px";
            return false;
        }
        
        return true;
    }
    
    public function errors(): array {
        return $this->errors;
    }
    
    public function firstError(): ?string {
        return $this->errors[0] ?? null;
    }
    
    private function getUploadError(int $code): string {
        return match ($code) {
            UPLOAD_ERR_INI_SIZE => 'Ğ¤Ğ°Ğ¹Ğ» Ğ¿Ñ€ĞµĞ²Ñ‹ÑˆĞ°ĞµÑ‚ Ğ¼Ğ°ĞºÑĞ¸Ğ¼Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ñ€Ğ°Ğ·Ğ¼ĞµÑ€',
            UPLOAD_ERR_FORM_SIZE => 'Ğ¤Ğ°Ğ¹Ğ» Ğ¿Ñ€ĞµĞ²Ñ‹ÑˆĞ°ĞµÑ‚ Ğ¼Ğ°ĞºÑĞ¸Ğ¼Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ñ€Ğ°Ğ·Ğ¼ĞµÑ€',
            UPLOAD_ERR_PARTIAL => 'Ğ¤Ğ°Ğ¹Ğ» Ğ·Ğ°Ğ³Ñ€ÑƒĞ¶ĞµĞ½ Ñ‡Ğ°ÑÑ‚Ğ¸Ñ‡Ğ½Ğ¾',
            UPLOAD_ERR_NO_FILE => 'Ğ¤Ğ°Ğ¹Ğ» Ğ½Ğµ Ğ²Ñ‹Ğ±Ñ€Ğ°Ğ½',
            UPLOAD_ERR_NO_TMP_DIR => 'ĞÑˆĞ¸Ğ±ĞºĞ° ÑĞµÑ€Ğ²ĞµÑ€Ğ°',
            UPLOAD_ERR_CANT_WRITE => 'ĞÑˆĞ¸Ğ±ĞºĞ° Ğ·Ğ°Ğ¿Ğ¸ÑĞ¸',
            UPLOAD_ERR_EXTENSION => 'Ğ—Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ° Ğ·Ğ°Ğ¿Ñ€ĞµÑ‰ĞµĞ½Ğ°',
            default => 'ĞĞµĞ¸Ğ·Ğ²ĞµÑÑ‚Ğ½Ğ°Ñ Ğ¾ÑˆĞ¸Ğ±ĞºĞ°',
        };
    }
    
    private function formatSize(int $bytes): string {
        $units = ['B', 'KB', 'MB', 'GB'];
        $i = 0;
        while ($bytes >= 1024 && $i < count($units) - 1) {
            $bytes /= 1024;
            $i++;
        }
        return round($bytes, 2) . ' ' . $units[$i];
    }
}

// Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ
$fileValidator = new FileValidator();

if (isset($_FILES['avatar'])) {
    if ($fileValidator->validateImage($_FILES['avatar'], 1000, 1000)) {
        // Ğ¤Ğ°Ğ¹Ğ» Ğ²Ğ°Ğ»Ğ¸Ğ´Ğ½Ñ‹Ğ¹, Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ ÑĞ¾Ñ…Ñ€Ğ°Ğ½ÑÑ‚ÑŒ
        move_uploaded_file($_FILES['avatar']['tmp_name'], 'uploads/' . uniqid() . '.jpg');
    } else {
        $errors['avatar'] = $fileValidator->firstError();
    }
}
```

---

## 7. AJAX Ñ„Ğ¾Ñ€Ğ¼Ñ‹

### ĞÑ‚Ğ¿Ñ€Ğ°Ğ²ĞºĞ° Ñ‡ĞµÑ€ĞµĞ· Fetch API

```html
<!-- HTML Ñ„Ğ¾Ñ€Ğ¼Ğ° -->
<form id="contactForm">
    <input type="hidden" name="csrf_token" value="<?= $_SESSION['csrf_token'] ?>">
    
    <div class="form-group">
        <label for="name">Ğ˜Ğ¼Ñ</label>
        <input type="text" id="name" name="name" required>
        <span class="error" data-field="name"></span>
    </div>
    
    <div class="form-group">
        <label for="email">Email</label>
        <input type="email" id="email" name="email" required>
        <span class="error" data-field="email"></span>
    </div>
    
    <div class="form-group">
        <label for="message">Ğ¡Ğ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğµ</label>
        <textarea id="message" name="message" required></textarea>
        <span class="error" data-field="message"></span>
    </div>
    
    <button type="submit">ĞÑ‚Ğ¿Ñ€Ğ°Ğ²Ğ¸Ñ‚ÑŒ</button>
    <div id="formResult"></div>
</form>

<script>
document.getElementById('contactForm').addEventListener('submit', async function(e) {
    e.preventDefault();
    
    // ĞÑ‡Ğ¸ÑÑ‚Ğ¸Ñ‚ÑŒ Ğ¿Ñ€ĞµĞ´Ñ‹Ğ´ÑƒÑ‰Ğ¸Ğµ Ğ¾ÑˆĞ¸Ğ±ĞºĞ¸
    document.querySelectorAll('.error').forEach(el => el.textContent = '');
    document.querySelectorAll('.has-error').forEach(el => el.classList.remove('has-error'));
    
    const formData = new FormData(this);
    
    try {
        const response = await fetch('/api/contact.php', {
            method: 'POST',
            body: formData
        });
        
        const result = await response.json();
        
        if (result.success) {
            document.getElementById('formResult').innerHTML = 
                '<div class="success">' + result.message + '</div>';
            this.reset();
        } else {
            // ĞŸĞ¾ĞºĞ°Ğ·Ğ°Ñ‚ÑŒ Ğ¾ÑˆĞ¸Ğ±ĞºĞ¸
            if (result.errors) {
                for (const [field, message] of Object.entries(result.errors)) {
                    const errorEl = document.querySelector(`[data-field="${field}"]`);
                    const inputEl = document.getElementById(field);
                    
                    if (errorEl) {
                        errorEl.textContent = message;
                    }
                    if (inputEl) {
                        inputEl.parentElement.classList.add('has-error');
                    }
                }
            }
        }
    } catch (error) {
        document.getElementById('formResult').innerHTML = 
            '<div class="error">ĞÑˆĞ¸Ğ±ĞºĞ° Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²ĞºĞ¸. ĞŸĞ¾Ğ¿Ñ€Ğ¾Ğ±ÑƒĞ¹Ñ‚Ğµ Ğ¿Ğ¾Ğ·Ğ¶Ğµ.</div>';
    }
});
</script>
```

### PHP Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‡Ğ¸Ğº Ğ´Ğ»Ñ AJAX

```php
<?php
// api/contact.php

session_start();

header('Content-Type: application/json; charset=UTF-8');

// Ğ¤ÑƒĞ½ĞºÑ†Ğ¸Ñ Ğ¾Ñ‚Ğ²ĞµÑ‚Ğ°
function jsonResponse(array $data): never {
    echo json_encode($data, JSON_UNESCAPED_UNICODE);
    exit;
}

// ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ¼ĞµÑ‚Ğ¾Ğ´Ğ°
if ($_SERVER['REQUEST_METHOD'] !== 'POST') {
    http_response_code(405);
    jsonResponse(['success' => false, 'message' => 'Method not allowed']);
}

// CSRF Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ°
if (!isset($_POST['csrf_token']) || !hash_equals($_SESSION['csrf_token'] ?? '', $_POST['csrf_token'])) {
    http_response_code(403);
    jsonResponse(['success' => false, 'message' => 'Invalid CSRF token']);
}

// Ğ’Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ñ
$validator = new Validator($_POST);
$validator->validate([
    'name' => 'required|alpha_spaces|between:2,100',
    'email' => 'required|email',
    'message' => 'required|min:10|max:5000',
]);

if ($validator->fails()) {
    http_response_code(422);
    jsonResponse([
        'success' => false,
        'errors' => $validator->errors(),
    ]);
}

// ĞĞ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ°
$data = $validator->validated();

// Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ğµ, Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²ĞºĞ° email Ğ¸ Ñ‚.Ğ´.
// ...

// Ğ£ÑĞ¿ĞµÑ…
jsonResponse([
    'success' => true,
    'message' => 'Ğ¡Ğ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğµ Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¾! ĞœÑ‹ ÑĞ²ÑĞ¶ĞµĞ¼ÑÑ Ñ Ğ²Ğ°Ğ¼Ğ¸ Ğ² Ğ±Ğ»Ğ¸Ğ¶Ğ°Ğ¹ÑˆĞµĞµ Ğ²Ñ€ĞµĞ¼Ñ.',
]);
```

---

## 8. Ğ‘ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾ÑÑ‚ÑŒ Ñ„Ğ¾Ñ€Ğ¼

### Ğ—Ğ°Ñ‰Ğ¸Ñ‚Ğ° Ğ¾Ñ‚ ÑĞ¿Ğ°Ğ¼Ğ° (Honeypot)

```php
<?php
// Honeypot â€” ÑĞºÑ€Ñ‹Ñ‚Ğ¾Ğµ Ğ¿Ğ¾Ğ»Ğµ, ĞºĞ¾Ñ‚Ğ¾Ñ€Ğ¾Ğµ Ğ±Ğ¾Ñ‚Ñ‹ Ğ·Ğ°Ğ¿Ğ¾Ğ»Ğ½ÑÑÑ‚, Ğ° Ğ»ÑĞ´Ğ¸ â€” Ğ½ĞµÑ‚
?>
<form method="POST">
    <!-- Ğ¡ĞºÑ€Ñ‹Ñ‚Ğ¾Ğµ Ğ¿Ğ¾Ğ»Ğµ-Ğ»Ğ¾Ğ²ÑƒÑˆĞºĞ° -->
    <div style="position: absolute; left: -9999px;">
        <label for="website">Website (leave empty)</label>
        <input type="text" name="website" id="website" tabindex="-1" autocomplete="off">
    </div>
    
    <!-- Ğ ĞµĞ°Ğ»ÑŒĞ½Ñ‹Ğµ Ğ¿Ğ¾Ğ»Ñ -->
    <input type="text" name="name">
    <input type="email" name="email">
    <textarea name="message"></textarea>
    <button type="submit">ĞÑ‚Ğ¿Ñ€Ğ°Ğ²Ğ¸Ñ‚ÑŒ</button>
</form>

<?php
// ĞĞ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ°
if ($_SERVER['REQUEST_METHOD'] === 'POST') {
    // Ğ•ÑĞ»Ğ¸ honeypot Ğ·Ğ°Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½ â€” ÑÑ‚Ğ¾ Ğ±Ğ¾Ñ‚
    if (!empty($_POST['website'])) {
        // ĞŸÑ€Ğ¸Ñ‚Ğ²Ğ¾Ñ€Ğ¸Ñ‚ÑŒÑÑ Ñ‡Ñ‚Ğ¾ Ğ²ÑÑ‘ Ğ¾Ğº, Ğ½Ğ¾ Ğ½Ğ¸Ñ‡ĞµĞ³Ğ¾ Ğ½Ğµ Ğ´ĞµĞ»Ğ°Ñ‚ÑŒ
        $_SESSION['flash_success'] = 'Ğ¡Ğ¿Ğ°ÑĞ¸Ğ±Ğ¾ Ğ·Ğ° ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğµ!';
        header('Location: /contact.php');
        exit;
    }
    
    // ĞŸÑ€Ğ¾Ğ´Ğ¾Ğ»Ğ¶Ğ¸Ñ‚ÑŒ Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºÑƒ...
}
```

### Ğ—Ğ°Ñ‰Ğ¸Ñ‚Ğ° Ğ¾Ñ‚ Ğ¼Ğ½Ğ¾Ğ³Ğ¾ĞºÑ€Ğ°Ñ‚Ğ½Ğ¾Ğ¹ Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²ĞºĞ¸

```php
<?php
// Ğ¢Ğ¾ĞºĞµĞ½ Ğ¾Ğ´Ğ½Ğ¾Ñ€Ğ°Ğ·Ğ¾Ğ²Ğ¾Ğ³Ğ¾ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ

function generateFormToken(): string {
    $token = bin2hex(random_bytes(32));
    $_SESSION['form_tokens'][$token] = time();
    return $token;
}

function validateFormToken(string $token): bool {
    if (!isset($_SESSION['form_tokens'][$token])) {
        return false;
    }
    
    // Ğ£Ğ´Ğ°Ğ»Ğ¸Ñ‚ÑŒ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğ¹ Ñ‚Ğ¾ĞºĞµĞ½
    unset($_SESSION['form_tokens'][$token]);
    
    // ĞÑ‡Ğ¸ÑÑ‚Ğ¸Ñ‚ÑŒ ÑÑ‚Ğ°Ñ€Ñ‹Ğµ Ñ‚Ğ¾ĞºĞµĞ½Ñ‹ (ÑÑ‚Ğ°Ñ€ÑˆĞµ 1 Ñ‡Ğ°ÑĞ°)
    $_SESSION['form_tokens'] = array_filter(
        $_SESSION['form_tokens'] ?? [],
        fn($time) => $time > time() - 3600
    );
    
    return true;
}

// Ğ’ Ñ„Ğ¾Ñ€Ğ¼Ğµ
$formToken = generateFormToken();
?>
<form method="POST">
    <input type="hidden" name="form_token" value="<?= $formToken ?>">
    <!-- Ğ¾ÑÑ‚Ğ°Ğ»ÑŒĞ½Ñ‹Ğµ Ğ¿Ğ¾Ğ»Ñ -->
</form>

<?php
// ĞŸÑ€Ğ¸ Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞµ
if ($_SERVER['REQUEST_METHOD'] === 'POST') {
    if (!validateFormToken($_POST['form_token'] ?? '')) {
        die('Ğ¤Ğ¾Ñ€Ğ¼Ğ° ÑƒĞ¶Ğµ Ğ±Ñ‹Ğ»Ğ° Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ°. ĞĞ±Ğ½Ğ¾Ğ²Ğ¸Ñ‚Ğµ ÑÑ‚Ñ€Ğ°Ğ½Ğ¸Ñ†Ñƒ.');
    }
    
    // ĞĞ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ°...
}
```

### Rate Limiting Ğ´Ğ»Ñ Ñ„Ğ¾Ñ€Ğ¼

```php
<?php
class FormRateLimiter {
    private string $key;
    private int $maxAttempts;
    private int $decaySeconds;
    
    public function __construct(string $formName, int $maxAttempts = 5, int $decaySeconds = 60) {
        $this->key = 'form_limit_' . $formName . '_' . md5($_SERVER['REMOTE_ADDR']);
        $this->maxAttempts = $maxAttempts;
        $this->decaySeconds = $decaySeconds;
    }
    
    public function attempt(): bool {
        if (!isset($_SESSION[$this->key])) {
            $_SESSION[$this->key] = [
                'attempts' => 0,
                'reset_at' => time() + $this->decaySeconds,
            ];
        }
        
        // Ğ¡Ğ±Ñ€Ğ¾Ñ ĞµÑĞ»Ğ¸ Ğ²Ñ€ĞµĞ¼Ñ Ğ¸ÑÑ‚ĞµĞºĞ»Ğ¾
        if ($_SESSION[$this->key]['reset_at'] <= time()) {
            $_SESSION[$this->key] = [
                'attempts' => 0,
                'reset_at' => time() + $this->decaySeconds,
            ];
        }
        
        if ($_SESSION[$this->key]['attempts'] >= $this->maxAttempts) {
            return false;
        }
        
        $_SESSION[$this->key]['attempts']++;
        return true;
    }
    
    public function remaining(): int {
        return max(0, $this->maxAttempts - ($_SESSION[$this->key]['attempts'] ?? 0));
    }
    
    public function retryAfter(): int {
        return max(0, ($_SESSION[$this->key]['reset_at'] ?? 0) - time());
    }
}

// Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ
session_start();

$limiter = new FormRateLimiter('contact', 3, 300);  // 3 Ğ¿Ğ¾Ğ¿Ñ‹Ñ‚ĞºĞ¸ Ğ·Ğ° 5 Ğ¼Ğ¸Ğ½ÑƒÑ‚

if ($_SERVER['REQUEST_METHOD'] === 'POST') {
    if (!$limiter->attempt()) {
        $waitSeconds = $limiter->retryAfter();
        die("Ğ¡Ğ»Ğ¸ÑˆĞºĞ¾Ğ¼ Ğ¼Ğ½Ğ¾Ğ³Ğ¾ Ğ¿Ğ¾Ğ¿Ñ‹Ñ‚Ğ¾Ğº. ĞŸĞ¾Ğ´Ğ¾Ğ¶Ğ´Ğ¸Ñ‚Ğµ " . ceil($waitSeconds / 60) . " Ğ¼Ğ¸Ğ½.");
    }
    
    // ĞĞ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ° Ñ„Ğ¾Ñ€Ğ¼Ñ‹...
}
```

---

## 9. ĞŸÑ€Ğ°ĞºÑ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğµ Ğ¿Ñ€Ğ¸Ğ¼ĞµÑ€Ñ‹

### ĞŸÑ€Ğ¸Ğ¼ĞµÑ€ 1: Ğ¤Ğ¾Ñ€Ğ¼Ğ° Ğ¾Ğ±Ñ€Ğ°Ñ‚Ğ½Ğ¾Ğ¹ ÑĞ²ÑĞ·Ğ¸ Ñ Ñ„Ğ°Ğ¹Ğ»Ğ¾Ğ¼

```php
<?php
session_start();

// CSRF
if (empty($_SESSION['csrf_token'])) {
    $_SESSION['csrf_token'] = bin2hex(random_bytes(32));
}

$errors = [];
$success = false;

if ($_SERVER['REQUEST_METHOD'] === 'POST') {
    // CSRF Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ°
    if (!hash_equals($_SESSION['csrf_token'], $_POST['csrf_token'] ?? '')) {
        die('ĞÑˆĞ¸Ğ±ĞºĞ° Ğ±ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾ÑÑ‚Ğ¸');
    }
    
    // Ğ’Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ñ Ñ‚ĞµĞºÑÑ‚Ğ¾Ğ²Ñ‹Ñ… Ğ¿Ğ¾Ğ»ĞµĞ¹
    $validator = new Validator($_POST);
    $validator->validate([
        'name' => 'required|alpha_spaces|between:2,100',
        'email' => 'required|email',
        'subject' => 'required|between:5,200',
        'message' => 'required|between:20,5000',
    ]);
    
    // Ğ’Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ñ Ñ„Ğ°Ğ¹Ğ»Ğ° (ĞµÑĞ»Ğ¸ Ğ·Ğ°Ğ³Ñ€ÑƒĞ¶ĞµĞ½)
    $attachment = null;
    if (isset($_FILES['attachment']) && $_FILES['attachment']['error'] !== UPLOAD_ERR_NO_FILE) {
        $fileValidator = new FileValidator();
        
        if (!$fileValidator->validate(
            $_FILES['attachment'],
            ['application/pdf', 'image/jpeg', 'image/png'],
            2 * 1024 * 1024,  // 2 MB
            ['pdf', 'jpg', 'jpeg', 'png']
        )) {
            $validator->addError('attachment', $fileValidator->firstError());
        } else {
            $attachment = $_FILES['attachment'];
        }
    }
    
    if ($validator->fails()) {
        $errors = $validator->errors();
    } else {
        // Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ğµ Ñ„Ğ°Ğ¹Ğ»Ğ°
        $attachmentPath = null;
        if ($attachment) {
            $ext = pathinfo($attachment['name'], PATHINFO_EXTENSION);
            $filename = uniqid('attach_') . '.' . $ext;
            $attachmentPath = 'uploads/attachments/' . $filename;
            move_uploaded_file($attachment['tmp_name'], $attachmentPath);
        }
        
        // ĞÑ‚Ğ¿Ñ€Ğ°Ğ²ĞºĞ° email Ğ¸Ğ»Ğ¸ ÑĞ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ğµ Ğ² Ğ‘Ğ”
        $data = $validator->validated();
        // sendContactEmail($data, $attachmentPath);
        // saveContactMessage($data, $attachmentPath);
        
        $success = true;
        
        // Ğ ĞµĞ³ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ñ CSRF Ñ‚Ğ¾ĞºĞµĞ½Ğ°
        $_SESSION['csrf_token'] = bin2hex(random_bytes(32));
    }
}
?>
<!DOCTYPE html>
<html>
<head>
    <title>ĞĞ±Ñ€Ğ°Ñ‚Ğ½Ğ°Ñ ÑĞ²ÑĞ·ÑŒ</title>
</head>
<body>
    <h1>ĞĞ±Ñ€Ğ°Ñ‚Ğ½Ğ°Ñ ÑĞ²ÑĞ·ÑŒ</h1>
    
    <?php if ($success): ?>
        <div class="success">Ğ¡Ğ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğµ Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¾!</div>
    <?php else: ?>
        <form method="POST" enctype="multipart/form-data">
            <input type="hidden" name="csrf_token" value="<?= $_SESSION['csrf_token'] ?>">
            
            <div>
                <label>Ğ˜Ğ¼Ñ *</label>
                <input type="text" name="name" value="<?= htmlspecialchars($_POST['name'] ?? '') ?>">
                <?php if (isset($errors['name'])): ?>
                    <span class="error"><?= htmlspecialchars($errors['name']) ?></span>
                <?php endif; ?>
            </div>
            
            <div>
                <label>Email *</label>
                <input type="email" name="email" value="<?= htmlspecialchars($_POST['email'] ?? '') ?>">
                <?php if (isset($errors['email'])): ?>
                    <span class="error"><?= htmlspecialchars($errors['email']) ?></span>
                <?php endif; ?>
            </div>
            
            <div>
                <label>Ğ¢ĞµĞ¼Ğ° *</label>
                <input type="text" name="subject" value="<?= htmlspecialchars($_POST['subject'] ?? '') ?>">
                <?php if (isset($errors['subject'])): ?>
                    <span class="error"><?= htmlspecialchars($errors['subject']) ?></span>
                <?php endif; ?>
            </div>
            
            <div>
                <label>Ğ¡Ğ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğµ *</label>
                <textarea name="message"><?= htmlspecialchars($_POST['message'] ?? '') ?></textarea>
                <?php if (isset($errors['message'])): ?>
                    <span class="error"><?= htmlspecialchars($errors['message']) ?></span>
                <?php endif; ?>
            </div>
            
            <div>
                <label>ĞŸÑ€Ğ¸ĞºÑ€ĞµĞ¿Ğ¸Ñ‚ÑŒ Ñ„Ğ°Ğ¹Ğ» (PDF, JPG, PNG Ğ´Ğ¾ 2MB)</label>
                <input type="file" name="attachment" accept=".pdf,.jpg,.jpeg,.png">
                <?php if (isset($errors['attachment'])): ?>
                    <span class="error"><?= htmlspecialchars($errors['attachment']) ?></span>
                <?php endif; ?>
            </div>
            
            <button type="submit">ĞÑ‚Ğ¿Ñ€Ğ°Ğ²Ğ¸Ñ‚ÑŒ</button>
        </form>
    <?php endif; ?>
</body>
</html>
```

### ĞŸÑ€Ğ¸Ğ¼ĞµÑ€ 2: Ğ¤Ğ¾Ñ€Ğ¼Ğ° Ñ€ĞµĞ´Ğ°ĞºÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ Ğ¿Ñ€Ğ¾Ñ„Ğ¸Ğ»Ñ

```php
<?php
session_start();
requireLogin();  // ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ°Ğ²Ñ‚Ğ¾Ñ€Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸

$user = getCurrentUser();  // ĞŸĞ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ¸Ğ· Ğ‘Ğ”

$errors = [];
$success = false;

if ($_SERVER['REQUEST_METHOD'] === 'POST') {
    // CSRF
    if (!hash_equals($_SESSION['csrf_token'], $_POST['csrf_token'] ?? '')) {
        die('ĞÑˆĞ¸Ğ±ĞºĞ° Ğ±ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾ÑÑ‚Ğ¸');
    }
    
    // Ğ’Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ñ
    $validator = new Validator($_POST);
    $validator->validate([
        'name' => 'required|alpha_spaces|between:2,100',
        'email' => 'required|email',
        'phone' => 'nullable|phone',
        'bio' => 'nullable|max:500',
    ]);
    
    // ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° ÑƒĞ½Ğ¸ĞºĞ°Ğ»ÑŒĞ½Ğ¾ÑÑ‚Ğ¸ email (ĞºÑ€Ğ¾Ğ¼Ğµ Ñ‚ĞµĞºÑƒÑ‰ĞµĞ³Ğ¾ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ)
    if ($validator->passes()) {
        $email = trim($_POST['email']);
        if ($email !== $user['email'] && emailExists($email)) {
            $validator->addError('email', 'Ğ­Ñ‚Ğ¾Ñ‚ email ÑƒĞ¶Ğµ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ÑÑ');
        }
    }
    
    // ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ñ‚ĞµĞºÑƒÑ‰ĞµĞ³Ğ¾ Ğ¿Ğ°Ñ€Ğ¾Ğ»Ñ ĞµÑĞ»Ğ¸ Ğ¼ĞµĞ½ÑĞµÑ‚ÑÑ
    if (!empty($_POST['new_password'])) {
        if (empty($_POST['current_password'])) {
            $validator->addError('current_password', 'Ğ’Ğ²ĞµĞ´Ğ¸Ñ‚Ğµ Ñ‚ĞµĞºÑƒÑ‰Ğ¸Ğ¹ Ğ¿Ğ°Ñ€Ğ¾Ğ»ÑŒ');
        } elseif (!password_verify($_POST['current_password'], $user['password_hash'])) {
            $validator->addError('current_password', 'ĞĞµĞ²ĞµÑ€Ğ½Ñ‹Ğ¹ Ñ‚ĞµĞºÑƒÑ‰Ğ¸Ğ¹ Ğ¿Ğ°Ñ€Ğ¾Ğ»ÑŒ');
        }
        
        if (mb_strlen($_POST['new_password']) < 8) {
            $validator->addError('new_password', 'ĞŸĞ°Ñ€Ğ¾Ğ»ÑŒ Ğ´Ğ¾Ğ»Ğ¶ĞµĞ½ Ğ±Ñ‹Ñ‚ÑŒ Ğ½Ğµ Ğ¼ĞµĞ½ĞµĞµ 8 ÑĞ¸Ğ¼Ğ²Ğ¾Ğ»Ğ¾Ğ²');
        }
        
        if ($_POST['new_password'] !== $_POST['new_password_confirmation']) {
            $validator->addError('new_password_confirmation', 'ĞŸĞ°Ñ€Ğ¾Ğ»Ğ¸ Ğ½Ğµ ÑĞ¾Ğ²Ğ¿Ğ°Ğ´Ğ°ÑÑ‚');
        }
    }
    
    // ĞĞ²Ğ°Ñ‚Ğ°Ñ€
    if (isset($_FILES['avatar']) && $_FILES['avatar']['error'] !== UPLOAD_ERR_NO_FILE) {
        $fileValidator = new FileValidator();
        if (!$fileValidator->validateImage($_FILES['avatar'], 500, 500)) {
            $validator->addError('avatar', $fileValidator->firstError());
        }
    }
    
    if ($validator->fails()) {
        $errors = $validator->errors();
    } else {
        // ĞĞ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…
        $updateData = [
            'name' => trim($_POST['name']),
            'email' => trim($_POST['email']),
            'phone' => trim($_POST['phone']) ?: null,
            'bio' => trim($_POST['bio']) ?: null,
        ];
        
        // ĞĞ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ¿Ğ°Ñ€Ğ¾Ğ»Ñ
        if (!empty($_POST['new_password'])) {
            $updateData['password_hash'] = password_hash($_POST['new_password'], PASSWORD_DEFAULT);
        }
        
        // Ğ—Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ° Ğ°Ğ²Ğ°Ñ‚Ğ°Ñ€Ğ°
        if (isset($_FILES['avatar']) && $_FILES['avatar']['error'] === UPLOAD_ERR_OK) {
            $ext = pathinfo($_FILES['avatar']['name'], PATHINFO_EXTENSION);
            $filename = 'avatar_' . $user['id'] . '_' . time() . '.' . $ext;
            
            // Ğ£Ğ´Ğ°Ğ»Ğ¸Ñ‚ÑŒ ÑÑ‚Ğ°Ñ€Ñ‹Ğ¹ Ğ°Ğ²Ğ°Ñ‚Ğ°Ñ€
            if ($user['avatar']) {
                @unlink('uploads/avatars/' . $user['avatar']);
            }
            
            move_uploaded_file($_FILES['avatar']['tmp_name'], 'uploads/avatars/' . $filename);
            $updateData['avatar'] = $filename;
        }
        
        // Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ğµ Ğ² Ğ‘Ğ”
        updateUser($user['id'], $updateData);
        
        $_SESSION['flash_success'] = 'ĞŸÑ€Ğ¾Ñ„Ğ¸Ğ»ÑŒ Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»Ñ‘Ğ½';
        header('Location: /profile/edit');
        exit;
    }
}

// Ğ¢ĞµĞºÑƒÑ‰Ğ¸Ğµ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ñ
$current = [
    'name' => $_POST['name'] ?? $user['name'],
    'email' => $_POST['email'] ?? $user['email'],
    'phone' => $_POST['phone'] ?? $user['phone'],
    'bio' => $_POST['bio'] ?? $user['bio'],
];
?>
<!-- Ğ¤Ğ¾Ñ€Ğ¼Ğ° Ñ€ĞµĞ´Ğ°ĞºÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ Ğ¿Ñ€Ğ¾Ñ„Ğ¸Ğ»Ñ -->
```

---

## 10. Ğ£Ğ¿Ñ€Ğ°Ğ¶Ğ½ĞµĞ½Ğ¸Ñ

### Ğ£Ğ¿Ñ€Ğ°Ğ¶Ğ½ĞµĞ½Ğ¸Ğµ 1: ĞŸÑ€Ğ¾ÑÑ‚Ğ°Ñ Ğ²Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ñ (15 Ğ¼Ğ¸Ğ½ÑƒÑ‚)

```php
<?php
// Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ¹ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¸ Ğ²Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ğ¸:
// 1. validateEmail($email) â€” Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ° email
// 2. validatePhone($phone) â€” Ñ€Ğ¾ÑÑĞ¸Ğ¹ÑĞºĞ¸Ğ¹ Ğ½Ğ¾Ğ¼ĞµÑ€ (+7 Ğ¸Ğ»Ğ¸ 8, 10 Ñ†Ğ¸Ñ„Ñ€)
// 3. validatePassword($password) â€” Ğ¼Ğ¸Ğ½Ğ¸Ğ¼ÑƒĞ¼ 8 ÑĞ¸Ğ¼Ğ²Ğ¾Ğ»Ğ¾Ğ², Ğ±ÑƒĞºĞ²Ñ‹ Ğ¸ Ñ†Ğ¸Ñ„Ñ€Ñ‹
// 4. validateDate($date, $format) â€” Ğ²Ğ°Ğ»Ğ¸Ğ´Ğ½Ğ°Ñ Ğ´Ğ°Ñ‚Ğ° Ğ² ÑƒĞºĞ°Ğ·Ğ°Ğ½Ğ½Ğ¾Ğ¼ Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚Ğµ
// 5. validateAge($birthDate, $minAge) â€” Ğ²Ğ¾Ğ·Ñ€Ğ°ÑÑ‚ Ğ½Ğµ Ğ¼ĞµĞ½ĞµĞµ ÑƒĞºĞ°Ğ·Ğ°Ğ½Ğ½Ğ¾Ğ³Ğ¾

// ĞšĞ°Ğ¶Ğ´Ğ°Ñ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ñ Ğ²Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‰Ğ°ĞµÑ‚ true Ğ¸Ğ»Ğ¸ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğµ Ğ¾Ğ± Ğ¾ÑˆĞ¸Ğ±ĞºĞµ
```

### Ğ£Ğ¿Ñ€Ğ°Ğ¶Ğ½ĞµĞ½Ğ¸Ğµ 2: ĞšĞ»Ğ°ÑÑ Ñ„Ğ¾Ñ€Ğ¼Ñ‹ (25 Ğ¼Ğ¸Ğ½ÑƒÑ‚)

```php
<?php
// Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ¹ ĞºĞ»Ğ°ÑÑ Form Ğ´Ğ»Ñ ÑƒĞ´Ğ¾Ğ±Ğ½Ğ¾Ğ¹ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‹ Ñ Ñ„Ğ¾Ñ€Ğ¼Ğ°Ğ¼Ğ¸:
// - Ğ“ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ñ CSRF Ñ‚Ğ¾ĞºĞµĞ½Ğ° Ğ¸ Ğ¿Ğ¾Ğ»Ñ
// - ĞœĞµÑ‚Ğ¾Ğ´Ñ‹ Ğ´Ğ»Ñ ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ñ Ğ¿Ğ¾Ğ»ĞµĞ¹ (text, email, textarea, select, checkbox)
// - ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¾Ğµ Ğ·Ğ°Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ğµ ÑÑ‚Ğ°Ñ€Ñ‹Ñ… Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğ¹
// - Ğ’Ñ‹Ğ²Ğ¾Ğ´ Ğ¾ÑˆĞ¸Ğ±Ğ¾Ğº Ğ¿Ğ¾Ğ´ Ğ¿Ğ¾Ğ»ÑĞ¼Ğ¸

// ĞŸÑ€Ğ¸Ğ¼ĞµÑ€ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ:
// $form = new Form($_POST, $errors);
// echo $form->text('name', 'Ğ˜Ğ¼Ñ');
// echo $form->email('email', 'Email');
// echo $form->select('country', 'Ğ¡Ñ‚Ñ€Ğ°Ğ½Ğ°', ['ru' => 'Ğ Ğ¾ÑÑĞ¸Ñ', 'us' => 'Ğ¡Ğ¨Ğ']);
// echo $form->submit('ĞÑ‚Ğ¿Ñ€Ğ°Ğ²Ğ¸Ñ‚ÑŒ');
```

### Ğ£Ğ¿Ñ€Ğ°Ğ¶Ğ½ĞµĞ½Ğ¸Ğµ 3: Ğ’Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ‚Ğ¾Ñ€ Ñ Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»Ğ°Ğ¼Ğ¸ (30 Ğ¼Ğ¸Ğ½ÑƒÑ‚)

```php
<?php
// Ğ Ğ°ÑÑˆĞ¸Ñ€ÑŒ ĞºĞ»Ğ°ÑÑ Validator Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ¸Ğ² Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»Ğ°:
// - 'different:field' â€” Ğ´Ğ¾Ğ»Ğ¶Ğ½Ğ¾ Ğ¾Ñ‚Ğ»Ğ¸Ñ‡Ğ°Ñ‚ÑŒÑÑ Ğ¾Ñ‚ Ğ´Ñ€ÑƒĞ³Ğ¾Ğ³Ğ¾ Ğ¿Ğ¾Ğ»Ñ
// - 'same:field' â€” Ğ´Ğ¾Ğ»Ğ¶Ğ½Ğ¾ ÑĞ¾Ğ²Ğ¿Ğ°Ğ´Ğ°Ñ‚ÑŒ Ñ Ğ´Ñ€ÑƒĞ³Ğ¸Ğ¼ Ğ¿Ğ¾Ğ»ĞµĞ¼
// - 'before:date' â€” Ğ´Ğ°Ñ‚Ğ° Ğ´Ğ¾Ğ»Ğ¶Ğ½Ğ° Ğ±Ñ‹Ñ‚ÑŒ Ñ€Ğ°Ğ½ÑŒÑˆĞµ ÑƒĞºĞ°Ğ·Ğ°Ğ½Ğ½Ğ¾Ğ¹
// - 'after:date' â€” Ğ´Ğ°Ñ‚Ğ° Ğ´Ğ¾Ğ»Ğ¶Ğ½Ğ° Ğ±Ñ‹Ñ‚ÑŒ Ğ¿Ğ¾Ğ·Ğ¶Ğµ ÑƒĞºĞ°Ğ·Ğ°Ğ½Ğ½Ğ¾Ğ¹
// - 'digits:length' â€” ÑÑ‚Ñ€Ğ¾ĞºĞ° Ğ¸Ğ· Ñ‚Ğ¾Ñ‡Ğ½Ğ¾Ğ³Ğ¾ ĞºĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ğ° Ñ†Ğ¸Ñ„Ñ€
// - 'array' â€” Ğ´Ğ¾Ğ»Ğ¶ĞµĞ½ Ğ±Ñ‹Ñ‚ÑŒ Ğ¼Ğ°ÑÑĞ¸Ğ²Ğ¾Ğ¼
// - 'array_min:n' â€” Ğ¼Ğ°ÑÑĞ¸Ğ² Ğ¼Ğ¸Ğ½Ğ¸Ğ¼ÑƒĞ¼ n ÑĞ»ĞµĞ¼ĞµĞ½Ñ‚Ğ¾Ğ²
// - 'file' â€” Ğ´Ğ¾Ğ»Ğ¶ĞµĞ½ Ğ±Ñ‹Ñ‚ÑŒ Ğ·Ğ°Ğ³Ñ€ÑƒĞ¶ĞµĞ½Ğ½Ñ‹Ğ¼ Ñ„Ğ°Ğ¹Ğ»Ğ¾Ğ¼
// - 'image' â€” Ğ´Ğ¾Ğ»Ğ¶ĞµĞ½ Ğ±Ñ‹Ñ‚ÑŒ Ğ¸Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸ĞµĞ¼
```

### Ğ£Ğ¿Ñ€Ğ°Ğ¶Ğ½ĞµĞ½Ğ¸Ğµ 4: Ğ¤Ğ¾Ñ€Ğ¼Ğ° Ğ·Ğ°ĞºĞ°Ğ·Ğ° (40 Ğ¼Ğ¸Ğ½ÑƒÑ‚)

```php
<?php
// Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ¹ Ñ„Ğ¾Ñ€Ğ¼Ñƒ Ğ¾Ñ„Ğ¾Ñ€Ğ¼Ğ»ĞµĞ½Ğ¸Ñ Ğ·Ğ°ĞºĞ°Ğ·Ğ°:
// - ĞšĞ¾Ğ½Ñ‚Ğ°ĞºÑ‚Ğ½Ñ‹Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ (Ğ¸Ğ¼Ñ, Ñ‚ĞµĞ»ĞµÑ„Ğ¾Ğ½, email)
// - ĞĞ´Ñ€ĞµÑ Ğ´Ğ¾ÑÑ‚Ğ°Ğ²ĞºĞ¸ (Ğ³Ğ¾Ñ€Ğ¾Ğ´ Ğ¸Ğ· ÑĞ¿Ğ¸ÑĞºĞ°, ÑƒĞ»Ğ¸Ñ†Ğ°, Ğ´Ğ¾Ğ¼, ĞºĞ²Ğ°Ñ€Ñ‚Ğ¸Ñ€Ğ°, Ğ¸Ğ½Ğ´ĞµĞºÑ)
// - Ğ¡Ğ¿Ğ¾ÑĞ¾Ğ± Ğ´Ğ¾ÑÑ‚Ğ°Ğ²ĞºĞ¸ (radio: ĞºÑƒÑ€ÑŒĞµÑ€, ÑĞ°Ğ¼Ğ¾Ğ²Ñ‹Ğ²Ğ¾Ğ·, Ğ¿Ğ¾Ñ‡Ñ‚Ğ°)
// - Ğ¡Ğ¿Ğ¾ÑĞ¾Ğ± Ğ¾Ğ¿Ğ»Ğ°Ñ‚Ñ‹ (radio: ĞºĞ°Ñ€Ñ‚Ğ¾Ğ¹, Ğ½Ğ°Ğ»Ğ¸Ñ‡Ğ½Ñ‹Ğ¼Ğ¸, Ğ¿Ñ€Ğ¸ Ğ¿Ğ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğ¸)
// - ĞšĞ¾Ğ¼Ğ¼ĞµĞ½Ñ‚Ğ°Ñ€Ğ¸Ğ¹ (Ğ½ĞµĞ¾Ğ±ÑĞ·Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ğ¾)
// - Ğ¡Ğ¾Ğ³Ğ»Ğ°ÑĞ¸Ğµ Ñ ÑƒÑĞ»Ğ¾Ğ²Ğ¸ÑĞ¼Ğ¸ (checkbox, Ğ¾Ğ±ÑĞ·Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ğ¾)

// Ğ¢Ñ€ĞµĞ±Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ:
// - CSRF Ğ·Ğ°Ñ‰Ğ¸Ñ‚Ğ°
// - ĞŸĞ¾Ğ»Ğ½Ğ°Ñ Ğ²Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ñ Ğ²ÑĞµÑ… Ğ¿Ğ¾Ğ»ĞµĞ¹
// - Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ğµ Ğ²Ğ²ĞµĞ´Ñ‘Ğ½Ğ½Ñ‹Ñ… Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… Ğ¿Ñ€Ğ¸ Ğ¾ÑˆĞ¸Ğ±ĞºĞµ
// - Ğ—Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ°Ñ Ğ²Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ñ (Ğ¸Ğ½Ğ´ĞµĞºÑ Ğ¾Ğ±ÑĞ·Ğ°Ñ‚ĞµĞ»ĞµĞ½ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ğ´Ğ»Ñ Ğ¿Ğ¾Ñ‡Ñ‚Ñ‹)
// - PRG Ğ¿Ğ°Ñ‚Ñ‚ĞµÑ€Ğ½ Ğ¿Ğ¾ÑĞ»Ğµ ÑƒÑĞ¿ĞµÑˆĞ½Ğ¾Ğ¹ Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²ĞºĞ¸
```

---

## 11. Ğ’Ğ¾Ğ¿Ñ€Ğ¾ÑÑ‹ Ğ´Ğ»Ñ ÑĞ°Ğ¼Ğ¾Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ¸

1. **Ğ§ĞµĞ¼ Ğ¾Ñ‚Ğ»Ğ¸Ñ‡Ğ°ĞµÑ‚ÑÑ Ñ„Ğ¸Ğ»ÑŒÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ Ğ¾Ñ‚ Ğ²Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ğ¸?**

2. **ĞŸĞ¾Ñ‡ĞµĞ¼Ñƒ Ğ½ĞµĞ»ÑŒĞ·Ñ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ÑŒ `addslashes()` Ğ´Ğ»Ñ Ğ·Ğ°Ñ‰Ğ¸Ñ‚Ñ‹ Ğ¾Ñ‚ SQL-Ğ¸Ğ½ÑŠĞµĞºÑ†Ğ¸Ğ¹?**

3. **Ğ’ ĞºĞ°ĞºĞ¾Ğ¹ Ğ¼Ğ¾Ğ¼ĞµĞ½Ñ‚ Ğ½ÑƒĞ¶Ğ½Ğ¾ ÑĞºÑ€Ğ°Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ â€” Ğ¿Ñ€Ğ¸ Ğ¿Ğ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğ¸ Ğ¸Ğ»Ğ¸ Ğ¿Ñ€Ğ¸ Ğ²Ñ‹Ğ²Ğ¾Ğ´Ğµ?**

4. **Ğ§Ñ‚Ğ¾ Ñ‚Ğ°ĞºĞ¾Ğµ CSRF Ğ¸ ĞºĞ°Ğº Ğ¾Ñ‚ Ğ½ĞµĞ³Ğ¾ Ğ·Ğ°Ñ‰Ğ¸Ñ‚Ğ¸Ñ‚ÑŒÑÑ?**

5. **Ğ—Ğ°Ñ‡ĞµĞ¼ Ğ½ÑƒĞ¶ĞµĞ½ honeypot Ğ¸ ĞºĞ°Ğº Ğ¾Ğ½ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚?**

6. **ĞŸĞ¾Ñ‡ĞµĞ¼Ñƒ Ğ½ĞµĞ»ÑŒĞ·Ñ Ğ´Ğ¾Ğ²ĞµÑ€ÑÑ‚ÑŒ `$_FILES['type']`?**

7. **Ğ§Ñ‚Ğ¾ Ğ´ĞµĞ»Ğ°ĞµÑ‚ Ñ„Ğ»Ğ°Ğ³ `FILTER_NULL_ON_FAILURE`?**

8. **ĞšĞ°Ğº Ğ²Ğ°Ğ»Ğ¸Ğ´Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ¼Ğ°ÑÑĞ¸Ğ² Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğ¹ (multiple select, checkbox group)?**

---

## 12. Ğ§Ğ°ÑÑ‚Ñ‹Ğµ Ğ¾ÑˆĞ¸Ğ±ĞºĞ¸

### ĞÑˆĞ¸Ğ±ĞºĞ° 1: Ğ’Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ñ Ğ±ĞµĞ· Ñ„Ğ¸Ğ»ÑŒÑ‚Ñ€Ğ°Ñ†Ğ¸Ğ¸

```php
<?php
// âŒ Ğ’Ğ°Ğ»Ğ¸Ğ´Ğ¸Ñ€ÑƒĞµĞ¼ "Ğ³Ñ€ÑĞ·Ğ½Ñ‹Ğµ" Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ
if (strlen($_POST['name']) > 100) {
    $errors[] = 'Ğ˜Ğ¼Ñ ÑĞ»Ğ¸ÑˆĞºĞ¾Ğ¼ Ğ´Ğ»Ğ¸Ğ½Ğ½Ğ¾Ğµ';
}

// âœ… Ğ¡Ğ½Ğ°Ñ‡Ğ°Ğ»Ğ° Ñ„Ğ¸Ğ»ÑŒÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ, Ğ¿Ğ¾Ñ‚Ğ¾Ğ¼ Ğ²Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ñ
$name = trim($_POST['name'] ?? '');
if (mb_strlen($name) > 100) {
    $errors[] = 'Ğ˜Ğ¼Ñ ÑĞ»Ğ¸ÑˆĞºĞ¾Ğ¼ Ğ´Ğ»Ğ¸Ğ½Ğ½Ğ¾Ğµ';
}
```

### ĞÑˆĞ¸Ğ±ĞºĞ° 2: Ğ­ĞºÑ€Ğ°Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ¿Ñ€Ğ¸ Ğ¿Ğ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğ¸

```php
<?php
// âŒ Ğ­ĞºÑ€Ğ°Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ¿Ñ€Ğ¸ Ğ¿Ğ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğ¸ â€” Ğ¿Ğ»Ğ¾Ñ…Ğ¾!
$name = htmlspecialchars($_POST['name']);
// Ğ¢ĞµĞ¿ĞµÑ€ÑŒ Ğ² Ğ‘Ğ” Ğ±ÑƒĞ´ĞµÑ‚ "Ğ˜Ğ²Ğ°Ğ½ &amp; ĞœĞ°Ñ€Ğ¸Ñ" Ğ²Ğ¼ĞµÑÑ‚Ğ¾ "Ğ˜Ğ²Ğ°Ğ½ & ĞœĞ°Ñ€Ğ¸Ñ"

// âœ… Ğ­ĞºÑ€Ğ°Ğ½Ğ¸Ñ€ÑƒĞ¹ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ğ¿Ñ€Ğ¸ Ğ²Ñ‹Ğ²Ğ¾Ğ´Ğµ
$name = trim($_POST['name']);
// Ğ’ Ğ‘Ğ”: "Ğ˜Ğ²Ğ°Ğ½ & ĞœĞ°Ñ€Ğ¸Ñ"
// ĞŸÑ€Ğ¸ Ğ²Ñ‹Ğ²Ğ¾Ğ´Ğµ: <?= htmlspecialchars($name) ?>
```

### ĞÑˆĞ¸Ğ±ĞºĞ° 3: ĞÑ‚ÑÑƒÑ‚ÑÑ‚Ğ²Ğ¸Ğµ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ¸ Ñ‚Ğ¸Ğ¿Ğ°

```php
<?php
// âŒ ĞĞ¶Ğ¸Ğ´Ğ°ĞµĞ¼ ÑÑ‚Ñ€Ğ¾ĞºÑƒ, Ğ½Ğ¾ Ğ¼Ğ¾Ğ¶ĞµÑ‚ Ğ¿Ñ€Ğ¸Ğ¹Ñ‚Ğ¸ Ğ¼Ğ°ÑÑĞ¸Ğ²!
$search = $_GET['q'];  // ?q[]=test â†’ Ğ¼Ğ°ÑÑĞ¸Ğ²!
echo "ĞŸĞ¾Ğ¸ÑĞº: " . htmlspecialchars($search);  // Notice: Array to string

// âœ… ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑĞµĞ¼ Ñ‚Ğ¸Ğ¿
$search = $_GET['q'] ?? '';
if (!is_string($search)) {
    $search = '';
}
$search = trim($search);
```

### ĞÑˆĞ¸Ğ±ĞºĞ° 4: Ğ”Ğ¾Ğ²ĞµÑ€Ğ¸Ğµ ĞºĞ»Ğ¸ĞµĞ½Ñ‚ÑĞºĞ¾Ğ¹ Ğ²Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ğ¸

```php
<?php
// âŒ ĞŸĞ¾Ğ»Ğ°Ğ³Ğ°Ñ‚ÑŒÑÑ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ğ½Ğ° HTML5 Ğ²Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ñ
// <input type="email" required> â€” Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ Ğ¾Ğ±Ğ¾Ğ¹Ñ‚Ğ¸!

// âœ… Ğ’ÑĞµĞ³Ğ´Ğ° Ğ²Ğ°Ğ»Ğ¸Ğ´Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ½Ğ° ÑĞµÑ€Ğ²ĞµÑ€Ğµ
$email = filter_var($_POST['email'], FILTER_VALIDATE_EMAIL);
if ($email === false) {
    $errors['email'] = 'ĞĞµĞºĞ¾Ñ€Ñ€ĞµĞºÑ‚Ğ½Ñ‹Ğ¹ email';
}
```

### ĞÑˆĞ¸Ğ±ĞºĞ° 5: ĞĞµÑ‚ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ¸ Ğ½Ğ° Ğ¿ÑƒÑÑ‚Ğ¾Ñ‚Ñƒ Ğ¿ĞµÑ€ĞµĞ´ Ğ²Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸ĞµĞ¹

```php
<?php
// âŒ filter_var Ğ²ĞµÑ€Ğ½Ñ‘Ñ‚ false Ğ´Ğ»Ñ Ğ¿ÑƒÑÑ‚Ğ¾Ğ¹ ÑÑ‚Ñ€Ğ¾ĞºĞ¸
$email = filter_var($_POST['email'], FILTER_VALIDATE_EMAIL);
if ($email === false) {
    $errors[] = 'ĞĞµĞºĞ¾Ñ€Ñ€ĞµĞºÑ‚Ğ½Ñ‹Ğ¹ email';  // Ğ¡Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚ Ğ´Ğ°Ğ¶Ğµ ĞµÑĞ»Ğ¸ Ğ¿Ğ¾Ğ»Ğµ Ğ¿ÑƒÑÑ‚Ğ¾Ğµ
}

// âœ… Ğ¡Ğ½Ğ°Ñ‡Ğ°Ğ»Ğ° Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ÑĞµĞ¼ Ğ¾Ğ±ÑĞ·Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ
$email = trim($_POST['email'] ?? '');
if ($email === '') {
    $errors[] = 'Email Ğ¾Ğ±ÑĞ·Ğ°Ñ‚ĞµĞ»ĞµĞ½';
} elseif (filter_var($email, FILTER_VALIDATE_EMAIL) === false) {
    $errors[] = 'ĞĞµĞºĞ¾Ñ€Ñ€ĞµĞºÑ‚Ğ½Ñ‹Ğ¹ email';
}
```

---

## Ğ ĞµĞ·ÑĞ¼Ğµ Ğ³Ğ»Ğ°Ğ²Ñ‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Ğ—ĞĞŸĞĞœĞĞ˜ Ğ“Ğ›ĞĞ’ĞĞĞ•                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                â”‚
â”‚  Ğ¢Ğ Ğ˜ Ğ­Ğ¢ĞĞŸĞ ĞĞ‘Ğ ĞĞ‘ĞĞ¢ĞšĞ˜                                           â”‚
â”‚  1. Ğ¤Ğ¸Ğ»ÑŒÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ â€” Ğ¿Ñ€Ğ¸Ğ²ĞµÑÑ‚Ğ¸ Ğº Ğ½ÑƒĞ¶Ğ½Ğ¾Ğ¼Ñƒ Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚Ñƒ                   â”‚
â”‚  2. Ğ’Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ñ â€” Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ Ğ½Ğ° ÑĞ¾Ğ¾Ñ‚Ğ²ĞµÑ‚ÑÑ‚Ğ²Ğ¸Ğµ Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»Ğ°Ğ¼            â”‚
â”‚  3. Ğ¡Ğ°Ğ½Ğ¸Ñ‚Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ â€” Ğ¿Ğ¾Ğ´Ğ³Ğ¾Ñ‚Ğ¾Ğ²Ğ¸Ñ‚ÑŒ Ğ´Ğ»Ñ Ğ±ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾Ğ³Ğ¾ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ   â”‚
â”‚                                                                â”‚
â”‚  Ğ¤Ğ˜Ğ›Ğ¬Ğ¢Ğ ĞĞ¦Ğ˜Ğ¯                                                    â”‚
â”‚  â€¢ trim() â€” ÑƒĞ±Ñ€Ğ°Ñ‚ÑŒ Ğ¿Ñ€Ğ¾Ğ±ĞµĞ»Ñ‹                                    â”‚
â”‚  â€¢ (int), (float) â€” Ğ¿Ñ€Ğ¸Ğ²ĞµĞ´ĞµĞ½Ğ¸Ğµ Ñ‚Ğ¸Ğ¿Ğ¾Ğ²                          â”‚
â”‚  â€¢ filter_var($val, FILTER_SANITIZE_*)                        â”‚
â”‚  â€¢ preg_replace() â€” ÑƒĞ´Ğ°Ğ»ĞµĞ½Ğ¸Ğµ Ğ»Ğ¸ÑˆĞ½Ğ¸Ñ… ÑĞ¸Ğ¼Ğ²Ğ¾Ğ»Ğ¾Ğ²                  â”‚
â”‚                                                                â”‚
â”‚  Ğ’ĞĞ›Ğ˜Ğ”ĞĞ¦Ğ˜Ğ¯                                                     â”‚
â”‚  â€¢ filter_var($val, FILTER_VALIDATE_*)                        â”‚
â”‚  â€¢ Ğ ĞµĞ³ÑƒĞ»ÑÑ€Ğ½Ñ‹Ğµ Ğ²Ñ‹Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ñ Ğ´Ğ»Ñ ÑĞ»Ğ¾Ğ¶Ğ½Ñ‹Ñ… Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚Ğ¾Ğ²                  â”‚
â”‚  â€¢ ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ´Ğ¸Ğ°Ğ¿Ğ°Ğ·Ğ¾Ğ½Ğ¾Ğ², Ğ´Ğ»Ğ¸Ğ½Ñ‹, Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚Ğ°                        â”‚
â”‚  â€¢ ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° ÑƒĞ½Ğ¸ĞºĞ°Ğ»ÑŒĞ½Ğ¾ÑÑ‚Ğ¸ Ğ² Ğ‘Ğ”                                 â”‚
â”‚                                                                â”‚
â”‚  Ğ¡ĞĞĞ˜Ğ¢Ğ˜Ğ—ĞĞ¦Ğ˜Ğ¯                                                   â”‚
â”‚  â€¢ htmlspecialchars() â€” Ğ´Ğ»Ñ HTML Ğ²Ñ‹Ğ²Ğ¾Ğ´Ğ°                       â”‚
â”‚  â€¢ urlencode() â€” Ğ´Ğ»Ñ URL Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ğ¾Ğ²                           â”‚
â”‚  â€¢ json_encode() â€” Ğ´Ğ»Ñ JavaScript                             â”‚
â”‚  â€¢ Prepared statements â€” Ğ´Ğ»Ñ SQL                              â”‚
â”‚                                                                â”‚
â”‚  Ğ‘Ğ•Ğ—ĞĞŸĞĞ¡ĞĞĞ¡Ğ¢Ğ¬                                                  â”‚
â”‚  â€¢ CSRF Ñ‚Ğ¾ĞºĞµĞ½Ñ‹ Ğ² ĞºĞ°Ğ¶Ğ´Ğ¾Ğ¹ Ñ„Ğ¾Ñ€Ğ¼Ğµ                                 â”‚
â”‚  â€¢ Honeypot Ğ¿Ñ€Ğ¾Ñ‚Ğ¸Ğ² Ğ±Ğ¾Ñ‚Ğ¾Ğ²                                      â”‚
â”‚  â€¢ Rate limiting Ğ¿Ñ€Ğ¾Ñ‚Ğ¸Ğ² Ğ¿ĞµÑ€ĞµĞ±Ğ¾Ñ€Ğ°                              â”‚
â”‚  â€¢ Ğ­ĞºÑ€Ğ°Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ¿Ñ€Ğ¸ Ğ’Ğ«Ğ’ĞĞ”Ğ•, Ğ½Ğµ Ğ¿Ñ€Ğ¸ Ğ¿Ğ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğ¸                 â”‚
â”‚                                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

**Ğ¡Ğ»ĞµĞ´ÑƒÑÑ‰Ğ°Ñ Ğ³Ğ»Ğ°Ğ²Ğ°:** `Ğ“Ğ»Ğ°Ğ²Ğ° 2.3: Ğ‘Ğ°Ğ·Ñ‹ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… Ğ¸ PDO â€” Ğ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ, Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑÑ‹, prepared statements, Ñ‚Ñ€Ğ°Ğ½Ğ·Ğ°ĞºÑ†Ğ¸Ğ¸`
