# –ì–ª–∞–≤–∞ 8.1: Wireshark: –∑–∞—Ö–≤–∞—Ç, —Ñ–∏–ª—å—Ç—Ä—ã, Follow Stream

## üéØ –¶–µ–ª–∏ –≥–ª–∞–≤—ã

–ü–æ—Å–ª–µ –∏–∑—É—á–µ–Ω–∏—è —ç—Ç–æ–π –≥–ª–∞–≤—ã –≤—ã —Å–º–æ–∂–µ—Ç–µ:
- –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å –∏ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å Wireshark –Ω–∞ Linux –∏ Windows
- –ó–∞—Ö–≤–∞—Ç—ã–≤–∞—Ç—å —Ç—Ä–∞—Ñ–∏–∫ —Å –Ω—É–∂–Ω–æ–≥–æ —Å–µ—Ç–µ–≤–æ–≥–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
- –ü—Ä–∏–º–µ–Ω—è—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã –∑–∞—Ö–≤–∞—Ç–∞ (BPF) –∏ display filters
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Follow Stream –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —Å–µ—Å—Å–∏–π
- –ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å HTTP, DNS, TLS –∏ ARP —Ç—Ä–∞—Ñ–∏–∫
- –°—Ç—Ä–æ–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –∏ –≥—Ä–∞—Ñ–∏–∫–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∑–∞—Ö–≤–∞—á–µ–Ω–Ω–æ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞
- –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã –∏–∑ PCAP-—Ñ–∞–π–ª–æ–≤
- –†–∞–∑–±–∏—Ä–∞—Ç—å PCAP-—Ñ–∞–π–ª—ã —Å –∞—Ç–∞–∫–∞–º–∏ –≤ —Å—Ç–∏–ª–µ CTF

---

## üì¶ 8.1.1 –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Wireshark

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–∞ Linux (Ubuntu/Debian)

```bash
# –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤
sudo apt update

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Wireshark
sudo apt install wireshark -y

# –í–æ –≤—Ä–µ–º—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ —Å–∏—Å—Ç–µ–º–∞ —Å–ø—Ä–æ—Å–∏—Ç, –º–æ–≥—É—Ç –ª–∏ –Ω–µ-root –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∑–∞—Ö–≤–∞—Ç—ã–≤–∞—Ç—å –ø–∞–∫–µ—Ç—ã.
# –í—ã–±—Ä–∞—Ç—å Yes –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞ —Ä–∞–±–æ—Ç—ã.

# –î–æ–±–∞–≤–∏—Ç—å —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –≥—Ä—É–ø–ø—É wireshark
sudo usermod -aG wireshark $USER

# –ü—Ä–∏–º–µ–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –≥—Ä—É–ø–ø—ã (–∏–ª–∏ –ø–µ—Ä–µ–ª–æ–≥–∏–Ω–∏—Ç—å—Å—è)
newgrp wireshark

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–µ—Ä—Å–∏—é
wireshark --version
```

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–∞ Kali Linux

```bash
# Kali –æ–±—ã—á–Ω–æ –∏–º–µ–µ—Ç Wireshark –ø—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–º
which wireshark

# –ï—Å–ª–∏ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
sudo apt install wireshark tshark -y

# –ó–∞–ø—É—Å–∫ –æ—Ç —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
sudo setcap 'CAP_NET_RAW+eip CAP_NET_ADMIN+eip' /usr/bin/dumpcap
```

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–∞ Windows

1. –ü–µ—Ä–µ–π—Ç–∏ –Ω–∞ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π —Å–∞–π—Ç: https://www.wireshark.org/download.html
2. –°–∫–∞—á–∞—Ç—å Wireshark-win64-x.x.x.exe
3. –ó–∞–ø—É—Å—Ç–∏—Ç—å —É—Å—Ç–∞–Ω–æ–≤—â–∏–∫ ‚Äî –æ–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç **Npcap** (–¥—Ä–∞–π–≤–µ—Ä –∑–∞—Ö–≤–∞—Ç–∞ –ø–∞–∫–µ—Ç–æ–≤)
4. –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –ø—Ä–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–µ –æ—Ç–º–µ—á–µ–Ω—ã –≥–∞–ª–æ—á–∫–∏:
   - Install Npcap
   - Install USBPcap (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

```powershell
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–µ—Ä—Å–∏–∏ —á–µ—Ä–µ–∑ PowerShell
& "C:\Program Files\Wireshark\Wireshark.exe" --version

# –ò–ª–∏ —á–µ—Ä–µ–∑ winget
winget install WiresharkFoundation.Wireshark
```

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ tshark (CLI-–≤–µ—Ä—Å–∏—è Wireshark)

```bash
# Linux
sudo apt install tshark -y

# –ü—Ä–æ–≤–µ—Ä–∫–∞
tshark --version

# macOS (—á–µ—Ä–µ–∑ Homebrew)
brew install wireshark
```

> **Note:** tshark ‚Äî —ç—Ç–æ –∫–æ–º–∞–Ω–¥–Ω–∞—è —Å—Ç—Ä–æ—á–Ω–∞—è –≤–µ—Ä—Å–∏—è Wireshark, –∏—Å–ø–æ–ª—å–∑—É—é—â–∞—è —Ç–µ –∂–µ –¥–∏—Å—Å–µ–∫—Ç–æ—Ä—ã –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–≤. –ù–µ–∑–∞–º–µ–Ω–∏–º –¥–ª—è —Ä–∞–±–æ—Ç—ã –Ω–∞ —Å–µ—Ä–≤–µ—Ä–∞—Ö –±–µ–∑ GUI –∏ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –∞–Ω–∞–ª–∏–∑–∞.

---

## üñ•Ô∏è 8.1.2 –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å Wireshark

### –û—Å–Ω–æ–≤–Ω—ã–µ –ø–∞–Ω–µ–ª–∏

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  –ú–µ–Ω—é: File | Edit | View | Go | Capture | Analyze | ...    ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  Toolbar: –ö–Ω–æ–ø–∫–∏ –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞                           ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  Display Filter Bar: [  –≤–≤–µ–¥–∏—Ç–µ —Ñ–∏–ª—å—Ç—Ä –∑–¥–µ—Å—å   ] [Apply]   ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                                                             ‚îÇ
‚îÇ  –°–ü–ò–°–û–ö –ü–ê–ö–ï–¢–û–í (Packet List)                               ‚îÇ
‚îÇ  No. ‚îÇ Time ‚îÇ Source ‚îÇ Destination ‚îÇ Protocol ‚îÇ Length ‚îÇ Info‚îÇ
‚îÇ  1   ‚îÇ 0.00 ‚îÇ 192.168.1.1 ‚îÇ 8.8.8.8 ‚îÇ DNS ‚îÇ 74 ‚îÇ ...   ‚îÇ
‚îÇ                                                             ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                                                             ‚îÇ
‚îÇ  –î–ï–¢–ê–õ–ò –ü–ê–ö–ï–¢–ê (Packet Details)                             ‚îÇ
‚îÇ  ‚ñº Frame 1: 74 bytes on wire                                ‚îÇ
‚îÇ  ‚ñº Ethernet II, Src: ..., Dst: ...                          ‚îÇ
‚îÇ  ‚ñº Internet Protocol Version 4                              ‚îÇ
‚îÇ  ‚ñº User Datagram Protocol                                   ‚îÇ
‚îÇ  ‚ñº Domain Name System (query)                               ‚îÇ
‚îÇ                                                             ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                                                             ‚îÇ
‚îÇ  –ë–ê–ô–¢–´ –ü–ê–ö–ï–¢–ê (Packet Bytes) ‚Äî HEX + ASCII                  ‚îÇ
‚îÇ  0000  45 00 00 4a 12 34 40 00  40 11 xx xx c0 a8 01 01  ‚îÇ
‚îÇ                                                             ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
‚îÇ  –°—Ç–∞—Ç—É—Å–Ω–∞—è —Å—Ç—Ä–æ–∫–∞: Packets: 1234 | Displayed: 56 | Dropped: 0‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–æ–ª–æ–Ω–æ–∫

–î–ª—è SOC-–∞–Ω–∞–ª–∏—Ç–∏–∫–∞ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–æ–±–∞–≤–∏—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ –∫–æ–ª–æ–Ω–∫–∏:

| –ö–æ–ª–æ–Ω–∫–∞ | –ü–æ–ª–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|------|----------|
| No. | frame.number | –ù–æ–º–µ—Ä –ø–∞–∫–µ—Ç–∞ |
| Time | frame.time_relative | –û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ–µ –≤—Ä–µ–º—è |
| Source | ip.src | IP –∏—Å—Ç–æ—á–Ω–∏–∫–∞ |
| Destination | ip.dst | IP –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è |
| Src Port | tcp.srcport / udp.srcport | –ü–æ—Ä—Ç –∏—Å—Ç–æ—á–Ω–∏–∫–∞ |
| Dst Port | tcp.dstport / udp.dstport | –ü–æ—Ä—Ç –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è |
| Protocol | frame.protocols | –ü—Ä–æ—Ç–æ–∫–æ–ª |
| Length | frame.len | –î–ª–∏–Ω–∞ –ø–∞–∫–µ—Ç–∞ |
| Info | _ws.col.info | –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è |

–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–æ–ª–æ–Ω–∫–∏:
1. Edit ‚Üí Preferences ‚Üí Appearance ‚Üí Columns
2. –ù–∞–∂–∞—Ç—å "+" –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤–æ–π –∫–æ–ª–æ–Ω–∫–∏
3. –í—ã–±—Ä–∞—Ç—å —Ç–∏–ø –ø–æ–ª—è –∏–ª–∏ –≤–≤–µ—Å—Ç–∏ –≤—Ä—É—á–Ω—É—é

### –¶–≤–µ—Ç–æ–≤–∞—è –º–∞—Ä–∫–∏—Ä–æ–≤–∫–∞ –ø–∞–∫–µ—Ç–æ–≤

```
–ö—Ä–∞—Å–Ω—ã–π —Ñ–æ–Ω    ‚Äî TCP RST, –æ—à–∏–±–∫–∏
–¢—ë–º–Ω–æ-–∫—Ä–∞—Å–Ω—ã–π  ‚Äî HTTP (–∫–ª–∏–µ–Ω—Ç ‚Üí —Å–µ—Ä–≤–µ—Ä)
–°–∏–Ω–∏–π          ‚Äî DNS
–ó–µ–ª—ë–Ω—ã–π        ‚Äî HTTP —É—Å–ø–µ—à–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã
–ß—ë—Ä–Ω—ã–π         ‚Äî TCP-–æ—à–∏–±–∫–∏ (–ø–ª–æ—Ö–∞—è –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω–∞—è —Å—É–º–º–∞ –∏ —Ç.–¥.)
```

–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–∞–≤–∏–ª —Ü–≤–µ—Ç–æ–≤–æ–π –º–∞—Ä–∫–∏—Ä–æ–≤–∫–∏: View ‚Üí Coloring Rules

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –º–µ—Ç–æ–∫

```
View ‚Üí Time Display Format:
- Date and Time of Day       ‚Äî –∞–±—Å–æ–ª—é—Ç–Ω–æ–µ –≤—Ä–µ–º—è
- Seconds Since First Packet ‚Äî –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ–µ –≤—Ä–µ–º—è (—É–¥–æ–±–Ω–æ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞)
- Seconds Since Previous Packet ‚Äî –¥–µ–ª—å—Ç–∞ –º–µ–∂–¥—É –ø–∞–∫–µ—Ç–∞–º–∏
```

---

## üîç 8.1.3 –ó–∞—Ö–≤–∞—Ç —Ç—Ä–∞—Ñ–∏–∫–∞

### –í—ã–±–æ—Ä –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞

```
Capture ‚Üí Options (–∏–ª–∏ Ctrl+K)
```

–°–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤ —Å –≥—Ä–∞—Ñ–∏–∫–æ–º –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏. –í—ã–±—Ä–∞—Ç—å –Ω—É–∂–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å (eth0, wlan0, lo –∏ —Ç.–¥.).

```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤ —á–µ—Ä–µ–∑ tshark
tshark -D

# –ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞:
# 1. eth0
# 2. wlan0
# 3. lo (Loopback)
# 4. any (Pseudo-device that captures on all interfaces)
```

### –§–∏–ª—å—Ç—Ä—ã –∑–∞—Ö–≤–∞—Ç–∞ (BPF ‚Äî Berkeley Packet Filter)

–§–∏–ª—å—Ç—Ä—ã –∑–∞—Ö–≤–∞—Ç–∞ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è **–¥–æ** —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –ø–∞–∫–µ—Ç–æ–≤. –û–Ω–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –±—ã—Å—Ç—Ä–µ–µ display filters, –Ω–æ –∏–º–µ—é—Ç –±–æ–ª–µ–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å.

**–°–∏–Ω—Ç–∞–∫—Å–∏—Å BPF:**

```
[not] primitive [and|or [not] primitive ...]
```

**–û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–∏–º–∏—Ç–∏–≤—ã:**

| –ü—Ä–∏–º–∏—Ç–∏–≤ | –ü—Ä–∏–º–µ—Ä | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|--------|----------|
| host | `host 192.168.1.1` | –¢—Ä–∞—Ñ–∏–∫ –æ—Ç/–¥–æ —Ö–æ—Å—Ç–∞ |
| net | `net 192.168.1.0/24` | –¢—Ä–∞—Ñ–∏–∫ –æ—Ç/–¥–æ —Å–µ—Ç–∏ |
| port | `port 80` | –¢—Ä–∞—Ñ–∏–∫ –Ω–∞/—Å –ø–æ—Ä—Ç–∞ |
| portrange | `portrange 1-1024` | –î–∏–∞–ø–∞–∑–æ–Ω –ø–æ—Ä—Ç–æ–≤ |
| proto | `proto tcp` | –ü–æ –ø—Ä–æ—Ç–æ–∫–æ–ª—É |
| tcp | `tcp` | –¢–æ–ª—å–∫–æ TCP |
| udp | `udp` | –¢–æ–ª—å–∫–æ UDP |
| icmp | `icmp` | –¢–æ–ª—å–∫–æ ICMP |
| src | `src host 10.0.0.1` | –¢–æ–ª—å–∫–æ –æ—Ç –∏—Å—Ç–æ—á–Ω–∏–∫–∞ |
| dst | `dst port 443` | –¢–æ–ª—å–∫–æ –∫ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—é |
| ether | `ether host aa:bb:cc:dd:ee:ff` | –ü–æ MAC-–∞–¥—Ä–µ—Å—É |

**–ü—Ä–∏–º–µ—Ä—ã BPF-—Ñ–∏–ª—å—Ç—Ä–æ–≤:**

```bash
# –¢–æ–ª—å–∫–æ HTTP –∏ HTTPS —Ç—Ä–∞—Ñ–∏–∫
tcp port 80 or tcp port 443

# –¢—Ä–∞—Ñ–∏–∫ –æ—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Ö–æ—Å—Ç–∞ –Ω–∞ –≤–µ–±-–ø–æ—Ä—Ç—ã
src host 192.168.1.100 and (dst port 80 or dst port 443)

# –ò—Å–∫–ª—é—á–∏—Ç—å SSH-—Ç—Ä–∞—Ñ–∏–∫
not port 22

# –¢–æ–ª—å–∫–æ DNS-–∑–∞–ø—Ä–æ—Å—ã
udp port 53

# ICMP (ping)
icmp

# –í—Å–µ —Ç—Ä–∞—Ñ–∏–∫ –¥–ª—è –ø–æ–¥—Å–µ—Ç–∏, –∫—Ä–æ–º–µ broadcast
net 192.168.1.0/24 and not broadcast

# –ó–∞—Ö–≤–∞—Ç –±–æ–ª—å—à–∏—Ö –ø–∞–∫–µ—Ç–æ–≤ (–≤–æ–∑–º–æ–∂–Ω–∞—è —ç–∫—Å—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è?)
greater 1400

# –¢–æ–ª—å–∫–æ SYN-–ø–∞–∫–µ—Ç—ã (–Ω–∞—á–∞–ª–æ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π)
tcp[tcpflags] & tcp-syn != 0

# TCP-–ø–∞–∫–µ—Ç—ã —Å —Ñ–ª–∞–≥–æ–º RST
tcp[tcpflags] & tcp-rst != 0
```

---

## üîé 8.1.4 Display Filters

Display Filters –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è **–ø–æ—Å–ª–µ** –∑–∞—Ö–≤–∞—Ç–∞, –∫ —É–∂–µ –∏–º–µ—é—â–∏–º—Å—è –ø–∞–∫–µ—Ç–∞–º. –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç –±–æ–≥–∞—Ç—ã–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å —Å –æ–±—Ä–∞—â–µ–Ω–∏–µ–º –∫ –ª—é–±–æ–º—É –ø–æ–ª—é –ø—Ä–æ—Ç–æ–∫–æ–ª–∞.

### –°–∏–Ω—Ç–∞–∫—Å–∏—Å

```
–ø–æ–ª–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä –∑–Ω–∞—á–µ–Ω–∏–µ
```

**–û–ø–µ—Ä–∞—Ç–æ—Ä—ã —Å—Ä–∞–≤–Ω–µ–Ω–∏—è:**

| –û–ø–µ—Ä–∞—Ç–æ—Ä | –°–∏–º–≤–æ–ª | –ü—Ä–∏–º–µ—Ä |
|----------|--------|--------|
| equal | == –∏–ª–∏ eq | `ip.addr == 10.0.0.1` |
| not equal | != –∏–ª–∏ ne | `tcp.port != 80` |
| greater than | > –∏–ª–∏ gt | `frame.len > 1000` |
| less than | < –∏–ª–∏ lt | `frame.len < 100` |
| greater or equal | >= –∏–ª–∏ ge | `ip.ttl >= 64` |
| less or equal | <= –∏–ª–∏ le | `tcp.window_size <= 1024` |
| contains | contains | `http.host contains "google"` |
| matches (regex) | matches –∏–ª–∏ ~ | `http.uri matches "\.php\?"` |
| bitwise AND | & | `tcp.flags & 0x02` |

**–õ–æ–≥–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã:**

| –û–ø–µ—Ä–∞—Ç–æ—Ä | –°–∏–º–≤–æ–ª | –ü—Ä–∏–º–µ—Ä |
|----------|--------|--------|
| AND | && –∏–ª–∏ and | `ip.src == 10.0.0.1 && tcp.port == 80` |
| OR | \|\| –∏–ª–∏ or | `tcp.port == 80 \|\| tcp.port == 443` |
| NOT | ! –∏–ª–∏ not | `!arp` |

### –ü–æ–ª–µ–∑–Ω—ã–µ Display Filters

```wireshark
# === IP-–∞–¥—Ä–µ—Å–∞ ===
ip.addr == 192.168.1.1          # –õ—é–±–æ–π —Ç—Ä–∞—Ñ–∏–∫ —Å/–Ω–∞ IP
ip.src == 192.168.1.1           # –¢–æ–ª—å–∫–æ –æ—Ç –∏—Å—Ç–æ—á–Ω–∏–∫–∞
ip.dst == 192.168.1.1           # –¢–æ–ª—å–∫–æ –∫ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—é
ip.addr == 192.168.1.0/24       # –í—Å—è –ø–æ–¥—Å–µ—Ç—å

# === TCP/UDP ===
tcp.port == 80                  # TCP –ø–æ—Ä—Ç 80
tcp.dstport == 443              # –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ HTTPS
tcp.flags.syn == 1              # SYN-—Ñ–ª–∞–≥ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
tcp.flags.rst == 1              # RST-—Ñ–ª–∞–≥
tcp.flags == 0x002              # –¢–æ–ª—å–∫–æ SYN
tcp.flags == 0x012              # SYN+ACK
tcp.analysis.retransmission     # –†–µ—Ç—Ä–∞–Ω—Å–º–∏—Å—Å–∏–∏ TCP
tcp.analysis.zero_window        # Zero Window

# === HTTP ===
http                            # –í–µ—Å—å HTTP-—Ç—Ä–∞—Ñ–∏–∫
http.request                    # –¢–æ–ª—å–∫–æ –∑–∞–ø—Ä–æ—Å—ã
http.response                   # –¢–æ–ª—å–∫–æ –æ—Ç–≤–µ—Ç—ã
http.request.method == "POST"   # POST-–∑–∞–ø—Ä–æ—Å—ã
http.response.code == 200       # –£—Å–ø–µ—à–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã
http.response.code >= 400       # –û—à–∏–±–∫–∏
http.host contains "evil.com"   # –ü–æ –¥–æ–º–µ–Ω—É
http.uri contains "admin"       # –ü–æ URI
http.cookie contains "session"  # –ü–æ–∏—Å–∫ cookies
http.user_agent contains "curl" # –ü–æ User-Agent
http.content_type contains "xml"# –ü–æ Content-Type

# === DNS ===
dns                             # –í–µ—Å—å DNS
dns.flags.response == 0         # –¢–æ–ª—å–∫–æ –∑–∞–ø—Ä–æ—Å—ã
dns.flags.response == 1         # –¢–æ–ª—å–∫–æ –æ—Ç–≤–µ—Ç—ã
dns.qry.name contains "evil"    # –ü–æ –∏–º–µ–Ω–∏ –∑–∞–ø—Ä–æ—Å–∞
dns.resp.ttl < 60               # –ù–∏–∑–∫–∏–π TTL (DNS tunneling?)
dns.qry.type == 16              # TXT-–∑–∞–ø–∏—Å–∏ (DNS tunneling)
dns.resp.len > 200              # –ë–æ–ª—å—à–∏–µ DNS-–æ—Ç–≤–µ—Ç—ã

# === TLS/SSL ===
tls                             # –í–µ—Å—å TLS
tls.handshake.type == 1         # ClientHello
tls.handshake.type == 2         # ServerHello
tls.handshake.extensions_server_name  # SNI
tls.alert                       # TLS-–∞–ª–µ—Ä—Ç—ã

# === ARP ===
arp                             # –í–µ—Å—å ARP
arp.opcode == 1                 # ARP Request
arp.opcode == 2                 # ARP Reply
arp.duplicate-address-detected  # –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ IP (ARP spoofing)

# === ICMP ===
icmp                            # –í–µ—Å—å ICMP
icmp.type == 8                  # Echo Request (ping)
icmp.type == 0                  # Echo Reply
icmp.type == 3                  # Destination Unreachable
```

### –¢–∞–±–ª–∏—Ü–∞ –≤–∞–∂–Ω—ã—Ö Display Filters –¥–ª—è SOC

| –§–∏–ª—å—Ç—Ä | –ß—Ç–æ –∏—â–µ–º | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç |
|--------|----------|-----------|
| `http.request.method == "POST" && http.uri contains "login"` | –ü–æ–ø—ã—Ç–∫–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ | –í—ã—Å–æ–∫–∏–π |
| `tcp.flags == 0x002 && tcp.dstport < 1024` | –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ—Ä—Ç–æ–≤ | –í—ã—Å–æ–∫–∏–π |
| `dns.qry.type == 16` | DNS TXT-–∑–∞–ø–∏—Å–∏ (—Ç—É–Ω–Ω–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ) | –í—ã—Å–æ–∫–∏–π |
| `dns.resp.ttl < 10` | –û—á–µ–Ω—å –Ω–∏–∑–∫–∏–π TTL DNS | –°—Ä–µ–¥–Ω–∏–π |
| `http.user_agent contains "sqlmap"` | –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –∞—Ç–∞–∫–∏ | –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π |
| `http.user_agent contains "nikto"` | –í–µ–±-—Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ | –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π |
| `ftp.request.command == "PASS"` | FTP-–ø–∞—Ä–æ–ª–∏ –≤ –æ—Ç–∫—Ä—ã—Ç–æ–º –≤–∏–¥–µ | –í—ã—Å–æ–∫–∏–π |
| `telnet` | –ù–µ–±–µ–∑–æ–ø–∞—Å–Ω—ã–π –ø—Ä–æ—Ç–æ–∫–æ–ª Telnet | –í—ã—Å–æ–∫–∏–π |
| `smtp` | SMTP-—Ç—Ä–∞—Ñ–∏–∫ (—É—Ç–µ—á–∫–∞ –¥–∞–Ω–Ω—ã—Ö) | –°—Ä–µ–¥–Ω–∏–π |
| `tcp.analysis.retransmission` | –†–µ—Ç—Ä–∞–Ω—Å–º–∏—Å—Å–∏–∏ (–Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å) | –ù–∏–∑–∫–∏–π |
| `ip.ttl < 5` | –ü–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ –º–∞–ª—ã–π TTL | –°—Ä–µ–¥–Ω–∏–π |
| `frame.len > 1400 && icmp` | –ë–æ–ª—å—à–∏–µ ICMP-–ø–∞–∫–µ—Ç—ã (—Ç—É–Ω–Ω–µ–ª—å) | –í—ã—Å–æ–∫–∏–π |
| `http.response.code == 403` | –û—Ç–≤–µ—Ç—ã "Forbidden" | –°—Ä–µ–¥–Ω–∏–π |
| `tcp.flags.reset == 1 && tcp.flags.ack == 1` | RST+ACK | –°—Ä–µ–¥–Ω–∏–π |
| `arp && eth.src[0:3] == 00:0c:29` | VMware MAC-–∞–¥—Ä–µ—Å–∞ | –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–π |
| `(tcp.flags == 0x001) || (tcp.flags == 0x029)` | FIN/FIN+URG —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ | –í—ã—Å–æ–∫–∏–π |
| `dns.qry.name matches "[a-z0-9]{20,}\."` | –î–ª–∏–Ω–Ω—ã–µ —Å—É–±–¥–æ–º–µ–Ω—ã (DGA) | –í—ã—Å–æ–∫–∏–π |
| `http.request.uri matches "(\.\./){2,}"` | Path traversal | –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π |
| `http.request.uri matches "(%27|')" ` | SQL Injection –ø–æ–ø—ã—Ç–∫–∏ | –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π |
| `tls.handshake.type == 1 && !tls.handshake.extensions_server_name` | TLS –±–µ–∑ SNI (–∞–Ω–æ–º–∞–ª–∏—è) | –°—Ä–µ–¥–Ω–∏–π |

---

## üåä 8.1.5 Follow Stream

### Follow TCP Stream

Follow TCP Stream —Å–æ–±–∏—Ä–∞–µ—Ç –≤—Å—é —Å–µ—Å—Å–∏—é TCP –≤ –µ–¥–∏–Ω—ã–π –ø–æ—Ç–æ–∫ –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –≤ —á–µ–ª–æ–≤–µ–∫–æ—á–∏—Ç–∞–µ–º–æ–º –≤–∏–¥–µ.

**–ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
1. –ù–∞–π—Ç–∏ –ø–∞–∫–µ—Ç –Ω—É–∂–Ω–æ–≥–æ TCP-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
2. –ü—Ä–∞–≤–∞—è –∫–Ω–æ–ø–∫–∞ ‚Üí Follow ‚Üí TCP Stream
3. –ò–ª–∏: Analyze ‚Üí Follow ‚Üí TCP Stream

```
–ö—Ä–∞—Å–Ω—ã–π —Ü–≤–µ—Ç  ‚Äî –¥–∞–Ω–Ω—ã–µ –æ—Ç –∫–ª–∏–µ–Ω—Ç–∞ (‚Üí —Å–µ—Ä–≤–µ—Ä—É)
–°–∏–Ω–∏–π —Ü–≤–µ—Ç    ‚Äî –¥–∞–Ω–Ω—ã–µ –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞ (‚Üí –∫–ª–∏–µ–Ω—Ç—É)
```

**–ü—Ä–∏–º–µ—Ä: HTTP-–∑–∞–ø—Ä–æ—Å –≤ Follow TCP Stream:**

```http
GET /admin/login.php HTTP/1.1
Host: target.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64)
Accept: text/html,application/xhtml+xml
Cookie: PHPSESSID=abc123def456; remember_me=1
Connection: keep-alive

HTTP/1.1 200 OK
Content-Type: text/html; charset=UTF-8
Set-Cookie: admin_token=eyJhbGciOiJIUzI1NiJ9...
Content-Length: 4321

<!DOCTYPE html>
<html>
<head><title>Admin Panel</title></head>
...
```

**–ß—Ç–æ –∏—Å–∫–∞—Ç—å –≤ HTTP Stream:**
- –£—á—ë—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ POST-–∑–∞–ø—Ä–æ—Å–∞—Ö
- Cookies –∏ —Ç–æ–∫–µ–Ω—ã –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- –ü–µ—Ä–µ–¥–∞—á–∞ —Ñ–∞–π–ª–æ–≤ (–±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö, –∫–æ–Ω—Ñ–∏–≥–∏)
- –ü—Ä–∏–∑–Ω–∞–∫–∏ SQLi/XSS –≤ URI
- –ü–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏

### Follow UDP Stream

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ UDP-–ø—Ä–æ—Ç–æ–∫–æ–ª–æ–≤ (DNS, DHCP, TFTP –∏ —Ç.–¥.).

```
–ü—Ä–∞–≤–∞—è –∫–Ω–æ–ø–∫–∞ –Ω–∞ DNS-–ø–∞–∫–µ—Ç–µ ‚Üí Follow ‚Üí UDP Stream
```

### Follow HTTP Stream

–°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π —Ä–µ–∂–∏–º –¥–ª—è HTTP, –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤–∏–¥–µ—Ç—å –¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–Ω—ã–π HTTP –±–µ–∑ —Å–ª—É–∂–µ–±–Ω—ã—Ö –±–∞–π—Ç TCP.

```
–ü—Ä–∞–≤–∞—è –∫–Ω–æ–ø–∫–∞ –Ω–∞ HTTP-–ø–∞–∫–µ—Ç–µ ‚Üí Follow ‚Üí HTTP Stream
```

### –û–ø—Ü–∏–∏ —ç–∫—Å–ø–æ—Ä—Ç–∞ –∏–∑ Follow Stream

–í –¥–∏–∞–ª–æ–≥–µ Follow Stream –¥–æ—Å—Ç—É–ø–Ω—ã –≤–∞—Ä–∏–∞–Ω—Ç—ã –≤—ã–≤–æ–¥–∞:

| –§–æ—Ä–º–∞—Ç | –û–ø–∏—Å–∞–Ω–∏–µ |
|--------|----------|
| ASCII | –¢–µ–∫—Å—Ç–æ–≤–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ |
| C Arrays | –ú–∞—Å—Å–∏–≤ –±–∞–π—Ç –¥–ª—è C/C++ |
| EBCDIC | –î–ª—è –º–µ–π–Ω—Ñ—Ä–µ–π–º–æ–≤ |
| HEX Dump | –®–µ—Å—Ç–Ω–∞–¥—Ü–∞—Ç–µ—Ä–∏—á–Ω—ã–π –¥–∞–º–ø |
| Raw | –°—ã—Ä—ã–µ –±–∞–π—Ç—ã |
| UTF-8 | Unicode —Ç–µ–∫—Å—Ç |
| YAML | –î–ª—è —Å–∫—Ä–∏–ø—Ç–∏–Ω–≥–∞ |

---

## üåê 8.1.6 –ê–Ω–∞–ª–∏–∑ HTTP-—Ç—Ä–∞—Ñ–∏–∫–∞

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ HTTP –≤ Wireshark

```
‚ñº Hypertext Transfer Protocol
  ‚ñº GET /api/users HTTP/1.1\r\n
      Request Method: GET
      Request URI: /api/users
      Request Version: HTTP/1.1
  ‚ñº Host: api.example.com\r\n
  ‚ñº Authorization: Bearer eyJhbGci...\r\n
      Credentials: eyJhbGci...
  ‚ñº User-Agent: python-requests/2.28.0\r\n
  [Full request URI: http://api.example.com/api/users]
```

### –ü–æ–∏—Å–∫ —É—á—ë—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –≤ HTTP

```bash
# Display filter –¥–ª—è Basic Auth
http.authorization

# Display filter –¥–ª—è —Ñ–æ—Ä–º —Å –ø–∞—Ä–æ–ª—è–º–∏
http.request.method == "POST" && http.file_data contains "password"

# –ü—Ä–∏–º–µ—Ä POST —Å —É—á—ë—Ç–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
http.request.method == "POST" && http.request.uri contains "login"
```

**–ü—Ä–∏–º–µ—Ä –ø–µ—Ä–µ—Ö–≤–∞—á–µ–Ω–Ω–æ–≥–æ POST-–∑–∞–ø—Ä–æ—Å–∞:**

```
POST /wp-login.php HTTP/1.1
Host: victim.example.com
Content-Type: application/x-www-form-urlencoded
Content-Length: 78

log=admin&pwd=SuperSecret123&wp-submit=Log+In&redirect_to=%2Fwp-admin%2F
```

### –ê–Ω–∞–ª–∏–∑ HTTP-–æ—Ç–≤–µ—Ç–æ–≤

```wireshark
# –ù–∞–π—Ç–∏ –≤—Å–µ —Ä–µ–¥–∏—Ä–µ–∫—Ç—ã
http.response.code == 301 || http.response.code == 302

# –ù–∞–π—Ç–∏ –æ—à–∏–±–∫–∏ —Å–µ—Ä–≤–µ—Ä–∞
http.response.code >= 500

# –ù–∞–π—Ç–∏ –±–æ–ª—å—à–∏–µ –æ—Ç–≤–µ—Ç—ã (–≤–æ–∑–º–æ–∂–Ω–∞—è —ç–∫—Å—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è)
http.content_length > 100000

# –ù–∞–π—Ç–∏ –Ω–µ–æ–±—ã—á–Ω—ã–µ Content-Type
http.content_type contains "octet-stream"
```

### –ê–Ω–∞–ª–∏–∑ Cookie

```bash
# Display filter
http.cookie

# –ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞ –≤ Wireshark:
# Cookie: session=abc123; admin=true; remember_me=1

# –ü–æ–∏—Å–∫ –Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω—ã—Ö –∞—Ç—Ä–∏–±—É—Ç–æ–≤ (–Ω–µ—Ç httponly/secure)
# –í–∏–¥–Ω–æ –≤ Set-Cookie: –µ—Å–ª–∏ –Ω–µ—Ç "HttpOnly" ‚Äî —É—è–∑–≤–∏–º–æ—Å—Ç—å XSS
```

---

## üî° 8.1.7 –ê–Ω–∞–ª–∏–∑ DNS-—Ç—Ä–∞—Ñ–∏–∫–∞

### –ù–æ—Ä–º–∞–ª—å–Ω—ã–π DNS-—Ç—Ä–∞—Ñ–∏–∫

```
‚ñº Domain Name System (query)
  Transaction ID: 0x1234
  Flags: 0x0100 Standard query
  Questions: 1
  ‚ñº Queries
    ‚ñº google.com: type A, class IN
        Name: google.com
        Type: A (Host Address)
        Class: IN (0x0001)
```

```
‚ñº Domain Name System (response)
  Transaction ID: 0x1234
  Flags: 0x8180 Standard query response, No error
  Answers: 1
  ‚ñº Answers
    ‚ñº google.com: type A, class IN, addr 142.250.185.78
        Name: google.com
        Type: A
        TTL: 300
        Data length: 4
        Address: 142.250.185.78
```

### –ê–Ω–æ–º–∞–ª–∏–∏ –≤ DNS-—Ç—Ä–∞—Ñ–∏–∫–µ

```wireshark
# DNS-–∑–∞–ø—Ä–æ—Å—ã —Å –∞–Ω–æ–º–∞–ª—å–Ω–æ –¥–ª–∏–Ω–Ω—ã–º–∏ –∏–º–µ–Ω–∞–º–∏ (DGA, —Ç—É–Ω–Ω–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ)
dns.qry.name.len > 50

# –ó–∞–ø—Ä–æ—Å—ã TXT-–∑–∞–ø–∏—Å–µ–π (—á–∞—Å—Ç—ã–π –≤–µ–∫—Ç–æ—Ä DNS tunneling)
dns.qry.type == 16

# –ó–∞–ø—Ä–æ—Å—ã NULL-–∑–∞–ø–∏—Å–µ–π (iodine –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —ç—Ç–æ—Ç —Ç–∏–ø)
dns.qry.type == 10

# –ë–æ–ª—å—à–∏–µ DNS-–æ—Ç–≤–µ—Ç—ã
dns.resp.len > 512

# –ú–Ω–æ–≥–æ NXDOMAIN –æ—Ç–≤–µ—Ç–æ–≤ (DGA-–≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä –¥–æ–º–µ–Ω–æ–≤)
dns.flags.rcode == 3

# –ó–∞–ø—Ä–æ—Å—ã –∫ –Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–º DNS-—Å–µ—Ä–≤–µ—Ä–∞–º
dns && ip.dst != 8.8.8.8 && ip.dst != 8.8.4.4 && ip.dst != 1.1.1.1
```

### –ü—Ä–∏–∑–Ω–∞–∫–∏ DNS Tunneling

| –ü—Ä–∏–∑–Ω–∞–∫ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| –î–ª–∏–Ω–Ω—ã–µ —Å—É–±–¥–æ–º–µ–Ω—ã | `base64encodeddata.evil.com` –¥–ª–∏–Ω–Ω–µ–µ 50 —Å–∏–º–≤–æ–ª–æ–≤ |
| –í—ã—Å–æ–∫–∞—è —á–∞—Å—Ç–æ—Ç–∞ –∑–∞–ø—Ä–æ—Å–æ–≤ | > 100 DNS-–∑–∞–ø—Ä–æ—Å–æ–≤ –≤ —Å–µ–∫—É–Ω–¥—É |
| TXT/NULL/CNAME —Ç–∏–ø—ã | –ù–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ —Ç–∏–ø—ã –¥–ª—è —Ç—É–Ω–Ω–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è |
| –≠–Ω—Ç—Ä–æ–ø–∏—è –≤ –∏–º–µ–Ω–∞—Ö | –°–ª—É—á–∞–π–Ω–æ –≤—ã–≥–ª—è–¥—è—â–∏–µ —Å—É–±–¥–æ–º–µ–Ω—ã |
| –ë–æ–ª—å—à–æ–π —Ä–∞–∑–º–µ—Ä –æ—Ç–≤–µ—Ç–∞ | DNS-–æ—Ç–≤–µ—Ç—ã > 512 –±–∞–π—Ç |
| –û–¥–∏–Ω –¥–æ–º–µ–Ω ‚Äî –º–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–æ–≤ | –í—Å–µ –∑–∞–ø—Ä–æ—Å—ã –∏–¥—É—Ç –∫ –æ–¥–Ω–æ–º—É –¥–æ–º–µ–Ω—É |

---

## üîê 8.1.8 –ê–Ω–∞–ª–∏–∑ TLS-—Ç—Ä–∞—Ñ–∏–∫–∞

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ TLS Handshake

```
Client                          Server
  |                               |
  |------ ClientHello ----------->|
  |       (–≤–µ—Ä—Å–∏—è, cipher suites, |
  |        —Å–ª—É—á–∞–π–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ, SNI) |
  |                               |
  |<----- ServerHello ------------|
  |       (–≤—ã–±—Ä–∞–Ω–Ω—ã–π cipher,      |
  |        —Å–ª—É—á–∞–π–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ)      |
  |                               |
  |<----- Certificate ------------|
  |<----- ServerHelloDone --------|
  |                               |
  |------ ClientKeyExchange ----->|
  |------ ChangeCipherSpec ------>|
  |------ Finished -------------->|
  |                               |
  |<----- ChangeCipherSpec -------|
  |<----- Finished ---------------|
  |                               |
  |=== –ó–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ ======|
```

### –ê–Ω–∞–ª–∏–∑ TLS –≤ Wireshark

```wireshark
# –í—Å–µ TLS-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
tls

# ClientHello ‚Äî –Ω–∞—á–∞–ª–æ –Ω–æ–≤–æ–≥–æ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
tls.handshake.type == 1

# ServerHello
tls.handshake.type == 2

# Certificate ‚Äî —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç —Å–µ—Ä–≤–µ—Ä–∞
tls.handshake.type == 11

# SNI (Server Name Indication) ‚Äî –æ—Ç–∫—Ä—ã—Ç—ã–π hostname
tls.handshake.extensions_server_name

# –í–µ—Ä—Å–∏—è TLS (—Å—Ç–∞—Ä—ã–µ –≤–µ—Ä—Å–∏–∏ ‚Äî –ø—Ä–æ–±–ª–µ–º–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏)
tls.handshake.version == 0x0301   # TLS 1.0 (—É—Å—Ç–∞—Ä–µ–ª)
tls.handshake.version == 0x0302   # TLS 1.1 (—É—Å—Ç–∞—Ä–µ–ª)
tls.handshake.version == 0x0303   # TLS 1.2
tls.handshake.version == 0x0304   # TLS 1.3

# –°–ª–∞–±—ã–µ cipher suites
tls.handshake.ciphersuite == 0x0004  # RC4 (–Ω–µ–±–µ–∑–æ–ø–∞—Å–µ–Ω)

# TLS alerts (–æ—à–∏–±–∫–∏)
tls.alert_message.desc == 42         # bad_certificate
tls.alert_message.desc == 48         # unknown_ca

# –ü–æ–∏—Å–∫ –ø–æ SNI
tls.handshake.extensions_server_name contains "evil.com"
```

### –†–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞ TLS –≤ Wireshark (–µ—Å–ª–∏ –µ—Å—Ç—å –∫–ª—é—á–∏)

```bash
# –ú–µ—Ç–æ–¥ 1: Pre-master secret log (–¥–ª—è –±—Ä–∞—É–∑–µ—Ä–æ–≤)
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è
export SSLKEYLOGFILE=/tmp/ssl_keys.log

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –±—Ä–∞—É–∑–µ—Ä —Å —ç—Ç–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π
firefox

# –í Wireshark: Edit ‚Üí Preferences ‚Üí Protocols ‚Üí TLS
# –£–∫–∞–∑–∞—Ç—å –ø—É—Ç—å –∫ (Pre)-Master-Secret log filename

# –ú–µ—Ç–æ–¥ 2: RSA-–∫–ª—é—á —Å–µ—Ä–≤–µ—Ä–∞ (—Ç–æ–ª—å–∫–æ –¥–ª—è —Å—Ç–∞—Ä—ã—Ö –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ –±–µ–∑ PFS)
# Edit ‚Üí Preferences ‚Üí Protocols ‚Üí TLS ‚Üí RSA keys list
# IP: IP_—Å–µ—Ä–≤–µ—Ä–∞, Port: 443, Protocol: http, Key File: server.key
```

---

## üåê 8.1.9 –ê–Ω–∞–ª–∏–∑ ARP-—Ç—Ä–∞—Ñ–∏–∫–∞

### –ù–æ—Ä–º–∞–ª—å–Ω—ã–π ARP

```
ARP Request: "–ö—Ç–æ –∏–º–µ–µ—Ç IP 192.168.1.1? –°–∫–∞–∂–∏ 192.168.1.100"
ARP Reply:   "192.168.1.1 –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –ø–æ MAC aa:bb:cc:dd:ee:ff"
```

```
‚ñº Address Resolution Protocol (request)
  Hardware type: Ethernet (1)
  Protocol type: IPv4 (0x0800)
  Hardware size: 6
  Protocol size: 4
  Opcode: request (1)
  Sender MAC address: 00:11:22:33:44:55
  Sender IP address: 192.168.1.100
  Target MAC address: 00:00:00:00:00:00
  Target IP address: 192.168.1.1
```

### –ü—Ä–∏–∑–Ω–∞–∫–∏ ARP Spoofing/Poisoning

```wireshark
# –î–µ—Ç–µ–∫—Ç–æ—Ä –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è ARP
arp.duplicate-address-detected

# –ú–Ω–æ–∂–µ—Å—Ç–≤–æ ARP-reply –æ—Ç –æ–¥–Ω–æ–≥–æ MAC
arp.opcode == 2

# Gratuitous ARP (broadcast reply ‚Äî —á–∞—Å—Ç–æ –ø—Ä–∏–∑–Ω–∞–∫ ARP spoofing)
arp.isgratuitous == 1

# ARP reply —Å –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ–º MAC
# –ï—Å–ª–∏ –æ–¥–∏–Ω IP –∏–º–µ–µ—Ç —Ä–∞–∑–Ω—ã–µ MAC –≤ —Ä–∞–∑–Ω—ã—Ö –ø–∞–∫–µ—Ç–∞—Ö
```

**–ü—Ä–∏–∑–Ω–∞–∫–∏ ARP Spoofing:**

| –ù–æ—Ä–º–∞–ª—å–Ω–æ | –ü–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ |
|-----------|---------------|
| –†–µ–¥–∫–∏–µ ARP-–∑–∞–ø—Ä–æ—Å—ã | –ü–æ—Ç–æ–∫ ARP-–æ—Ç–≤–µ—Ç–æ–≤ –±–µ–∑ –∑–∞–ø—Ä–æ—Å–æ–≤ |
| –û–¥–∏–Ω IP = –æ–¥–∏–Ω MAC | –û–¥–∏–Ω IP –∏–º–µ–µ—Ç —Ä–∞–∑–Ω—ã–µ MAC –≤ —Ä–∞–∑–Ω—ã—Ö –ø–∞–∫–µ—Ç–∞—Ö |
| –¢–æ–ª—å–∫–æ unicast reply | Broadcast ARP reply |
| –ó–∞–ø—Ä–æ—Å ‚Üí –û—Ç–≤–µ—Ç | –û—Ç–≤–µ—Ç –±–µ–∑ –∑–∞–ø—Ä–æ—Å–∞ (Gratuitous ARP) |

**–ü—Ä–∏–º–µ—Ä –∞—Ç–∞–∫–∏ ARP Spoofing –≤ Wireshark:**

```
# –ê—Ç–∞–∫—É—é—â–∏–π 192.168.1.50 (MAC: 00:de:ad:be:ef:00) –æ—Ç—Ä–∞–≤–ª—è–µ—Ç ARP-–∫—ç—à
# –ñ–µ—Ä—Ç–≤–∞ 192.168.1.100, –®–ª—é–∑ 192.168.1.1

Packet 1: ARP Reply: "192.168.1.1 is at 00:de:ad:be:ef:00" (broadcast)
Packet 2: ARP Reply: "192.168.1.1 is at 00:de:ad:be:ef:00" (unicast to victim)
Packet 3: ARP Reply: "192.168.1.100 is at 00:de:ad:be:ef:00" (to gateway)

# –¢–µ–ø–µ—Ä—å –≤–µ—Å—å —Ç—Ä–∞—Ñ–∏–∫ –º–µ–∂–¥—É –∂–µ—Ä—Ç–≤–æ–π –∏ —à–ª—é–∑–æ–º –ø—Ä–æ—Ö–æ–¥–∏—Ç —á–µ—Ä–µ–∑ –∞—Ç–∞–∫—É—é—â–µ–≥–æ
```

---

## üìä 8.1.10 Statistics –≤ Wireshark

### Protocol Hierarchy

```
Statistics ‚Üí Protocol Hierarchy
```

–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–≤ –≤ –∑–∞—Ö–≤–∞—á–µ–Ω–Ω–æ–º —Ç—Ä–∞—Ñ–∏–∫–µ –≤ –≤–∏–¥–µ –¥–µ—Ä–µ–≤–∞:

```
Protocol          | Packets | % Packets | Bytes   | % Bytes |
Frame             | 10000   | 100.0%    | 5.2 MB  | 100.0%  |
  Ethernet        | 10000   | 100.0%    | 5.2 MB  | 100.0%  |
    IPv4          | 9850    | 98.5%     | 5.1 MB  | 98.1%   |
      TCP         | 7200    | 72.0%     | 4.1 MB  | 78.8%   |
        HTTP      | 1200    | 12.0%     | 2.1 MB  | 40.4%   |
        TLS       | 5100    | 51.0%     | 1.8 MB  | 34.6%   |
      UDP         | 2400    | 24.0%     | 0.8 MB  | 15.4%   |
        DNS       | 2000    | 20.0%     | 0.4 MB  | 7.7%    |
    IPv6          | 100     | 1.0%      | ...     | ...     |
    ARP           | 50      | 0.5%      | ...     | ...     |
```

> **Note:** –ê–Ω–æ–º–∞–ª—å–Ω–æ –≤—ã—Å–æ–∫–∞—è –¥–æ–ª—è DNS-—Ç—Ä–∞—Ñ–∏–∫–∞ (> 5-10%) –º–æ–∂–µ—Ç —É–∫–∞–∑—ã–≤–∞—Ç—å –Ω–∞ DNS tunneling –∏–ª–∏ DGA –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å.

### Conversations

```
Statistics ‚Üí Conversations
```

–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π —Å —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–æ–π –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –±–∞–π—Ç, –ø–∞–∫–µ—Ç–æ–≤, –ø—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.

–í–∫–ª–∞–¥–∫–∏: Ethernet | IPv4 | IPv6 | TCP | UDP

**–ß—Ç–æ –∏—Å–∫–∞—Ç—å:**
- –°–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å –Ω–µ–æ–±—ã—á–Ω–æ –±–æ–ª—å—à–∏–º –æ–±—ä—ë–º–æ–º –¥–∞–Ω–Ω—ã—Ö
- –ú–Ω–æ–∂–µ—Å—Ç–≤–æ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π –æ—Ç –æ–¥–Ω–æ–≥–æ —Ö–æ—Å—Ç–∞ (—Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ)
- –°–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å –Ω–µ–æ–±—ã—á–Ω—ã–º–∏ IP-–∞–¥—Ä–µ—Å–∞–º–∏

### Endpoints

```
Statistics ‚Üí Endpoints
```

–°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∞–¥—Ä–µ—Å–æ–≤ —Å —Å—É–º–º–∞—Ä–Ω—ã–º —Ç—Ä–∞—Ñ–∏–∫–æ–º.

–ü—Ä–∞–≤–∞—è –∫–Ω–æ–ø–∫–∞ ‚Üí Apply as Filter / Apply as Column

### I/O Graph

```
Statistics ‚Üí I/O Graph
```

–ì—Ä–∞—Ñ–∏–∫ –ø—Ä–æ–ø—É—Å–∫–Ω–æ–π —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ –≤–æ –≤—Ä–µ–º–µ–Ω–∏. –ü–æ–º–æ–≥–∞–µ—Ç –æ–±–Ω–∞—Ä—É–∂–∏—Ç—å:
- –ü–∏–∫–∏ —Ç—Ä–∞—Ñ–∏–∫–∞ (–º–æ–º–µ–Ω—Ç –∞—Ç–∞–∫–∏, —ç–∫—Å—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏)
- –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–π —Ç—Ä–∞—Ñ–∏–∫ (beaconing C2)
- –ê–Ω–æ–º–∞–ª—å–Ω–æ –Ω–∏–∑–∫–∏–π/–≤—ã—Å–æ–∫–∏–π —Ç—Ä–∞—Ñ–∏–∫

**–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–ª—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è beaconing:**

```
Y Axis: Packets/Tick
X Interval: 1 second
Filter: ip.dst == <–ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–π_ip>
```

### Flow Graph

```
Statistics ‚Üí Flow Graph
```

–û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –≤—Ä–µ–º–µ–Ω–Ω—ÉÃÅ—é –¥–∏–∞–≥—Ä–∞–º–º—É –æ–±–º–µ–Ω–∞ –ø–∞–∫–µ—Ç–∞–º–∏ –º–µ–∂–¥—É —Ö–æ—Å—Ç–∞–º–∏ (–Ω–∞–ø–æ–¥–æ–±–∏–µ –¥–∏–∞–≥—Ä–∞–º–º—ã –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è).

---

## üíæ 8.1.11 –≠–∫—Å–ø–æ—Ä—Ç –æ–±—ä–µ–∫—Ç–æ–≤

### –≠–∫—Å–ø–æ—Ä—Ç HTTP-–æ–±—ä–µ–∫—Ç–æ–≤

Wireshark –º–æ–∂–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–∑–≤–ª–µ–∫–∞—Ç—å —Ñ–∞–π–ª—ã, –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã–µ –ø–æ HTTP.

```
File ‚Üí Export Objects ‚Üí HTTP
```

–ü–æ—è–≤–∏—Ç—Å—è —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤:
- HTML-—Å—Ç—Ä–∞–Ω–∏—Ü—ã
- –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
- –°–∫—Ä–∏–ø—Ç—ã JavaScript
- –ó–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã (exe, pdf, zip –∏ —Ç.–¥.)

–≠—Ç–æ –Ω–µ–≤–µ—Ä–æ—è—Ç–Ω–æ –ø–æ–ª–µ–∑–Ω–æ –ø—Ä–∏ –∞–Ω–∞–ª–∏–∑–µ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ –ü–û, –ø–µ—Ä–µ–¥–∞–Ω–Ω–æ–≥–æ —á–µ—Ä–µ–∑ HTTP.

### –≠–∫—Å–ø–æ—Ä—Ç SMB/CIFS-–æ–±—ä–µ–∫—Ç–æ–≤

```
File ‚Üí Export Objects ‚Üí SMB
```

–ü–æ–∑–≤–æ–ª—è–µ—Ç –∏–∑–≤–ª–µ—á—å —Ñ–∞–π–ª—ã, –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã–µ –ø–æ SMB (Windows file sharing).

### –≠–∫—Å–ø–æ—Ä—Ç –≤ —Ä–∞–∑–ª–∏—á–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã

```
File ‚Üí Save As –∏–ª–∏ Export Specified Packets

–§–æ—Ä–º–∞—Ç—ã:
- .pcapng  ‚Äî —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
- .pcap    ‚Äî –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π —Ñ–æ—Ä–º–∞—Ç (—Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å)
- .csv     ‚Äî –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –≤ Excel/Python
- .json    ‚Äî –¥–ª—è –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞
- .txt     ‚Äî —Ç–µ–∫—Å—Ç–æ–≤—ã–π –¥–∞–º–ø
```

### –î–∏—Å—Å–µ–∫—Ç–æ—Ä—ã

–î–∏—Å—Å–µ–∫—Ç–æ—Ä—ã (Dissectors) ‚Äî —ç—Ç–æ –ø–ª–∞–≥–∏–Ω—ã Wireshark, –∫–æ—Ç–æ—Ä—ã–µ —Ä–∞–∑–±–∏—Ä–∞—é—Ç –ø—Ä–æ—Ç–æ–∫–æ–ª—ã. –ï—Å–ª–∏ —Ç—Ä–∞—Ñ–∏–∫ –∏–¥—ë—Ç –Ω–∞ –Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –ø–æ—Ä—Ç:

```
–ü—Ä–∞–≤–∞—è –∫–Ω–æ–ø–∫–∞ –Ω–∞ –ø–∞–∫–µ—Ç–µ ‚Üí Decode As...
–í—ã–±—Ä–∞—Ç—å –Ω—É–∂–Ω—ã–π –ø—Ä–æ—Ç–æ–∫–æ–ª

–ù–∞–ø—Ä–∏–º–µ—Ä: HTTP-—Ç—Ä–∞—Ñ–∏–∫ –Ω–∞ –ø–æ—Ä—Ç—É 8080 –∏–ª–∏ 8443
```

---

## üõ†Ô∏è 8.1.12 –ü–æ–ª–µ–∑–Ω—ã–µ –ø—Ä–∏—ë–º—ã —Ä–∞–±–æ—Ç—ã

### Marks –∏ Time Reference

```bash
# –û—Ç–º–µ—Ç–∏—Ç—å –ø–∞–∫–µ—Ç (–¥–ª—è –æ—Ä–∏–µ–Ω—Ç–∏—Ä–∞ –≤ –¥–ª–∏–Ω–Ω–æ–º –∑–∞—Ö–≤–∞—Ç–µ)
Ctrl+M (Toggle Mark)

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—Ä–µ–º–µ–Ω–Ω—ÉÃÅ—é —Ç–æ—á–∫—É –æ—Ç—Å—á—ë—Ç–∞ –Ω–∞ –ø–∞–∫–µ—Ç
Ctrl+T (Set/Unset Time Reference)
# –ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –≤—Ä–µ–º—è –≤—Å–µ—Ö –ø–∞–∫–µ—Ç–æ–≤ –±—É–¥–µ—Ç –æ—Ç—Å—á–∏—Ç—ã–≤–∞—Ç—å—Å—è –æ—Ç –¥–∞–Ω–Ω–æ–≥–æ –ø–∞–∫–µ—Ç–∞
```

### –ü–æ–∏—Å–∫ –≤ —Å–æ–¥–µ—Ä–∂–∏–º–æ–º –ø–∞–∫–µ—Ç–æ–≤

```
Edit ‚Üí Find Packet (Ctrl+F)

–ò—Å–∫–∞—Ç—å –≤: Display filter / Hex value / String / Regular expression
```

**–ü—Ä–∏–º–µ—Ä—ã –ø–æ–∏—Å–∫–∞ –ø–æ —Å—Ç—Ä–æ–∫–µ:**

```
–°—Ç—Ä–æ–∫–∞: "password"    ‚Äî –Ω–∞–π—Ç–∏ –ø–∞–∫–µ—Ç—ã —Å –ø–∞—Ä–æ–ª—è–º–∏
–°—Ç—Ä–æ–∫–∞: "cmd.exe"     ‚Äî –ø—Ä–∏–∑–Ω–∞–∫–∏ shell-–∫–æ–º–∞–Ω–¥
–°—Ç—Ä–æ–∫–∞: "SELECT"      ‚Äî SQL-–∑–∞–ø—Ä–æ—Å—ã
–°—Ç—Ä–æ–∫–∞: "eval("       ‚Äî –æ–±—Ñ—É—Å—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π JavaScript
Regex:  "(?:admin|root|sa):.+@" ‚Äî —É—á—ë—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
```

### –ö–æ–º–∞–Ω–¥–Ω–∞—è —Å—Ç—Ä–æ–∫–∞ tshark

```bash
# –í—ã–≤–æ–¥ –ø–æ–ª–µ–π –≤ CSV –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
tshark -r capture.pcap -T fields \
  -e frame.number \
  -e frame.time \
  -e ip.src \
  -e ip.dst \
  -e tcp.dstport \
  -e http.request.uri \
  -Y "http.request" \
  -E separator=","

# –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–≤
tshark -r capture.pcap -q -z io,phs

# –¢–æ–ø —Ö–æ—Å—Ç–æ–≤ –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –ø–∞–∫–µ—Ç–æ–≤
tshark -r capture.pcap -q -z endpoints,ip

# –í—Å–µ DNS-–∑–∞–ø—Ä–æ—Å—ã
tshark -r capture.pcap -Y "dns.flags.response == 0" \
  -T fields -e dns.qry.name | sort | uniq -c | sort -rn

# –ò–∑–≤–ª–µ—á—å HTTP-–æ–±—ä–µ–∫—Ç—ã
tshark -r capture.pcap --export-objects "http,/tmp/http_objects"

# –§–∏–ª—å—Ç—Ä –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –Ω–æ–≤—ã–π —Ñ–∞–π–ª
tshark -r big_capture.pcap -Y "ip.addr == 10.0.0.1" -w filtered.pcap
```

---

## üî¨ 8.1.13 –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –∑–∞–¥–∞–Ω–∏—è

### –ó–∞–¥–∞–Ω–∏–µ 1: –ë–∞–∑–æ–≤—ã–π –∞–Ω–∞–ª–∏–∑ PCAP

**–°—Ü–µ–Ω–∞—Ä–∏–π:** –í–∞–º –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω —Ñ–∞–π–ª `network_capture.pcap`. –ù–µ–æ–±—Ö–æ–¥–∏–º–æ –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –µ–≥–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ.

```bash
# –®–∞–≥ 1: –û—Ç–∫—Ä—ã—Ç—å —Ñ–∞–π–ª
wireshark network_capture.pcap

# –®–∞–≥ 2: –ò–∑—É—á–∏—Ç—å Protocol Hierarchy
# Statistics ‚Üí Protocol Hierarchy

# –®–∞–≥ 3: –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Ç–æ–ø-—Ö–æ—Å—Ç—ã
# Statistics ‚Üí Endpoints ‚Üí IPv4

# –®–∞–≥ 4: –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Ç–æ–ø-—Ä–∞–∑–≥–æ–≤–æ—Ä—ã
# Statistics ‚Üí Conversations ‚Üí TCP
```

**–í–æ–ø—Ä–æ—Å—ã –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞:**
1. –ö–∞–∫–∏–µ –ø—Ä–æ—Ç–æ–∫–æ–ª—ã –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç –≤ –∑–∞—Ö–≤–∞—Ç–µ?
2. –ö–∞–∫–æ–π —Ö–æ—Å—Ç –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –Ω–∞–∏–±–æ–ª—å—à–∏–π —Ç—Ä–∞—Ñ–∏–∫?
3. –ï—Å—Ç—å –ª–∏ HTTP —Ç—Ä–∞—Ñ–∏–∫? –ï—Å–ª–∏ –¥–∞, —á—Ç–æ –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è?

### –ó–∞–¥–∞–Ω–∏–µ 2: –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ ARP Spoofing

**–§–∞–π–ª:** `arp_attack.pcap`

```bash
# –ü—Ä–∏–º–µ–Ω–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä
arp

# –ò—Å–∫–∞—Ç—å –ø—Ä–∏–∑–Ω–∞–∫–∏ –∞—Ç–∞–∫–∏
arp.duplicate-address-detected
arp.isgratuitous == 1

# –®–∞–≥–∏ –∞–Ω–∞–ª–∏–∑–∞:
# 1. –û—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ –≤—Ä–µ–º–µ–Ω–∏
# 2. –ù–∞–π—Ç–∏ ARP Reply –±–µ–∑ –ø—Ä–µ–¥—à–µ—Å—Ç–≤—É—é—â–µ–≥–æ Request
# 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –º–µ–Ω—è–µ—Ç—Å—è –ª–∏ MAC –¥–ª—è –æ–¥–Ω–æ–≥–æ IP
# 4. –ò–¥–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –∞—Ç–∞–∫—É—é—â–µ–≥–æ
```

**–û–∂–∏–¥–∞–µ–º—ã–µ –Ω–∞—Ö–æ–¥–∫–∏:**
- IP —à–ª—é–∑–∞ (192.168.1.1) –∏–º–µ–µ—Ç –¥–≤–∞ —Ä–∞–∑–Ω—ã—Ö MAC –≤ —Ä–∞–∑–Ω—ã—Ö –ø–∞–∫–µ—Ç–∞—Ö
- –û–¥–∏–Ω –∏–∑ MAC –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç –∞—Ç–∞–∫—É—é—â–µ–º—É
- Broadcast ARP Replies –±–µ–∑ –∑–∞–ø—Ä–æ—Å–æ–≤

### –ó–∞–¥–∞–Ω–∏–µ 3: –ê–Ω–∞–ª–∏–∑ HTTP-–∞—Ç–∞–∫–∏

**–§–∞–π–ª:** `web_attack.pcap`

```bash
# –ù–∞–π—Ç–∏ SQL Injection –ø–æ–ø—ã—Ç–∫–∏
http.request.uri matches "(%27|'|%22|\"|SELECT|UNION|OR 1=1)"

# –ù–∞–π—Ç–∏ Directory Traversal
http.request.uri matches "(\.\./|%2e%2e%2f)"

# –ù–∞–π—Ç–∏ –ø—Ä–∏–∑–Ω–∞–∫–∏ —É—Å–ø–µ—à–Ω–æ–π –∞—Ç–∞–∫–∏
http.response.code == 200 && http.request.uri contains "admin"

# –°–ª–µ–¥–æ–≤–∞—Ç—å –∑–∞ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–º –ø–æ—Ç–æ–∫–æ–º
# –ü—Ä–∞–≤–∞—è –∫–Ω–æ–ø–∫–∞ ‚Üí Follow ‚Üí TCP Stream

# –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –∏–∑–≤–ª–µ—á—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
# File ‚Üí Export Objects ‚Üí HTTP
```

### –ó–∞–¥–∞–Ω–∏–µ 4: –ê–Ω–∞–ª–∏–∑ DNS Tunneling

**–§–∞–π–ª:** `dns_tunnel.pcap`

```bash
# –®–∞–≥ 1: –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –Ω–∞ DNS —Ç—Ä–∞—Ñ–∏–∫
dns

# –®–∞–≥ 2: –ù–∞–π—Ç–∏ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã
dns.qry.name.len > 50

# –®–∞–≥ 3: –ù–∞–π—Ç–∏ –∑–∞–ø—Ä–æ—Å—ã TXT
dns.qry.type == 16

# –®–∞–≥ 4: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å tshark –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –≤—Å–µ—Ö —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
tshark -r dns_tunnel.pcap -Y "dns.flags.response == 0" \
  -T fields -e dns.qry.name | sort | uniq

# –®–∞–≥ 5: –î–µ–∫–æ–¥–∏—Ä–æ–≤–∞—Ç—å base64 –∏–∑ —Å—É–±–¥–æ–º–µ–Ω–æ–≤
# –ù–∞–ø—Ä–∏–º–µ—Ä: aGVsbG8gd29ybGQ=.tunnel.evil.com ‚Üí "hello world"
echo "aGVsbG8gd29ybGQ=" | base64 -d
```

### –ó–∞–¥–∞–Ω–∏–µ 5: CTF-—Å—Ç–∏–ª—å ‚Äî –Ω–∞–π—Ç–∏ —Ñ–ª–∞–≥ –≤ PCAP

**–°—Ü–µ–Ω–∞—Ä–∏–π:** –í —Ñ–∞–π–ª–µ `ctf_challenge.pcap` —Å–ø—Ä—è—Ç–∞–Ω —Ñ–ª–∞–≥ –≤–∏–¥–∞ `CTF{...}`.

```bash
# –ú–µ—Ç–æ–¥ 1: –ü–æ–∏—Å–∫ —Å—Ç—Ä–æ–∫–∏
# Edit ‚Üí Find Packet ‚Üí String ‚Üí "CTF{"

# –ú–µ—Ç–æ–¥ 2: tshark
tshark -r ctf_challenge.pcap -Y "frame contains \"CTF{\"" \
  -T fields -e frame.number -e data.text

# –ú–µ—Ç–æ–¥ 3: strings + grep
tshark -r ctf_challenge.pcap -x | strings | grep -i "CTF{"

# –ú–µ—Ç–æ–¥ 4: –≠–∫—Å–ø–æ—Ä—Ç –æ–±—ä–µ–∫—Ç–æ–≤ –∏ –ø–æ–∏—Å–∫
tshark -r ctf_challenge.pcap --export-objects "http,/tmp/ctf_objects"
grep -r "CTF{" /tmp/ctf_objects/

# –ú–µ—Ç–æ–¥ 5: –ß–µ—Ä–µ–∑ scapy
python3 << 'EOF'
from scapy.all import rdpcap, Raw
packets = rdpcap('ctf_challenge.pcap')
for pkt in packets:
    if Raw in pkt:
        payload = pkt[Raw].load
        if b'CTF{' in payload:
            print(f"Found in packet!")
            print(payload)
EOF
```

---

## üìã 8.1.14 –®–ø–∞—Ä–≥–∞–ª–∫–∞ –ø–æ –≥–æ—Ä—è—á–∏–º –∫–ª–∞–≤–∏—à–∞–º Wireshark

| –î–µ–π—Å—Ç–≤–∏–µ | Windows/Linux | macOS |
|----------|--------------|-------|
| –ù–∞—á–∞—Ç—å –∑–∞—Ö–≤–∞—Ç | Ctrl+E | Cmd+E |
| –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞—Ö–≤–∞—Ç | Ctrl+E | Cmd+E |
| –û—Ç–∫—Ä—ã—Ç—å —Ñ–∞–π–ª | Ctrl+O | Cmd+O |
| –°–æ—Ö—Ä–∞–Ω–∏—Ç—å | Ctrl+S | Cmd+S |
| –ù–∞–π—Ç–∏ –ø–∞–∫–µ—Ç | Ctrl+F | Cmd+F |
| –°–ª–µ–¥—É—é—â–∏–π –ø–∞–∫–µ—Ç | Ctrl+N | Cmd+N |
| –ü—Ä–µ–¥—ã–¥—É—â–∏–π –ø–∞–∫–µ—Ç | Ctrl+B | Cmd+B |
| –ü–µ—Ä–µ–π—Ç–∏ –∫ –ø–∞–∫–µ—Ç—É | Ctrl+G | Cmd+G |
| –û—Ç–º–µ—Ç–∏—Ç—å –ø–∞–∫–µ—Ç | Ctrl+M | Cmd+M |
| –£–≤–µ–ª–∏—á–∏—Ç—å | Ctrl++ | Cmd++ |
| –£–º–µ–Ω—å—à–∏—Ç—å | Ctrl+- | Cmd+- |
| Follow TCP Stream | Ctrl+Alt+T | ‚Äî |
| Colorize | Ctrl+Space | ‚Äî |
| –°–±—Ä–æ—Å–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä | Ctrl+Backspace | ‚Äî |

---

## üìö –†–µ—Å—É—Ä—Å—ã –¥–ª—è –ø—Ä–∞–∫—Ç–∏–∫–∏

| –†–µ—Å—É—Ä—Å | URL | –û–ø–∏—Å–∞–Ω–∏–µ |
|--------|-----|----------|
| Wireshark Sample Captures | wiki.wireshark.org/SampleCaptures | –û—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã |
| malware-traffic-analysis.net | malware-traffic-analysis.net | PCAP —Å —Ä–µ–∞–ª—å–Ω—ã–º –º–∞–ª–≤–∞—Ä—å—é |
| PacketTotal | packettotal.com | –û–Ω–ª–∞–π–Ω-–∞–Ω–∞–ª–∏–∑ PCAP |
| CloudShark | cloudshark.org | –û–±–ª–∞—á–Ω—ã–π Wireshark |
| PcapNg.com | pcapng.com | –û–±—Ä–∞–∑—Ü—ã PCAP |

---

## ‚úÖ –ò—Ç–æ–≥ –≥–ª–∞–≤—ã

–í —ç—Ç–æ–π –≥–ª–∞–≤–µ –≤—ã –æ—Å–≤–æ–∏–ª–∏:

- **–£—Å—Ç–∞–Ω–æ–≤–∫—É** Wireshark –Ω–∞ Linux –∏ Windows
- **–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å**: –ø–∞–Ω–µ–ª–∏, –∫–æ–ª–æ–Ω–∫–∏, —Ü–≤–µ—Ç–æ–≤–æ–µ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ
- **–§–∏–ª—å—Ç—Ä—ã –∑–∞—Ö–≤–∞—Ç–∞ (BPF)**: —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–π –∑–∞—Ö–≤–∞—Ç –Ω—É–∂–Ω–æ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞
- **Display Filters**: –º–æ—â–Ω—ã–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
- **Follow Stream**: –∞–Ω–∞–ª–∏–∑ TCP/UDP/HTTP —Å–µ—Å—Å–∏–π
- **–ê–Ω–∞–ª–∏–∑ –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–≤**: HTTP, DNS, TLS, ARP
- **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫—É**: Protocol Hierarchy, Conversations, I/O Graph
- **–≠–∫—Å–ø–æ—Ä—Ç**: –æ–±—ä–µ–∫—Ç—ã HTTP, —Ä–∞–∑–ª–∏—á–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã
- **–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –Ω–∞–≤—ã–∫–∏**: CTF-—Å—Ç–∏–ª—å —Ä–∞–∑–±–æ—Ä–∞ PCAP

> **Note:** Wireshark ‚Äî —ç—Ç–æ —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç —Å–µ—Ç–µ–≤–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞. –†–µ–≥—É–ª—è—Ä–Ω–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞ —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ PCAP-—Ñ–∞–π–ª–∞–º–∏ (–æ—Å–æ–±–µ–Ω–Ω–æ —Å malware-traffic-analysis.net) –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —É—Å–∫–æ—Ä–∏—Ç —Ä–∞–∑–≤–∏—Ç–∏–µ –Ω–∞–≤—ã–∫–æ–≤ SOC-–∞–Ω–∞–ª–∏—Ç–∏–∫–∞.
