# –ì–ª–∞–≤–∞ 1.3: ARP, DHCP, NAT –∏ –∫–ª—é—á–µ–≤—ã–µ –ø–æ—Ä—Ç—ã

## üéØ –¶–µ–ª–∏ –≥–ª–∞–≤—ã

- –ü–æ–Ω—è—Ç—å –º–µ—Ö–∞–Ω–∏–∑–º —Ä–∞–±–æ—Ç—ã ARP –∏ —É–≥—Ä–æ–∑—É ARP spoofing
- –ò–∑—É—á–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å DHCP (DORA) –∏ –∞—Ç–∞–∫—É DHCP starvation
- –†–∞–∑–æ–±—Ä–∞—Ç—å—Å—è –≤ —Ç–∏–ø–∞—Ö NAT: Static, Dynamic, PAT
- –í—ã—É—á–∏—Ç—å –∫–ª—é—á–µ–≤—ã–µ –ø–æ—Ä—Ç—ã –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–≤ –Ω–∞–∏–∑—É—Å—Ç—å
- –ü–æ–Ω—è—Ç—å, –∫–∞–∫–∏–µ –ø—Ä–æ—Ç–æ–∫–æ–ª—ã –æ–ø–∞—Å–Ω—ã –∏–∑-–∑–∞ –ø–µ—Ä–µ–¥–∞—á–∏ –¥–∞–Ω–Ω—ã—Ö –≤ –æ—Ç–∫—Ä—ã—Ç–æ–º –≤–∏–¥–µ
- –ù–∞—É—á–∏—Ç—å—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å arp, nmap –∏ Wireshark –¥–ª—è –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞

---

## 1.3.1 ARP: Address Resolution Protocol

### –ó–∞—á–µ–º –Ω—É–∂–µ–Ω ARP?

–ù–∞ —É—Ä–æ–≤–Ω–µ 3 (—Å–µ—Ç–µ–≤–æ–º) —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –∞–¥—Ä–µ—Å—É—é—Ç—Å—è –ø–æ IP. –ù–æ –Ω–∞ —É—Ä–æ–≤–Ω–µ 2 (–∫–∞–Ω–∞–ª—å–Ω–æ–º) –¥–∞–Ω–Ω—ã–µ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –ø–æ MAC-–∞–¥—Ä–µ—Å–∞–º. ARP —Ä–µ—à–∞–µ—Ç –∑–∞–¥–∞—á—É –ø–µ—Ä–µ–≤–æ–¥–∞: ¬´–ö–∞–∫–æ–π MAC-–∞–¥—Ä–µ—Å —É —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ —Å IP 192.168.1.1?¬ª

```
–°–∏—Ç—É–∞—Ü–∏—è: –∫–æ–º–ø—å—é—Ç–µ—Ä A (192.168.1.10) —Ö–æ—á–µ—Ç –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –∫–æ–º–ø—å—é—Ç–µ—Ä—É B (192.168.1.20)

–ß—Ç–æ –∑–Ω–∞–µ—Ç A: IP-–∞–¥—Ä–µ—Å B (192.168.1.20)
–ß—Ç–æ –Ω—É–∂–Ω–æ A: MAC-–∞–¥—Ä–µ—Å B –¥–ª—è —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è Ethernet-—Ñ—Ä–µ–π–º–∞
```

### –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç ARP

**–®–∞–≥ 1: ARP Request (—à–∏—Ä–æ–∫–æ–≤–µ—â–∞—Ç–µ–ª—å–Ω—ã–π)**
```
–ö–æ–º–ø—å—é—Ç–µ—Ä A –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç:
  Ethernet: src=AA:BB:CC:DD:EE:01, dst=FF:FF:FF:FF:FF:FF (broadcast!)
  ARP: ¬´–ö—Ç–æ –∏–º–µ–µ—Ç IP 192.168.1.20? –°–æ–æ–±—â–∏—Ç–µ 192.168.1.10¬ª

–í—Å–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –≤ —Å–µ–≥–º–µ–Ω—Ç–µ –ø–æ–ª—É—á–∞—é—Ç —ç—Ç–æ—Ç —Ñ—Ä–µ–π–º.
–¢–æ–ª—å–∫–æ 192.168.1.20 –æ—Ç–≤–µ—á–∞–µ—Ç.
```

**–®–∞–≥ 2: ARP Reply (–æ–¥–Ω–æ–∞–¥—Ä–µ—Å–Ω—ã–π)**
```
–ö–æ–º–ø—å—é—Ç–µ—Ä B –æ—Ç–≤–µ—á–∞–µ—Ç:
  Ethernet: src=AA:BB:CC:DD:EE:02, dst=AA:BB:CC:DD:EE:01 (unicast)
  ARP: ¬´192.168.1.20 ‚Äî —ç—Ç–æ —è. –ú–æ–π MAC: AA:BB:CC:DD:EE:02¬ª
```

**–®–∞–≥ 3: –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ**
```
–ö–æ–º–ø—å—é—Ç–µ—Ä A —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ ARP-–∫–µ—à:
  192.168.1.20 ‚Üí AA:BB:CC:DD:EE:02

–°–ª–µ–¥—É—é—â–∏–µ –ø–∞–∫–µ—Ç—ã –∫ 192.168.1.20 –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –±–µ–∑ ARP-–∑–∞–ø—Ä–æ—Å–∞.
–ó–∞–ø–∏—Å—å —Ö—Ä–∞–Ω–∏—Ç—Å—è 60-120 —Å–µ–∫—É–Ω–¥ (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç –û–°).
```

### –ü—Ä–æ—Å–º–æ—Ç—Ä ARP-—Ç–∞–±–ª–∏—Ü—ã

```bash
# Linux
arp -a          # –ø–æ–∫–∞–∑–∞—Ç—å –∫–µ—à –≤ BSD-—Ñ–æ—Ä–º–∞—Ç–µ
arp -n          # –±–µ–∑ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –∏–º—ë–Ω
ip neigh show   # —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π —Å–ø–æ—Å–æ–± (iproute2)
ip neigh        # –∫—Ä–∞—Ç–∫–∏–π –≤–∞—Ä–∏–∞–Ω—Ç

# Windows
arp -a

# –ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞:
? (192.168.1.1) at ac:84:c9:12:34:56 [ether] on eth0
? (192.168.1.20) at aa:bb:cc:dd:ee:02 [ether] on eth0

# –£–¥–∞–ª–∏—Ç—å –∑–∞–ø–∏—Å—å –∏–∑ –∫–µ—à–∞
sudo arp -d 192.168.1.20
sudo ip neigh del 192.168.1.20 dev eth0
```

### Gratuitous ARP

–£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç ARP Reply –±–µ–∑ –∑–∞–ø—Ä–æ—Å–∞. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è:
- –û–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–µ—à–∞ –¥—Ä—É–≥–∏—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ (–ø—Ä–∏ —Å–º–µ–Ω–µ MAC)
- –û–±—ä—è–≤–ª–µ–Ω–∏—è –æ –Ω–æ–≤–æ–º IP
- –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ IP

```
Gratuitous ARP:
  Sender IP = Target IP = 192.168.1.20 (—Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π IP)
  Sender MAC = –Ω–æ–≤—ã–π MAC
  –≠—Ç–æ –∑–∞—Å—Ç–∞–≤–ª—è–µ—Ç –≤—Å–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –æ–±–Ω–æ–≤–∏—Ç—å —Å–≤–æ–π ARP-–∫–µ—à
```

---

### ARP Spoofing (ARP Poisoning)

**–ü—Ä–∏–Ω—Ü–∏–ø:** ARP –Ω–µ –∏–º–µ–µ—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏. –õ—é–±–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –º–æ–∂–µ—Ç –æ—Ç–ø—Ä–∞–≤–∏—Ç—å ARP Reply —Å –ª–æ–∂–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –∏ –æ—Ç—Ä–∞–≤–∏—Ç—å ARP-–∫–µ—à –¥—Ä—É–≥–∏—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤.

```
–ù–æ—Ä–º–∞–ª—å–Ω–∞—è —Å–µ—Ç—å:
  –ö–æ–º–ø—å—é—Ç–µ—Ä A (192.168.1.10)
  –ö–æ–º–ø—å—é—Ç–µ—Ä B (192.168.1.20)
  –®–ª—é–∑/Router (192.168.1.1)

  A ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ Router ‚îÄ‚îÄ‚îÄ‚îÄ –ò–Ω—Ç–µ—Ä–Ω–µ—Ç
  B ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ Router ‚îÄ‚îÄ‚îÄ‚îÄ –ò–Ω—Ç–µ—Ä–Ω–µ—Ç

ARP Spoofing (–∞—Ç–∞–∫–∞ Man-in-the-Middle):
  –ó–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ M (192.168.1.99):

  M –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç A:  ¬´192.168.1.1 ‚Äî —ç—Ç–æ —è (MAC M)¬ª  ‚Üê –ø–æ–¥–¥–µ–ª—å–Ω—ã–π Gratuitous ARP
  M –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç R:  ¬´192.168.1.10 ‚Äî —ç—Ç–æ —è (MAC M)¬ª ‚Üê –ø–æ–¥–¥–µ–ª—å–Ω—ã–π Gratuitous ARP

  –†–µ–∑—É–ª—å—Ç–∞—Ç:
  A –¥—É–º–∞–µ—Ç, —á—Ç–æ MAC —à–ª—é–∑–∞ = MAC M
  Router –¥—É–º–∞–µ—Ç, —á—Ç–æ MAC A = MAC M

  –¢—Ä–∞—Ñ–∏–∫: A ‚Üí M ‚Üí Router (M –≤–∏–¥–∏—Ç –≤—Å—ë –∏ –ø–µ—Ä–µ—Å—ã–ª–∞–µ—Ç –¥–∞–ª—å—à–µ)
                ‚Üë
          Man-in-the-Middle!
```

**–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –∞—Ç–∞–∫–∏:**
- `arpspoof` (dsniff)
- `ettercap`
- `bettercap`

```bash
# –ü—Ä–∏–º–µ—Ä ARP spoofing (—Ç–æ–ª—å–∫–æ –≤ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–æ–π —Å—Ä–µ–¥–µ!)
# –û—Ç—Ä–∞–≤–∏—Ç—å –∫–µ—à –∂–µ—Ä—Ç–≤—ã (192.168.1.10), –≥–æ–≤–æ—Ä–∏–º —á—Ç–æ –º—ã ‚Äî —à–ª—é–∑ (192.168.1.1)
sudo arpspoof -i eth0 -t 192.168.1.10 192.168.1.1
# –í –¥—Ä—É–≥–æ–º –æ–∫–Ω–µ ‚Äî –æ–±—Ä–∞—Ç–Ω–æ–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
sudo arpspoof -i eth0 -t 192.168.1.1 192.168.1.10
# –í–∫–ª—é—á–∏—Ç—å IP-forwarding —á—Ç–æ–±—ã —Ç—Ä–∞—Ñ–∏–∫ –ø—Ä–æ—Ö–æ–¥–∏–ª —á–µ—Ä–µ–∑ –Ω–∞—Å
echo 1 | sudo tee /proc/sys/net/ipv4/ip_forward
```

**–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ ARP spoofing:**

```bash
# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ ARP-—Ç—Ä–∞—Ñ–∏–∫–∞
sudo tcpdump -i eth0 arp

# –ü—Ä–∏–∑–Ω–∞–∫–∏ –∞—Ç–∞–∫–∏ –≤ Wireshark:
# - –û–¥–∏–Ω MAC –∑–∞—è–≤–ª—è–µ—Ç –æ –¥–≤—É—Ö —Ä–∞–∑–Ω—ã—Ö IP
# - Gratuitous ARP –¥–ª—è —à–ª—é–∑–∞ –æ—Ç –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ–≥–æ MAC
# - –ß–∞—Å—Ç—ã–µ ARP-–æ—Ç–≤–µ—Ç—ã –±–µ–∑ –∑–∞–ø—Ä–æ—Å–æ–≤

# Wireshark —Ñ–∏–ª—å—Ç—Ä:
# arp.duplicate-address-detected
# arp.opcode == 2 && arp.src.proto_ipv4 == 192.168.1.1

# –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç arpwatch (Linux) ‚Äî –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏–∑–º–µ–Ω–µ–Ω–∏–π ARP
sudo apt-get install arpwatch
sudo arpwatch -i eth0
# –õ–æ–≥–∏—Ä—É–µ—Ç: –Ω–æ–≤—ã–µ MAC/IP –ø–∞—Ä—ã, –∏–∑–º–µ–Ω–µ–Ω–∏—è, —Ñ–ª–∏–ø—ã
```

**–ó–∞—â–∏—Ç–∞ –æ—Ç ARP Spoofing:**
- **Dynamic ARP Inspection (DAI)** –Ω–∞ —É–ø—Ä–∞–≤–ª—è–µ–º—ã—Ö –∫–æ–º–º—É—Ç–∞—Ç–æ—Ä–∞—Ö
- –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ ARP-–∑–∞–ø–∏—Å–∏ –¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤
- VLAN-—Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—è (—É–º–µ–Ω—å—à–µ–Ω–∏–µ broadcast-–¥–æ–º–µ–Ω–∞)
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å arpwatch
- –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ —Ç—Ä–∞—Ñ–∏–∫–∞ (VPN, TLS) ‚Äî –¥–∞–∂–µ –ø—Ä–∏ MitM –¥–∞–Ω–Ω—ã–µ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã

---

## 1.3.2 DHCP: Dynamic Host Configuration Protocol

### –ó–∞—á–µ–º –Ω—É–∂–µ–Ω DHCP?

–ë–µ–∑ DHCP –∫–∞–∂–¥–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –≤ —Å–µ—Ç–∏ –Ω—É–∂–Ω–æ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å –≤—Ä—É—á–Ω—É—é:
- IP-–∞–¥—Ä–µ—Å
- –ú–∞—Å–∫–∞ –ø–æ–¥—Å–µ—Ç–∏
- –®–ª—é–∑ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
- DNS-—Å–µ—Ä–≤–µ—Ä—ã

DHCP –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä—É–µ—Ç —ç—Ç–æ –∏ —É–ø—Ä–∞–≤–ª—è–µ—Ç –ø—É–ª–æ–º –∞–¥—Ä–µ—Å–æ–≤.

### –ü—Ä–æ—Ü–µ—Å—Å DORA

**DORA = Discover ‚Üí Offer ‚Üí Request ‚Üí Acknowledge**

```
–ö–ª–∏–µ–Ω—Ç                                         DHCP-—Å–µ—Ä–≤–µ—Ä
  ‚îÇ                                               ‚îÇ
  ‚îÇ  1. DHCPDISCOVER                              ‚îÇ
  ‚îÇ  Broadcast: ¬´–ï—Å—Ç—å –ª–∏ —Ç—É—Ç DHCP-—Å–µ—Ä–≤–µ—Ä?         ‚îÇ
  ‚îÇ  –ú–Ω–µ –Ω—É–∂–µ–Ω IP-–∞–¥—Ä–µ—Å!¬ª                         ‚îÇ
  ‚îÇ  src: 0.0.0.0:68  dst: 255.255.255.255:67     ‚îÇ
  ‚îÇ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∫‚îÇ
  ‚îÇ                                               ‚îÇ
  ‚îÇ               2. DHCPOFFER                    ‚îÇ
  ‚îÇ  ¬´–ú–æ–≥—É –ø—Ä–µ–¥–ª–æ–∂–∏—Ç—å —Ç–µ–±–µ 192.168.1.100          ‚îÇ
  ‚îÇ   –ú–∞—Å–∫–∞: 255.255.255.0                        ‚îÇ
  ‚îÇ   –®–ª—é–∑: 192.168.1.1                          ‚îÇ
  ‚îÇ   DNS: 8.8.8.8                               ‚îÇ
  ‚îÇ   –ê—Ä–µ–Ω–¥–∞: 86400 —Å–µ–∫ (24 —á–∞—Å–∞)¬ª               ‚îÇ
  ‚îÇ ‚óÑ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ ‚îÇ
  ‚îÇ                                               ‚îÇ
  ‚îÇ  3. DHCPREQUEST                               ‚îÇ
  ‚îÇ  Broadcast: ¬´–ü—Ä–∏–Ω–∏–º–∞—é –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ!            ‚îÇ
  ‚îÇ  –•–æ—á—É 192.168.1.100 –æ—Ç DHCP-—Å–µ—Ä–≤–µ—Ä–∞ X¬ª        ‚îÇ
  ‚îÇ  (broadcast, —á—Ç–æ–±—ã –¥—Ä—É–≥–∏–µ —Å–µ—Ä–≤–µ—Ä—ã –æ—Ç–∫–∞–∑–∞–ª–∏—Å—å) ‚îÇ
  ‚îÇ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∫‚îÇ
  ‚îÇ                                               ‚îÇ
  ‚îÇ               4. DHCPACK                      ‚îÇ
  ‚îÇ  ¬´–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–∞—é! 192.168.1.100 —Ç–≤–æ–π            ‚îÇ
  ‚îÇ   –Ω–∞ 86400 —Å–µ–∫—É–Ω–¥.¬ª                           ‚îÇ
  ‚îÇ ‚óÑ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ ‚îÇ
  ‚îÇ                                               ‚îÇ
  ‚îÇ  –ö–ª–∏–µ–Ω—Ç –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç —Å–µ—Ç–µ–≤–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å         ‚îÇ
```

**–®–∞–≥ 1 DHCPDISCOVER:**
- –ö–ª–∏–µ–Ω—Ç –Ω–µ –∏–º–µ–µ—Ç IP ‚Üí –∏—Å–ø–æ–ª—å–∑—É–µ—Ç src 0.0.0.0
- –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –Ω–∞ broadcast 255.255.255.255
- –í–∫–ª—é—á–∞–µ—Ç MAC-–∞–¥—Ä–µ—Å –∫–ª–∏–µ–Ω—Ç–∞ (client identifier)
- –ú–æ–∂–µ—Ç –∑–∞–ø—Ä–æ—Å–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π IP (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è —Ä–∞–Ω—å—à–µ)

**–®–∞–≥ 2 DHCPOFFER:**
- –°–µ—Ä–≤–µ—Ä –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç IP –∏–∑ —Å–≤–æ–µ–≥–æ –ø—É–ª–∞
- ¬´–†–µ–∑–µ—Ä–≤–∏—Ä—É–µ—Ç¬ª –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–Ω—ã–π IP (–≤—Ä–µ–º–µ–Ω–Ω–æ)
- –ï—Å–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ DHCP-—Å–µ—Ä–≤–µ—Ä–æ–≤ ‚Äî –∫–ª–∏–µ–Ω—Ç –ø–æ–ª—É—á–∏—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π

**–®–∞–≥ 3 DHCPREQUEST:**
- –ö–ª–∏–µ–Ω—Ç –≤—ã–±–∏—Ä–∞–µ—Ç –æ–¥–Ω–æ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ
- –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç broadcast (—á—Ç–æ–±—ã ¬´–æ—Ç–∫–ª–æ–Ω–∏—Ç—å¬ª –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –¥—Ä—É–≥–∏—Ö —Å–µ—Ä–≤–µ—Ä–æ–≤)
- –£–∫–∞–∑—ã–≤–∞–µ—Ç IP –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞ –≤ –æ–ø—Ü–∏–∏ ¬´Server Identifier¬ª

**–®–∞–≥ 4 DHCPACK:**
- –°–µ—Ä–≤–µ—Ä –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç –∞—Ä–µ–Ω–¥—É
- –î–æ–±–∞–≤–ª—è–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –æ–ø—Ü–∏–∏: NTP-—Å–µ—Ä–≤–µ—Ä—ã, –¥–æ–º–µ–Ω –ø–æ–∏—Å–∫–∞ –∏ —Ç.–¥.

### –ê—Ä–µ–Ω–¥–∞ DHCP (Lease)

```
–í—Ä–µ–º—è –∞—Ä–µ–Ω–¥—ã: 24 —á–∞—Å–∞ (86400 —Å–µ–∫—É–Ω–¥)

–ü—Ä–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ 50% –≤—Ä–µ–º–µ–Ω–∏ –∞—Ä–µ–Ω–¥—ã (T1):
  –ö–ª–∏–µ–Ω—Ç unicast ‚Üí DHCPREQUEST ‚Üí –°–µ—Ä–≤–µ—Ä
  –ü—Ä–æ–¥–ª–µ–Ω–∏–µ –∞—Ä–µ–Ω–¥—ã —É —Ç–æ–≥–æ –∂–µ —Å–µ—Ä–≤–µ—Ä–∞

–ü—Ä–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ 87.5% –≤—Ä–µ–º–µ–Ω–∏ –∞—Ä–µ–Ω–¥—ã (T2):
  –ö–ª–∏–µ–Ω—Ç broadcast ‚Üí DHCPREQUEST ‚Üí –õ—é–±–æ–π —Å–µ—Ä–≤–µ—Ä
  –ü–æ–ø—ã—Ç–∫–∞ –ø—Ä–æ–¥–ª–µ–Ω–∏—è —É –ª—é–±–æ–≥–æ –¥–æ—Å—Ç—É–ø–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞

–ü–æ –∏—Å—Ç–µ—á–µ–Ω–∏–∏ –∞—Ä–µ–Ω–¥—ã:
  –ö–ª–∏–µ–Ω—Ç –ø—Ä–µ–∫—Ä–∞—â–∞–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å IP
  –ù–∞—á–∏–Ω–∞–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å DORA –∑–∞–Ω–æ–≤–æ
```

### DHCP Options

DHCP –ø–µ—Ä–µ–¥–∞—ë—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —á–µ—Ä–µ–∑ –æ–ø—Ü–∏–∏:

```
–û–ø—Ü–∏—è 1:  Subnet Mask         (–º–∞—Å–∫–∞ –ø–æ–¥—Å–µ—Ç–∏)
–û–ø—Ü–∏—è 3:  Router              (—à–ª—é–∑ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
–û–ø—Ü–∏—è 6:  DNS Servers         (—Å–µ—Ä–≤–µ—Ä—ã –∏–º—ë–Ω)
–û–ø—Ü–∏—è 12: Hostname            (–∏–º—è —Ö–æ—Å—Ç–∞)
–û–ø—Ü–∏—è 15: Domain Name         (–¥–æ–º–µ–Ω–Ω–æ–µ –∏–º—è)
–û–ø—Ü–∏—è 42: NTP Servers         (—Å–µ—Ä–≤–µ—Ä—ã –≤—Ä–µ–º–µ–Ω–∏)
–û–ø—Ü–∏—è 51: Lease Time          (–≤—Ä–µ–º—è –∞—Ä–µ–Ω–¥—ã)
–û–ø—Ü–∏—è 53: DHCP Message Type   (—Ç–∏–ø —Å–æ–æ–±—â–µ–Ω–∏—è DORA)
–û–ø—Ü–∏—è 54: Server Identifier   (IP DHCP-—Å–µ—Ä–≤–µ—Ä–∞)
–û–ø—Ü–∏—è 66: TFTP Server         (–¥–ª—è PXE-–∑–∞–≥—Ä—É–∑–∫–∏)
–û–ø—Ü–∏—è 67: Boot File           (—Ñ–∞–π–ª –∑–∞–≥—Ä—É–∑–∫–∏ PXE)
```

---

### DHCP Starvation Attack

**–ü—Ä–∏–Ω—Ü–∏–ø:** –ó–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ç—ã—Å—è—á–∏ DHCPDISCOVER-–∑–∞–ø—Ä–æ—Å–æ–≤ —Å —Ä–∞–∑–Ω—ã–º–∏ –ø–æ–¥–¥–µ–ª—å–Ω—ã–º–∏ MAC-–∞–¥—Ä–µ—Å–∞–º–∏, –∏—Å—á–µ—Ä–ø—ã–≤–∞—è –≤–µ—Å—å –ø—É–ª –∞–¥—Ä–µ—Å–æ–≤ DHCP-—Å–µ—Ä–≤–µ—Ä–∞.

```
–ù–æ—Ä–º–∞–ª—å–Ω—ã–π –ø—É–ª DHCP: 192.168.1.100 ‚Äì 192.168.1.200 (100 –∞–¥—Ä–µ—Å–æ–≤)

–ê—Ç–∞–∫–∞:
  –ó–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫: DHCPDISCOVER (MAC=aa:bb:cc:00:00:01) ‚Üí IP 192.168.1.100
  –ó–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫: DHCPDISCOVER (MAC=aa:bb:cc:00:00:02) ‚Üí IP 192.168.1.101
  –ó–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫: DHCPDISCOVER (MAC=aa:bb:cc:00:00:03) ‚Üí IP 192.168.1.102
  ... (100 –∑–∞–ø—Ä–æ—Å–æ–≤)

  –ü—É–ª –∏—Å—á–µ—Ä–ø–∞–Ω!

–ù–æ–≤–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ:
  –¢–µ–ª–µ—Ñ–æ–Ω: DHCPDISCOVER ‚Üí –ù–µ—Ç –æ—Ç–≤–µ—Ç–∞ (–Ω–µ—Ç —Å–≤–æ–±–æ–¥–Ω—ã—Ö IP)
  –¢–µ–ª–µ—Ñ–æ–Ω: –ù–µ –º–æ–∂–µ—Ç –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ —Å–µ—Ç–∏!
```

**–î–≤–æ–π–Ω–∞—è –∞—Ç–∞–∫–∞:** –ü–æ—Å–ª–µ starvation –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ –∑–∞–ø—É—Å–∫–∞–µ—Ç **Rogue DHCP Server**:
```
–ó–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è DHCP-—Å–µ—Ä–≤–µ—Ä–æ–º.
–ù–æ–≤—ã–º –∫–ª–∏–µ–Ω—Ç–∞–º –≤—ã–¥–∞—ë—Ç:
  - –®–ª—é–∑ = IP –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫–∞ (MitM!)
  - DNS = IP –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫–∞ (DNS spoofing!)
```

**–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç:** `yersinia -G` (GUI), `dhcpstarv`

**–ó–∞—â–∏—Ç–∞:**
- **DHCP Snooping** –Ω–∞ –∫–æ–º–º—É—Ç–∞—Ç–æ—Ä–∞—Ö ‚Äî —Ä–∞–∑—Ä–µ—à–∞–µ—Ç DHCP-–æ—Ç–≤–µ—Ç—ã —Ç–æ–ª—å–∫–æ —Å –¥–æ–≤–µ—Ä–µ–Ω–Ω—ã—Ö –ø–æ—Ä—Ç–æ–≤
- Port Security ‚Äî –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ MAC-–∞–¥—Ä–µ—Å–æ–≤ –Ω–∞ –ø–æ—Ä—Ç—É
- 802.1X –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ DHCP-–ª–æ–≥–æ–≤

---

## 1.3.3 NAT: Network Address Translation

### –ó–∞—á–µ–º –Ω—É–∂–µ–Ω NAT?

IPv4-–∞–¥—Ä–µ—Å–æ–≤ –≤—Å–µ–≥–æ ~4.3 –º–∏–ª–ª–∏–∞—Ä–¥–∞, –∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –≤ –º–∏—Ä–µ ‚Äî –º–∏–ª–ª–∏–∞—Ä–¥—ã. NAT –ø–æ–∑–≤–æ–ª—è–µ—Ç –º–Ω–æ–∂–µ—Å—Ç–≤—É —É—Å—Ç—Ä–æ–π—Å—Ç–≤ —Å —á–∞—Å—Ç–Ω—ã–º–∏ IP –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–¥–∏–Ω –ø—É–±–ª–∏—á–Ω—ã–π IP –¥–ª—è –≤—ã—Ö–æ–¥–∞ –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç.

```
–ë–µ–∑ NAT: –∫–∞–∂–¥–æ–º—É —É—Å—Ç—Ä–æ–π—Å—Ç–≤—É –Ω—É–∂–µ–Ω —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –ø—É–±–ª–∏—á–Ω—ã–π IP
–° NAT:   –≤–µ—Å—å –æ—Ñ–∏—Å (1000 –ü–ö) –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –æ–¥–∏–Ω –ø—É–±–ª–∏—á–Ω—ã–π IP
```

### Static NAT (1:1 NAT)

–û–¥–∏–Ω —á–∞—Å—Ç–Ω—ã–π IP –ø–æ—Å—Ç–æ—è–Ω–Ω–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –æ–¥–Ω–æ–º—É –ø—É–±–ª–∏—á–Ω–æ–º—É IP.

```
–¢–∞–±–ª–∏—Ü–∞ Static NAT:
  –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π IP    –í–Ω–µ—à–Ω–∏–π IP
  10.0.0.10   ‚Üî   203.0.113.10   (–≤–µ–±-—Å–µ—Ä–≤–µ—Ä)
  10.0.0.11   ‚Üî   203.0.113.11   (–ø–æ—á—Ç–æ–≤—ã–π —Å–µ—Ä–≤–µ—Ä)
  10.0.0.12   ‚Üî   203.0.113.12   (FTP-—Å–µ—Ä–≤–µ—Ä)

–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ: —Å–µ—Ä–≤–µ—Ä—ã, –∫ –∫–æ—Ç–æ—Ä—ã–º –Ω—É–∂–µ–Ω –ø–æ—Å—Ç–æ—è–Ω–Ω—ã–π –≤–Ω–µ—à–Ω–∏–π –¥–æ—Å—Ç—É–ø
```

### Dynamic NAT

–ü—É–ª –ø—É–±–ª–∏—á–Ω—ã—Ö IP –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –Ω–∞–∑–Ω–∞—á–∞–µ—Ç—Å—è —á–∞—Å—Ç–Ω—ã–º IP.

```
–ü—É–ª –ø—É–±–ª–∏—á–Ω—ã—Ö IP: 203.0.113.1 ‚Äì 203.0.113.10 (10 –∞–¥—Ä–µ—Å–æ–≤)
–í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è —Å–µ—Ç—å: 10.0.0.0/24 (254 —Ö–æ—Å—Ç–∞)

–ö–æ–≥–¥–∞ 10.0.0.50 –≤—ã—Ö–æ–¥–∏—Ç –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç ‚Üí –ø–æ–ª—É—á–∞–µ—Ç 203.0.113.3
–ö–æ–≥–¥–∞ 10.0.0.51 –≤—ã—Ö–æ–¥–∏—Ç –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç ‚Üí –ø–æ–ª—É—á–∞–µ—Ç 203.0.113.4
...
–ï—Å–ª–∏ –≤—Å–µ 10 –∞–¥—Ä–µ—Å–æ–≤ –∑–∞–Ω—è—Ç—ã ‚Üí –æ—Å—Ç–∞–ª—å–Ω—ã–µ –∂–¥—É—Ç

–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ: –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –º–æ–≥—É—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Ç–æ–ª—å–∫–æ 10 —É—Å—Ç—Ä–æ–π—Å—Ç–≤!
```

### PAT ‚Äî Port Address Translation (NAT Overload)

–°–∞–º—ã–π —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—ë–Ω–Ω—ã–π —Ç–∏–ø NAT. –û–¥–∏–Ω –ø—É–±–ª–∏—á–Ω—ã–π IP –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Ç—ã—Å—è—á —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π —á–µ—Ä–µ–∑ —Ä–∞–∑–Ω—ã–µ –ø–æ—Ä—Ç—ã.

```
–¢–∞–±–ª–∏—Ü–∞ —Ç—Ä–∞–Ω—Å–ª—è—Ü–∏–∏ PAT:
  –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π           –í–Ω–µ—à–Ω–∏–π              –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ
  10.0.0.10:5001  ‚Üî   203.0.113.1:1025  ‚Üí  8.8.8.8:80
  10.0.0.10:5002  ‚Üî   203.0.113.1:1026  ‚Üí  142.250.185.238:443
  10.0.0.11:3000  ‚Üî   203.0.113.1:1027  ‚Üí  8.8.8.8:80
  10.0.0.12:8080  ‚Üî   203.0.113.1:1028  ‚Üí  151.101.1.140:443

–í—Å–µ 10.0.0.x ‚Üí –æ–¥–∏–Ω IP 203.0.113.1, —Ä–∞–∑–ª–∏—á–∞—é—Ç—Å—è –ø–æ –ø–æ—Ä—Ç—É –∏—Å—Ç–æ—á–Ω–∏–∫–∞!
```

**–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç PAT:**

```
–ò—Å—Ö–æ–¥—è—â–∏–π –ø–∞–∫–µ—Ç:
  src: 10.0.0.10:5001  dst: 8.8.8.8:80
       ‚Üì NAT-—Ä–æ—É—Ç–µ—Ä –º–µ–Ω—è–µ—Ç src
  src: 203.0.113.1:1025  dst: 8.8.8.8:80

–í—Ö–æ–¥—è—â–∏–π –æ—Ç–≤–µ—Ç:
  src: 8.8.8.8:80  dst: 203.0.113.1:1025
       ‚Üì NAT-—Ä–æ—É—Ç–µ—Ä —Å–º–æ—Ç—Ä–∏—Ç —Ç–∞–±–ª–∏—Ü—É, –º–µ–Ω—è–µ—Ç dst
  src: 8.8.8.8:80  dst: 10.0.0.10:5001
```

**–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è NAT:**
- –ù–∞—Ä—É—à–∞–µ—Ç end-to-end –ø—Ä–∏–Ω—Ü–∏–ø –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞
- –ü—Ä–æ—Ç–æ–∫–æ–ª—ã, –≤—Å—Ç—Ä–∞–∏–≤–∞—é—â–∏–µ IP –≤ –¥–∞–Ω–Ω—ã–µ (FTP, SIP, H.323), —Ç—Ä–µ–±—É—é—Ç ALG (Application Layer Gateway)
- –í—Ö–æ–¥—è—â–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –Ω–µ–≤–æ–∑–º–æ–∂–Ω—ã –±–µ–∑ Port Forwarding
- –ó–∞—Ç—Ä—É–¥–Ω—è–µ—Ç —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫—É (–æ–¥–∏–Ω –ø—É–±–ª–∏—á–Ω—ã–π IP = —Ç—ã—Å—è—á–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π)

### Port Forwarding (DNAT)

–ü–æ–∑–≤–æ–ª—è–µ—Ç –ø—Ä–∏–Ω–∏–º–∞—Ç—å –≤—Ö–æ–¥—è—â–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —á–µ—Ä–µ–∑ NAT:

```
–ó–∞–ø—Ä–æ—Å —Å–Ω–∞—Ä—É–∂–∏: src: 1.2.3.4  dst: 203.0.113.1:80
       ‚Üì DNAT: –º–µ–Ω—è–µ–º dst
–ü–µ—Ä–µ–∞–¥—Ä–µ—Å–∞—Ü–∏—è:  src: 1.2.3.4  dst: 10.0.0.10:80

–¢–∞–±–ª–∏—Ü–∞ Port Forwarding:
  203.0.113.1:80  ‚Üí 10.0.0.10:80   (–≤–µ–±-—Å–µ—Ä–≤–µ—Ä)
  203.0.113.1:22  ‚Üí 10.0.0.11:22   (SSH-—Å–µ—Ä–≤–µ—Ä)
  203.0.113.1:443 ‚Üí 10.0.0.10:443  (HTTPS)
```

---

## 1.3.4 –ö–ª—é—á–µ–≤—ã–µ –ø–æ—Ä—Ç—ã –Ω–∞–∏–∑—É—Å—Ç—å

–ó–Ω–∞–Ω–∏–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö –ø–æ—Ä—Ç–æ–≤ ‚Äî —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —Å–µ—Ç–µ–≤–æ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞, –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ñ–∞–π—Ä–≤–æ–ª–æ–≤ –∏ –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è –ø–µ–Ω—Ç–µ—Å—Ç–∞.

### –ü–æ—Ä—Ç—ã 0-1023 (Well-Known Ports)

–ù–∞–∑–Ω–∞—á–∞—é—Ç—Å—è IANA, —Ç—Ä–µ–±—É—é—Ç –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π root/administrator:

```
–ü–æ—Ä—Ç   –ü—Ä–æ—Ç–æ–∫–æ–ª   –¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç   –û–ø–∏—Å–∞–Ω–∏–µ
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
20     FTP-DATA   TCP         FTP ‚Äî –ø–µ—Ä–µ–¥–∞—á–∞ –¥–∞–Ω–Ω—ã—Ö
21     FTP        TCP         FTP ‚Äî —É–ø—Ä–∞–≤–ª—è—é—â–µ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ
22     SSH        TCP         Secure Shell ‚Äî —à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π —É–¥–∞–ª—ë–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø
23     Telnet     TCP         Telnet ‚Äî —É–¥–∞–ª—ë–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø (–æ—Ç–∫—Ä—ã—Ç—ã–π —Ç–µ–∫—Å—Ç!)
25     SMTP       TCP         –û—Ç–ø—Ä–∞–≤–∫–∞ —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ–π –ø–æ—á—Ç—ã
53     DNS        UDP/TCP     –°–∏—Å—Ç–µ–º–∞ –¥–æ–º–µ–Ω–Ω—ã—Ö –∏–º—ë–Ω
67     DHCP       UDP         DHCP-—Å–µ—Ä–≤–µ—Ä (–ø–æ–ª—É—á–∞–µ—Ç –∑–∞–ø—Ä–æ—Å—ã –∫–ª–∏–µ–Ω—Ç–æ–≤)
68     DHCP       UDP         DHCP-–∫–ª–∏–µ–Ω—Ç (–æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∑–∞–ø—Ä–æ—Å—ã)
69     TFTP       UDP         Trivial FTP ‚Äî –ø—Ä–æ—Å—Ç–∞—è –ø–µ—Ä–µ–¥–∞—á–∞ —Ñ–∞–π–ª–æ–≤
80     HTTP       TCP         –í–µ–± (–æ—Ç–∫—Ä—ã—Ç—ã–π —Ç–µ–∫—Å—Ç)
110    POP3       TCP         –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ—á—Ç—ã (Post Office Protocol v3)
111    RPC        TCP/UDP     Remote Procedure Call / Portmapper
119    NNTP       TCP         –°–µ—Ç–µ–≤—ã–µ –Ω–æ–≤–æ—Å—Ç–∏ (Usenet)
123    NTP        UDP         –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –≤—Ä–µ–º–µ–Ω–∏
135    RPC/DCOM   TCP         Windows RPC
137    NetBIOS    UDP         NetBIOS Name Service
138    NetBIOS    UDP         NetBIOS Datagram
139    NetBIOS    TCP         NetBIOS Session
143    IMAP       TCP         –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ—á—Ç—ã (Internet Message Access Protocol)
161    SNMP       UDP         –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–µ—Ç–∏ (Simple Network Management Protocol)
162    SNMP Trap  UDP         SNMP —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
389    LDAP       TCP/UDP     –°–ª—É–∂–±–∞ –∫–∞—Ç–∞–ª–æ–≥–æ–≤ (Active Directory)
443    HTTPS      TCP         –í–µ–± —Å —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ–º TLS
445    SMB        TCP         Windows File Sharing (Server Message Block)
465    SMTPS      TCP         SMTP —Å TLS (—É—Å—Ç–∞—Ä–µ–≤—à–∏–π)
514    Syslog     UDP         –ñ—É—Ä–Ω–∞–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π
587    SMTP       TCP         SMTP —Å STARTTLS (–æ—Ç–ø—Ä–∞–≤–∫–∞ –ø–æ—á—Ç—ã)
636    LDAPS      TCP         LDAP —Å TLS
```

### –ü–æ—Ä—Ç—ã 1024-49151 (Registered Ports)

```
–ü–æ—Ä—Ç    –ü—Ä–æ—Ç–æ–∫–æ–ª   –¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç   –û–ø–∏—Å–∞–Ω–∏–µ
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
1433    MSSQL      TCP         Microsoft SQL Server
1521    Oracle DB  TCP         Oracle Database
1723    PPTP       TCP         Point-to-Point Tunneling Protocol
2181    ZooKeeper  TCP         Apache ZooKeeper (–∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—è)
2375    Docker     TCP         Docker daemon (–Ω–µ–∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π!)
2376    Docker TLS TCP         Docker daemon (TLS)
3306    MySQL      TCP         MySQL / MariaDB
3389    RDP        TCP         Remote Desktop Protocol (Windows)
4444    Metasploit TCP         Metasploit default listener (!!!)
5000    Flask/     TCP         Python Flask dev server, Docker Registry
5432    PostgreSQL TCP         PostgreSQL
5672    AMQP       TCP         RabbitMQ
5900    VNC        TCP         Virtual Network Computing (—É–¥–∞–ª—ë–Ω–Ω—ã–π —Ä–∞–±–æ—á–∏–π —Å—Ç–æ–ª)
6379    Redis      TCP         Redis in-memory database
6443    Kubernetes TCP         Kubernetes API Server
8080    HTTP-alt   TCP         –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π HTTP (–ø—Ä–æ–∫—Å–∏, dev-—Å–µ—Ä–≤–µ—Ä—ã)
8443    HTTPS-alt  TCP         –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π HTTPS
8888    Jupyter    TCP         Jupyter Notebook
9090    Prometheus TCP         Prometheus –º–µ—Ç—Ä–∏–∫–∏
9200    Elastic    TCP         Elasticsearch HTTP API
9300    Elastic    TCP         Elasticsearch –∫–ª–∞—Å—Ç–µ—Ä
27017   MongoDB    TCP         MongoDB
27018   MongoDB    TCP         MongoDB shard
50000   Jenkins    TCP         Jenkins CI/CD
```

### –ú–Ω–µ–º–æ–Ω–∏–∫–∞ –¥–ª—è –∑–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –∫–ª—é—á–µ–≤—ã—Ö –ø–æ—Ä—Ç–æ–≤

```
"20/21 ‚Äî FTP –¥–≤–æ–π–Ω–∏–∫,
 22 ‚Äî SSH –±–µ–∑–æ–ø–∞—Å–µ–Ω, –Ω–∞—à –∑–∞—â–∏—Ç–Ω–∏–∫,
 23 ‚Äî Telnet —É–∂–∞—Å–µ–Ω, –≤—Å–µ –ø–∞—Ä–æ–ª–∏ –≤–∏–¥–Ω—ã,
 25 ‚Äî –ø–∏—Å—å–º–∞ SMTP —à–ª—ë—Ç –±–µ–∑ –ø—Ä–µ–≥—Ä–∞–¥—ã,
 53 ‚Äî DNS –ø–æ–¥—Å–∫–∞–∂–µ—Ç –∞–¥—Ä–µ—Å–∞,
 67/68 ‚Äî DHCP —Ä–∞–∑–¥–∞—ë—Ç –ø—Ä–∞–≤–∞,
 80 ‚Äî HTTP –≤—Å–µ–º—É –º–∏—Ä—É –æ—Ç–∫—Ä—ã—Ç,
 443 ‚Äî HTTPS —Å–µ–∫—Ä–µ—Ç—ã —Ö—Ä–∞–Ω–∏—Ç!"
```

---

## 1.3.5 –û–ø–∞—Å–Ω—ã–µ –ø—Ä–æ—Ç–æ–∫–æ–ª—ã

### Telnet (–ø–æ—Ä—Ç 23) ‚Äî –ö–†–ò–¢–ò–ß–ï–°–ö–ò –û–ü–ê–°–ï–ù

Telnet –ø–µ—Ä–µ–¥–∞—ë—Ç –í–°–Å –≤ –æ—Ç–∫—Ä—ã—Ç–æ–º —Ç–µ–∫—Å—Ç–µ: –ª–æ–≥–∏–Ω—ã, –ø–∞—Ä–æ–ª–∏, –∫–æ–º–∞–Ω–¥—ã, –≤—ã–≤–æ–¥.

```bash
# –ï—Å–ª–∏ –ø–µ—Ä–µ—Ö–≤–∞—Ç–∏—Ç—å Telnet-—Å–µ—Å—Å–∏—é –≤ Wireshark:
# –í–∏–¥–Ω–æ –±—É–∫–≤–∞–ª—å–Ω–æ –≤—Å—ë, –≤–∫–ª—é—á–∞—è –ø–∞—Ä–æ–ª–∏!

# –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –≤ Wireshark:
# –§–∏–ª—å—Ç—Ä: telnet
# Follow TCP Stream ‚Üí –≤—Å—ë —á–∏—Ç–∞–µ–º–æ

# –í—ã–≤–æ–¥ tcpdump –ø—Ä–∏ Telnet:
# 14:32:01 login: admin
# 14:32:05 Password: supersecret123
```

**–ß—Ç–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤–º–µ—Å—Ç–æ:** SSH (–ø–æ—Ä—Ç 22)

**–ì–¥–µ –µ—â—ë –≤—Å—Ç—Ä–µ—á–∞–µ—Ç—Å—è Telnet:**
- –°—Ç–∞—Ä–æ–µ —Å–µ—Ç–µ–≤–æ–µ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ (—Ä–æ—É—Ç–µ—Ä—ã, –∫–æ–º–º—É—Ç–∞—Ç–æ—Ä—ã Cisco –¥–æ 2000-—Ö)
- –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã (IoT)
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ—Ä—Ç–æ–≤: `telnet hostname port` (–ø—Ä–æ–≤–µ—Ä–∏—Ç—å –æ—Ç–∫—Ä—ã—Ç–æ—Å—Ç—å –ø–æ—Ä—Ç–∞)

---

### FTP (–ø–æ—Ä—Ç—ã 20/21) ‚Äî –û–ü–ê–°–ï–ù

FTP –ø–µ—Ä–µ–¥–∞—ë—Ç —É—á—ë—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏ —Ñ–∞–π–ª—ã –≤ –æ—Ç–∫—Ä—ã—Ç–æ–º —Ç–µ–∫—Å—Ç–µ.

```
–†–µ–∂–∏–º—ã FTP:
  –ê–∫—Ç–∏–≤–Ω—ã–π (Active): –∫–ª–∏–µ–Ω—Ç –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –ø–æ—Ä—Ç, —Å–µ—Ä–≤–µ—Ä –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ –Ω–µ–º—É
    –°–µ—Ä–≤–µ—Ä 21 ‚Üê –ö–ª–∏–µ–Ω—Ç —Å–ª—É—á–∞–π–Ω—ã–π –ø–æ—Ä—Ç (—É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ)
    –°–µ—Ä–≤–µ—Ä 20 ‚Üí –ö–ª–∏–µ–Ω—Ç —Å–ª—É—á–∞–π–Ω—ã–π –ø–æ—Ä—Ç (–¥–∞–Ω–Ω—ã–µ)
    –ü—Ä–æ–±–ª–µ–º–∞: —Ñ–∞–π—Ä–≤–æ–ª –∫–ª–∏–µ–Ω—Ç–∞ –±–ª–æ–∫–∏—Ä—É–µ—Ç –≤—Ö–æ–¥—è—â–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è

  –ü–∞—Å—Å–∏–≤–Ω—ã–π (Passive/PASV): –∫–ª–∏–µ–Ω—Ç –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É –Ω–∞ –æ–±–∞ –ø–æ—Ä—Ç–∞
    –ö–ª–∏–µ–Ω—Ç ‚Üí –°–µ—Ä–≤–µ—Ä 21 (—É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ)
    –ö–ª–∏–µ–Ω—Ç ‚Üí –°–µ—Ä–≤–µ—Ä —Å–ª—É—á–∞–π–Ω—ã–π –ø–æ—Ä—Ç >1023 (–¥–∞–Ω–Ω—ã–µ)
    –õ—É—á—à–µ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å NAT –∏ —Ñ–∞–π—Ä–≤–æ–ª–∞–º–∏
```

```bash
# –ü–µ—Ä–µ—Ö–≤–∞—Ç FTP –≤ Wireshark:
# –§–∏–ª—å—Ç—Ä: ftp
# –í–∏–¥–Ω–æ: USER admin, PASS mysecret, LIST (–∫–æ–º–∞–Ω–¥—ã), —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–æ–≤

# –ë–µ–∑–æ–ø–∞—Å–Ω—ã–µ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã:
# SFTP (SSH File Transfer Protocol) ‚Äî –ø–æ—Ä—Ç 22, —à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π
# FTPS (FTP over SSL/TLS) ‚Äî –ø–æ—Ä—Ç 990 –∏–ª–∏ STARTTLS –Ω–∞ 21
# SCP (Secure Copy) ‚Äî –ø–æ—Ä—Ç 22
```

---

### SNMP v1/v2c ‚Äî –û–ü–ê–°–ï–ù

SNMP (Simple Network Management Protocol) –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ —Å–µ—Ç–µ–≤—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤.

**–í–µ—Ä—Å–∏–∏:**
- SNMPv1 (1988) ‚Äî –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —Ç–æ–ª—å–∫–æ –ø–æ community string –≤ –æ—Ç–∫—Ä—ã—Ç–æ–º –≤–∏–¥–µ
- SNMPv2c (1993) ‚Äî —É–ª—É—á—à–µ–Ω–∏—è, –Ω–æ –≤—Å—ë –µ—â—ë community string –≤ –æ—Ç–∫—Ä—ã—Ç–æ–º –≤–∏–¥–µ
- SNMPv3 (2002) ‚Äî —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

```
Community String ‚Äî —ç—Ç–æ –ø–∞—Ä–æ–ª—å SNMP.
–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é: "public" (—á—Ç–µ–Ω–∏–µ), "private" (–∑–∞–ø–∏—Å—å)

–ï—Å–ª–∏ –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ –∑–Ω–∞–µ—Ç community string:
  - –ú–æ–∂–µ—Ç —á–∏—Ç–∞—Ç—å –≤—Å—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ (OID tree)
  - –ú–æ–∂–µ—Ç –∏–∑–º–µ–Ω—è—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é (write community)
  - –ú–æ–∂–µ—Ç –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ
  - –ú–æ–∂–µ—Ç –∏–∑–≤–ª–µ—á—å –º–∞—Ä—à—Ä—É—Ç–Ω—É—é —Ç–∞–±–ª–∏—Ü—É, —Å–ø–∏—Å–æ–∫ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤, ARP-–∫–µ—à
```

```bash
# –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ SNMP (—Å Kali Linux)
nmap -sU -p 161 --script snmp-brute 192.168.1.1
nmap -sU -p 161 --script snmp-info 192.168.1.1

# –ß—Ç–µ–Ω–∏–µ SNMP –¥–∞–Ω–Ω—ã—Ö (–µ—Å–ª–∏ –∑–Ω–∞–µ–º community)
snmpwalk -v2c -c public 192.168.1.1
snmpwalk -v2c -c public 192.168.1.1 1.3.6.1.2.1.1  # —Å–∏—Å—Ç–µ–º–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

# –ó–∞—â–∏—Ç–∞:
# - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å SNMPv3 —Å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–µ–π –∏ –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç—å—é
# - –ò–∑–º–µ–Ω–∏—Ç—å community strings —Å "public"/"private"
# - –û–≥—Ä–∞–Ω–∏—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ SNMP –ø–æ IP (ACL)
# - –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –ø–æ—Ä—Ç 161/162 –Ω–∞ –ø–µ—Ä–∏–º–µ—Ç—Ä–µ
```

---

### HTTP (–ø–æ—Ä—Ç 80) ‚Äî –£–ú–ï–†–ï–ù–ù–û –û–ü–ê–°–ï–ù

HTTP –ø–µ—Ä–µ–¥–∞—ë—Ç –¥–∞–Ω–Ω—ã–µ –≤ –æ—Ç–∫—Ä—ã—Ç–æ–º –≤–∏–¥–µ. –î–ª—è —Å–∞–π—Ç–æ–≤ –±–µ–∑ –≤–≤–æ–¥–∞ –¥–∞–Ω–Ω—ã—Ö ‚Äî –ø—Ä–∏–µ–º–ª–µ–º–æ.

**–†–µ–∞–ª—å–Ω–æ –æ–ø–∞—Å–Ω–æ:**
- –§–æ—Ä–º–∞ –≤—Ö–æ–¥–∞ –ø–æ HTTP ‚Üí –ø–∞—Ä–æ–ª–∏ –≤–∏–¥–Ω—ã –≤ —Å–µ—Ç–∏
- –°–µ—Å—Å–∏–æ–Ω–Ω—ã–µ cookie –ø–æ HTTP ‚Üí –∫—Ä–∞–∂–∞ —Å–µ—Å—Å–∏–∏
- API –ø–æ HTTP ‚Üí –¥–∞–Ω–Ω—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≤–∏–¥–Ω—ã

**–°—Ç–∞–Ω–¥–∞—Ä—Ç:** –í—Å–µ–≥–¥–∞ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è—Ç—å HTTP ‚Üí HTTPS (301)

---

## üíª –ü—Ä–∞–∫—Ç–∏–∫–∞

### –ó–∞–¥–∞–Ω–∏–µ 1: –ê–Ω–∞–ª–∏–∑ ARP

```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä ARP-—Ç–∞–±–ª–∏—Ü—ã
arp -a
ip neigh show

# –†—É—á–Ω–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–æ–π ARP-–∑–∞–ø–∏—Å–∏
sudo arp -s 192.168.1.200 aa:bb:cc:dd:ee:ff
# –ò–ª–∏:
sudo ip neigh add 192.168.1.200 lladdr aa:bb:cc:dd:ee:ff dev eth0 nud static

# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ ARP –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
sudo tcpdump -i eth0 arp -v

# –ó–∞—Ö–≤–∞—Ç–∏—Ç—å –∏ –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å ARP –≤ Wireshark:
# 1. –ó–∞–ø—É—Å—Ç–∏—Ç—å Wireshark, —Ñ–∏–ª—å—Ç—Ä: arp
# 2. –í –¥—Ä—É–≥–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ: ping -c1 192.168.1.1
# 3. –£–≤–∏–¥–µ—Ç—å ARP Request (broadcast) –∏ ARP Reply
```

### –ó–∞–¥–∞–Ω–∏–µ 2: –ù–∞–±–ª—é–¥–µ–Ω–∏–µ DHCP –≤ Wireshark

```bash
# –ó–∞—Ö–≤–∞—Ç–∏—Ç—å DHCP-—Ç—Ä–∞—Ñ–∏–∫
sudo tcpdump -i eth0 port 67 or port 68 -v -w dhcp_capture.pcap

# –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å DHCP-–∞—Ä–µ–Ω–¥—É (Linux)
sudo dhclient -r eth0   # –æ—Ç–∫–∞–∑–∞—Ç—å—Å—è –æ—Ç –∞—Ä–µ–Ω–¥—ã (DHCPRELEASE)
sudo dhclient eth0      # –∑–∞–ø—Ä–æ—Å–∏—Ç—å –Ω–æ–≤—É—é –∞—Ä–µ–Ω–¥—É (DORA)

# Windows:
ipconfig /release
ipconfig /renew

# –í Wireshark –æ—Ç–∫—Ä—ã—Ç—å dhcp_capture.pcap
# –§–∏–ª—å—Ç—Ä: dhcp –∏–ª–∏ bootp
# –ù–∞–±–ª—é–¥–∞—Ç—å –≤—Å–µ 4 —à–∞–≥–∞ DORA
```

### –ó–∞–¥–∞–Ω–∏–µ 3: –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ—Ä—Ç–æ–≤ —Å nmap

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞
sudo apt-get install nmap

# –ë–∞–∑–æ–≤–æ–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ (—Ç–æ–ø-1000 –ø–æ—Ä—Ç–æ–≤)
nmap 192.168.1.1

# –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –ø–æ—Ä—Ç–æ–≤
nmap -p 22,80,443,3306 192.168.1.1

# –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö 65535 –ø–æ—Ä—Ç–æ–≤
nmap -p- 192.168.1.1

# –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–æ–≤ –∏ –≤–µ—Ä—Å–∏–π
nmap -sV 192.168.1.1

# –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –û–°
sudo nmap -O 192.168.1.1

# –ü–æ–ª–Ω—ã–π —Ä–∞–∑–≤–µ–¥—ã–≤–∞—Ç–µ–ª—å–Ω—ã–π —Å–∫–∞–Ω
sudo nmap -sV -sC -O -p- 192.168.1.1

# –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥—Å–µ—Ç–∏
nmap 192.168.1.0/24

# –°–∫—Ä—ã—Ç–Ω–æ–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ (SYN scan)
sudo nmap -sS 192.168.1.1

# UDP-—Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ (–º–µ–¥–ª–µ–Ω–Ω–µ–µ)
sudo nmap -sU 192.168.1.1

# –í—ã–≤–æ–¥ –≤ —Ñ–∞–π–ª
nmap -oN output.txt 192.168.1.1
nmap -oX output.xml 192.168.1.1  # XML
nmap -oG output.gnmap 192.168.1.1  # Grepable
```

### –ó–∞–¥–∞–Ω–∏–µ 4: –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–ø–∞—Å–Ω—ã—Ö –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–≤

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –æ—Ç–∫—Ä—ã—Ç –ª–∏ Telnet
nmap -p 23 192.168.1.1
telnet 192.168.1.1 23  # –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å FTP
nmap -p 21 192.168.1.1
nmap -sV -p 21 192.168.1.1  # –≤–µ—Ä—Å–∏—è FTP-—Å–µ—Ä–≤–µ—Ä–∞
# –ê–Ω–æ–Ω–∏–º–Ω—ã–π FTP (—á–∞—Å—Ç–æ –≤–∫–ª—é—á—ë–Ω –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é!):
ftp 192.168.1.1
# Name: anonymous
# Password: (–ø—É—Å—Ç–æ–π –∏–ª–∏ email)

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å SNMP
sudo nmap -sU -p 161 192.168.1.1
sudo nmap -sU -p 161 --script snmp-info 192.168.1.1
# –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ community strings:
sudo snmpwalk -v1 -c public 192.168.1.1 2>/dev/null || echo "No SNMP"
```

---

## üõ†Ô∏è –ó–∞–¥–∞–Ω–∏—è

### ‚≠ê –ó–∞–¥–∞–Ω–∏–µ 1 (–ë–∞–∑–æ–≤—ã–π —É—Ä–æ–≤–µ–Ω—å): –¢–∞–±–ª–∏—Ü–∞ –ø–æ—Ä—Ç–æ–≤ –∏ –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–≤

–°–æ–∑–¥–∞–π—Ç–µ —Ç–∞–±–ª–∏—Ü—É (Excel, Markdown, –∏–ª–∏ –æ—Ç —Ä—É–∫–∏) —Å–æ —Å–ª–µ–¥—É—é—â–∏–º–∏ —Å—Ç–æ–ª–±—Ü–∞–º–∏:
- –ù–æ–º–µ—Ä –ø–æ—Ä—Ç–∞
- –ü—Ä–æ—Ç–æ–∫–æ–ª
- –¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç (TCP/UDP)
- –û–ø–∏—Å–∞–Ω–∏–µ
- –û–ø–∞—Å–Ω–æ—Å—Ç—å (–±–µ–∑–æ–ø–∞—Å–Ω—ã–π/–æ–ø–∞—Å–Ω—ã–π/–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –æ–ø–∞—Å–Ω—ã–π)
- –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ (–µ—Å–ª–∏ –µ—Å—Ç—å)

–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –¥–ª—è –≤—Å–µ—Ö –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–≤ –∏–∑ —ç—Ç–æ–π –≥–ª–∞–≤—ã (–º–∏–Ω–∏–º—É–º 20 –ø–æ—Ä—Ç–æ–≤).

–ó–∞–ø–æ–º–Ω–∏—Ç–µ —Å–ª–µ–¥—É—é—â–∏–µ –ø–æ—Ä—Ç—ã –±–µ–∑ –ø–æ–¥—Å–∫–∞–∑–∫–∏:
`20, 21, 22, 23, 25, 53, 67, 68, 80, 110, 143, 443, 445, 3306, 3389, 5432, 6379, 8080`

---

### ‚≠ê‚≠ê –ó–∞–¥–∞–Ω–∏–µ 2 (–°—Ä–µ–¥–Ω–∏–π —É—Ä–æ–≤–µ–Ω—å): –ê–Ω–∞–ª–∏–∑ ARP-—Ç—Ä–∞—Ñ–∏–∫–∞

1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ Wireshark –Ω–∞ —Å–≤–æ–µ–π –º–∞—à–∏–Ω–µ
2. –ü—Ä–∏–º–µ–Ω–∏—Ç–µ —Ñ–∏–ª—å—Ç—Ä `arp`
3. –í—ã–ø–æ–ª–Ω–∏—Ç–µ `ping -c3 8.8.8.8`
4. –ó–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ:
   - –ò—Å—Ö–æ–¥–Ω—ã–π –∏ —Ü–µ–ª–µ–≤–æ–π MAC-–∞–¥—Ä–µ—Å –∫–∞–∂–¥–æ–≥–æ ARP-–ø–∞–∫–µ—Ç–∞
   - –¢–∏–ø –æ–ø–µ—Ä–∞—Ü–∏–∏ (request/reply)
   - –ö—Ç–æ —É –∫–æ–≥–æ —Å–ø—Ä–∞—à–∏–≤–∞–µ—Ç MAC
5. –û—Ç–≤–µ—Ç—å—Ç–µ –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã:
   - –ü–æ—á–µ–º—É ping –∫ 8.8.8.8 –≤—ã–∑—ã–≤–∞–µ—Ç ARP-–∑–∞–ø—Ä–æ—Å –¥–ª—è –¥—Ä—É–≥–æ–≥–æ IP?
   - –ß—Ç–æ —Ç–∞–∫–æ–µ ARP –¥–ª—è —à–ª—é–∑–∞?
   - –ö–∞–∫ –∞—Ç–∞–∫—É—é—â–∏–π –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å ARP –ø—Ä–æ—Ç–∏–≤ –≤–∞—Å?
6. –ù–∞—Ä–∏—Å—É–π—Ç–µ —Å—Ö–µ–º—É –∞—Ç–∞–∫–∏ ARP spoofing —Å —É–∫–∞–∑–∞–Ω–∏–µ–º –≤—Å–µ—Ö ARP-–ø–∞–∫–µ—Ç–æ–≤

---

### ‚≠ê‚≠ê‚≠ê –ó–∞–¥–∞–Ω–∏–µ 3 (–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π —É—Ä–æ–≤–µ–Ω—å): –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –æ–ø–∞—Å–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤

1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —É—è–∑–≤–∏–º—É—é –≤–∏—Ä—Ç—É–∞–ª—å–Ω—É—é –º–∞—à–∏–Ω—É (Metasploitable 2 –∏–ª–∏ DVWA)
2. –° –ø–æ–º–æ—â—å—é nmap –ø—Ä–æ—Å–∫–∞–Ω–∏—Ä—É–π—Ç–µ –µ—ë:
```bash
sudo nmap -sV -sC -O -p- <IP-–∂–µ—Ä—Ç–≤—ã>
```
3. –°–æ—Å—Ç–∞–≤—å—Ç–µ —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –æ—Ç–∫—Ä—ã—Ç—ã—Ö –ø–æ—Ä—Ç–æ–≤ —Å:
   - –í–µ—Ä—Å–∏—è–º–∏ —Å–µ—Ä–≤–∏—Å–æ–≤
   - –û—Ü–µ–Ω–∫–æ–π —Ä–∏—Å–∫–∞ –∫–∞–∂–¥–æ–≥–æ –ø–æ—Ä—Ç–∞
   - –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º–∏ –ø–æ –∑–∞–∫—Ä—ã—Ç–∏—é/–∑–∞—â–∏—Ç–µ

4. –ù–∞–π–¥–∏—Ç–µ –≤—Å–µ –æ–ø–∞—Å–Ω—ã–µ –ø—Ä–æ—Ç–æ–∫–æ–ª—ã (Telnet, FTP —Å anonymous –¥–æ—Å—Ç—É–ø–æ–º, SNMP)
5. –î–ª—è –∫–∞–∂–¥–æ–≥–æ –æ–ø–∞—Å–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞:
   - –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∏ –∑–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ, —á—Ç–æ –≤–∏–¥–Ω–æ –∞—Ç–∞–∫—É—é—â–µ–º—É
   - –ü—Ä–µ–¥–ª–æ–∂–∏—Ç–µ –º–µ—Ä—ã –ø–æ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—é

6. –ó–∞—Ö–≤–∞—Ç–∏—Ç–µ —Ç—Ä–∞—Ñ–∏–∫ Telnet –∏–ª–∏ FTP –≤ Wireshark –∏ –ø–æ–∫–∞–∂–∏—Ç–µ –ø–µ—Ä–µ—Ö–≤–∞—á–µ–Ω–Ω—ã–µ —É—á—ë—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

> **–í–∞–∂–Ω–æ:** –≠—Ç–æ –∑–∞–¥–∞–Ω–∏–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –¢–û–õ–¨–ö–û –Ω–∞ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ!
> –ù–∏–∫–æ–≥–¥–∞ –Ω–µ —Å–∫–∞–Ω–∏—Ä—É–π—Ç–µ —á—É–∂–∏–µ —Å–∏—Å—Ç–µ–º—ã –±–µ–∑ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è!

---

## ‚úÖ –ß–µ–∫–ª–∏—Å—Ç –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏

- [ ] –Ø –º–æ–≥—É –æ–±—ä—è—Å–Ω–∏—Ç—å —Ä–∞–±–æ—Ç—É ARP (Request –∏ Reply) —Å —É–∫–∞–∑–∞–Ω–∏–µ–º MAC/IP –∞–¥—Ä–µ—Å–æ–≤
- [ ] –Ø –ø–æ–Ω–∏–º–∞—é –∞—Ç–∞–∫—É ARP Spoofing –∏ –µ—ë –ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è (MitM)
- [ ] –Ø –∑–Ω–∞—é, –∫–∞–∫ –æ–±–Ω–∞—Ä—É–∂–∏—Ç—å ARP Spoofing (arpwatch, Wireshark)
- [ ] –Ø –º–æ–≥—É –æ–ø–∏—Å–∞—Ç—å –≤—Å–µ 4 —à–∞–≥–∞ DHCP (DORA) —Å –¥–µ—Ç–∞–ª—è–º–∏ –∫–∞–∂–¥–æ–≥–æ
- [ ] –Ø –ø–æ–Ω–∏–º–∞—é –∞—Ç–∞–∫—É DHCP Starvation –∏ –∫–∞–∫ –æ—Ç –Ω–µ—ë –∑–∞—â–∏—Ç–∏—Ç—å—Å—è
- [ ] –Ø –∑–Ω–∞—é —Ä–∞–∑–Ω–∏—Ü—É –º–µ–∂–¥—É Static NAT, Dynamic NAT –∏ PAT
- [ ] –Ø –º–æ–≥—É –æ–±—ä—è—Å–Ω–∏—Ç—å, –∫–∞–∫ PAT –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ç—ã—Å—è—á–∞–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–¥–∏–Ω IP
- [ ] –Ø –∑–Ω–∞—é –Ω–∞–∏–∑—É—Å—Ç—å –ø–æ—Ä—Ç—ã: 21, 22, 23, 25, 53, 67/68, 80, 110, 143, 443, 445, 3306, 3389, 5432, 6379
- [ ] –Ø –ø–æ–Ω–∏–º–∞—é, –ø–æ—á–µ–º—É Telnet, FTP –∏ SNMPv1/v2c –æ–ø–∞—Å–Ω—ã
- [ ] –Ø —É–º–µ—é —Å–∫–∞–Ω–∏—Ä–æ–≤–∞—Ç—å –ø–æ—Ä—Ç—ã —Å –ø–æ–º–æ—â—å—é nmap –∏ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
- [ ] –Ø –º–æ–≥—É –∑–∞—Ö–≤–∞—Ç–∏—Ç—å DHCP –∏ ARP —Ç—Ä–∞—Ñ–∏–∫ –≤ Wireshark

---

## üîó –†–µ—Å—É—Ä—Å—ã

### RFC –∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç—ã
- [RFC 826 ‚Äî ARP](https://www.rfc-editor.org/rfc/rfc826)
- [RFC 2131 ‚Äî DHCP](https://www.rfc-editor.org/rfc/rfc2131)
- [RFC 3022 ‚Äî NAT](https://www.rfc-editor.org/rfc/rfc3022)
- [RFC 1157 ‚Äî SNMPv1](https://www.rfc-editor.org/rfc/rfc1157)
- [RFC 3411 ‚Äî SNMPv3 Framework](https://www.rfc-editor.org/rfc/rfc3411)

### –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã
- [nmap.org ‚Äî –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è nmap](https://nmap.org/book/man.html)
- [Wireshark Display Filters](https://wiki.wireshark.org/DisplayFilters)
- [nmap NSE scripts](https://nmap.org/nsedoc/)

### –£—á–µ–±–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã
- [IANA Port Number Registry](https://www.iana.org/assignments/service-names-port-numbers)
- [Nmap Network Scanning (–∫–Ω–∏–≥–∞ –æ–Ω–ª–∞–π–Ω)](https://nmap.org/book/toc.html)
- [Practical Packet Analysis (Wireshark)](https://nostarch.com/packetanalysis3)

### –£—è–∑–≤–∏–º—ã–µ –í–ú –¥–ª—è –ø—Ä–∞–∫—Ç–∏–∫–∏
- [Metasploitable 2](https://sourceforge.net/projects/metasploitable/)
- [VulnHub ‚Äî –∫–æ–ª–ª–µ–∫—Ü–∏—è —É—è–∑–≤–∏–º—ã—Ö –í–ú](https://www.vulnhub.com)
