# –ì–ª–∞–≤–∞ 2.2: –†–∞–±–æ—Ç–∞ —Å —Ñ–∞–π–ª–∞–º–∏: grep, awk, sed

## üéØ –¶–µ–ª–∏ –≥–ª–∞–≤—ã

- –û–≤–ª–∞–¥–µ—Ç—å –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–º grep –¥–ª—è –ø–æ–∏—Å–∫–∞ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ –≤ —Ñ–∞–π–ª–∞—Ö –∏ –ø–æ—Ç–æ–∫–∞—Ö –¥–∞–Ω–Ω—ã—Ö
- –ù–∞—É—á–∏—Ç—å—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å awk –¥–ª—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- –û—Å–≤–æ–∏—Ç—å sed –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ñ–∞–π–ª–æ–≤ –∏ –ø–æ—Ç–æ–∫–æ–≤
- –ò–∑—É—á–∏—Ç—å –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —É—Ç–∏–ª–∏—Ç—ã: cut, sort, uniq, wc, head, tail
- –ü–æ–Ω—è—Ç—å –ø—Ä–∏–Ω—Ü–∏–ø—ã –∫–æ–Ω–≤–µ–π–µ—Ä–æ–≤ (pipes) –∏ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–π –≤ Unix
- –ü—Ä–∏–º–µ–Ω—è—Ç—å –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –ª–æ–≥–æ–≤ –∏ –ø–æ–∏—Å–∫–∞ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤ –∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏–∏
- –ù–∞—É—á–∏—Ç—å—Å—è –∏–∑–≤–ª–µ–∫–∞—Ç—å IP-–∞–¥—Ä–µ—Å–∞, –∏–º–µ–Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –¥—Ä—É–≥–∏–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ –ª–æ–≥–æ–≤

---

## 2.2.1 grep ‚Äî –ø–æ–∏—Å–∫ –ø–æ —à–∞–±–ª–æ–Ω—É

`grep` (Global Regular Expression Print) ‚Äî –±–∞–∑–æ–≤—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –ø–æ–∏—Å–∫–∞ —Å—Ç—Ä–æ–∫, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö —à–∞–±–ª–æ–Ω—É. –ù–µ–∑–∞–º–µ–Ω–∏–º –ø—Ä–∏ –∞–Ω–∞–ª–∏–∑–µ –ª–æ–≥–æ–≤ –∏ —Ä–∞—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–∏ –∏–Ω—Ü–∏–¥–µ–Ω—Ç–æ–≤.

### –ë–∞–∑–æ–≤—ã–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å

```bash
grep [–æ–ø—Ü–∏–∏] –®–ê–ë–õ–û–ù [—Ñ–∞–π–ª(—ã)]

# –ü—Ä–∏–º–µ—Ä—ã:
grep "error" /var/log/syslog
grep "Failed password" /var/log/auth.log
grep "192.168.1.100" /var/log/nginx/access.log
```

### –ö–ª—é—á–µ–≤—ã–µ –æ–ø—Ü–∏–∏ grep

```bash
# -i : –ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–≥–∏—Å—Ç—Ä
grep -i "error" /var/log/syslog
grep -i "root" /etc/passwd

# -r : –†–µ–∫—É—Ä—Å–∏–≤–Ω—ã–π –ø–æ–∏—Å–∫ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
grep -r "password" /etc/
grep -r "PRIVATE KEY" /home/
grep -r "aws_secret" /var/www/

# -v : –ò–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ (–∏—Å–∫–ª—é—á–∏—Ç—å —Å—Ç—Ä–æ–∫–∏ —Å —à–∞–±–ª–æ–Ω–æ–º)
grep -v "^#" /etc/ssh/sshd_config      # –£–±—Ä–∞—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏
grep -v "^$" /etc/hosts                # –£–±—Ä–∞—Ç—å –ø—É—Å—Ç—ã–µ —Å—Ç—Ä–æ–∫–∏
cat /etc/passwd | grep -v "nologin"    # –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å –æ–±–æ–ª–æ—á–∫–æ–π

# -n : –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –Ω–æ–º–µ—Ä–∞ —Å—Ç—Ä–æ–∫
grep -n "PermitRootLogin" /etc/ssh/sshd_config

# -c : –ü–æ–¥—Å—á–∏—Ç–∞—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π
grep -c "Failed password" /var/log/auth.log

# -l : –ü–æ–∫–∞–∑–∞—Ç—å —Ç–æ–ª—å–∫–æ –∏–º–µ–Ω–∞ —Ñ–∞–π–ª–æ–≤ —Å —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è–º–∏
grep -rl "password" /etc/
grep -rl "TODO" /var/www/html/

# -L : –ü–æ–∫–∞–∑–∞—Ç—å —Ñ–∞–π–ª—ã –ë–ï–ó —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π
grep -rL "AllowUsers" /etc/ssh/

# -w : –°–æ–≤–ø–∞–¥–µ–Ω–∏–µ —Ç–æ–ª—å–∫–æ —Ü–µ–ª–æ–≥–æ —Å–ª–æ–≤–∞
grep -w "root" /etc/passwd       # –¢–æ–ª—å–∫–æ "root", –Ω–µ "rooted"

# -x : –°–æ–≤–ø–∞–¥–µ–Ω–∏–µ –≤—Å–µ–π —Å—Ç—Ä–æ–∫–∏ —Ü–µ–ª–∏–∫–æ–º
grep -x "root:x:0:0:root:/root:/bin/bash" /etc/passwd

# –ö–æ–Ω—Ç–µ–∫—Å—Ç –≤–æ–∫—Ä—É–≥ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è:
# -A n : n —Å—Ç—Ä–æ–∫ –ü–û–°–õ–ï —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è
grep -A 3 "Failed password" /var/log/auth.log

# -B n : n —Å—Ç—Ä–æ–∫ –î–û —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è
grep -B 2 "Accepted publickey" /var/log/auth.log

# -C n : n —Å—Ç—Ä–æ–∫ –î–û –∏ –ü–û–°–õ–ï
grep -C 2 "segfault" /var/log/kern.log

# –í—ã–≤–æ–¥ –±–µ–∑ –±—É—Ñ–µ—Ä–∏–∑–∞—Ü–∏–∏ (–¥–ª—è –ø–æ—Ç–æ–∫–æ–≤):
grep --line-buffered "error" /var/log/syslog

# -o : –í—ã–≤–µ—Å—Ç–∏ —Ç–æ–ª—å–∫–æ —Å–æ–≤–ø–∞–≤—à—É—é —á–∞—Å—Ç—å —Å—Ç—Ä–æ–∫–∏
grep -o "[0-9]\{1,3\}\.[0-9]\{1,3\}\.[0-9]\{1,3\}\.[0-9]\{1,3\}" /var/log/nginx/access.log

# -E : –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ —Ä–µ–≥—É–ª—è—Ä–Ω—ã–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è (–∫–∞–∫ egrep)
grep -E "error|warning|critical" /var/log/syslog

# -P : Perl-—Å–æ–≤–º–µ—Å—Ç–∏–º—ã–µ —Ä–µ–≥—É–ª—è—Ä–Ω—ã–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è (PCRE)
grep -P "(?<=from )\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}" /var/log/auth.log

# -F : –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—Ç—Ä–æ–∫–∞ (–Ω–µ —Ä–µ–≥—É–ª—è—Ä–Ω–æ–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ, –±—ã—Å—Ç—Ä–µ–µ)
grep -F "192.168.1.1" /var/log/nginx/access.log

# --color : –ü–æ–¥—Å–≤–µ—Ç–∫–∞ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π
grep --color=always "FAILED" /var/log/auth.log

# –ß—Ç–µ–Ω–∏–µ —à–∞–±–ª–æ–Ω–æ–≤ –∏–∑ —Ñ–∞–π–ª–∞:
echo -e "error\nwarning\ncritical" > patterns.txt
grep -f patterns.txt /var/log/syslog
```

### –†–µ–≥—É–ª—è—Ä–Ω—ã–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è –≤ grep

```bash
# –ë–∞–∑–æ–≤—ã–µ —Å–∏–º–≤–æ–ª—ã:
.     # –õ—é–±–æ–π –æ–¥–∏–Ω —Å–∏–º–≤–æ–ª
*     # –ù–æ–ª—å –∏–ª–∏ –±–æ–ª–µ–µ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —Å–∏–º–≤–æ–ª–∞
+     # –û–¥–∏–Ω –∏–ª–∏ –±–æ–ª–µ–µ (—Ç–æ–ª—å–∫–æ —Å -E –∏–ª–∏ -P)
?     # –ù–æ–ª—å –∏–ª–∏ –æ–¥–∏–Ω (—Ç–æ–ª—å–∫–æ —Å -E –∏–ª–∏ -P)
^     # –ù–∞—á–∞–ª–æ —Å—Ç—Ä–æ–∫–∏
$     # –ö–æ–Ω–µ—Ü —Å—Ç—Ä–æ–∫–∏
[]    # –ù–∞–±–æ—Ä —Å–∏–º–≤–æ–ª–æ–≤
[^]   # –ò—Å–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞–±–æ—Ä–∞ —Å–∏–º–≤–æ–ª–æ–≤
\     # –≠–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
|     # –ò–õ–ò (—Ç–æ–ª—å–∫–æ —Å -E)
()    # –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ (—Ç–æ–ª—å–∫–æ —Å -E)
{n,m} # –ü–æ–≤—Ç–æ—Ä–µ–Ω–∏–µ n-m —Ä–∞–∑ (—Å -E)

# –ü—Ä–∏–º–µ—Ä—ã —Å –±–∞–∑–æ–≤—ã–º–∏ —Ä–µ–≥—É–ª—è—Ä–Ω—ã–º–∏ –≤—ã—Ä–∞–∂–µ–Ω–∏—è–º–∏:
grep "^root" /etc/passwd              # –°—Ç—Ä–æ–∫–∏, –Ω–∞—á–∏–Ω–∞—é—â–∏–µ—Å—è —Å "root"
grep "bash$" /etc/passwd              # –°—Ç—Ä–æ–∫–∏, –∑–∞–∫–∞–Ω—á–∏–≤–∞—é—â–∏–µ—Å—è –Ω–∞ "bash"
grep "^#" /etc/ssh/sshd_config        # –°—Ç—Ä–æ–∫–∏-–∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏
grep "^$" file.txt                    # –ü—É—Å—Ç—ã–µ —Å—Ç—Ä–æ–∫–∏
grep "[0-9]\{4\}" file.txt           # –ß–µ—Ç—ã—Ä–µ —Ü–∏—Ñ—Ä—ã –ø–æ–¥—Ä—è–¥
grep "[A-Z]" /etc/passwd              # –°—Ç—Ä–æ–∫–∏ —Å –∑–∞–≥–ª–∞–≤–Ω—ã–º–∏ –±—É–∫–≤–∞–º–∏

# –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ —Ä–µ–≥—É–ª—è—Ä–Ω—ã–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è (-E):
grep -E "^(root|admin|user)" /etc/passwd       # –ù–µ—Å–∫–æ–ª—å–∫–æ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –≤ –Ω–∞—á–∞–ª–µ
grep -E "[0-9]{1,3}\.[0-9]{1,3}" file.txt      # IP-–ø–æ–¥–æ–±–Ω—ã–π –ø–∞—Ç—Ç–µ—Ä–Ω
grep -E "https?://[^\s]+" file.txt             # URL
grep -E "\b(password|passwd|pwd)\b" -i file.txt # –°–ª–æ–≤–∞ –æ –ø–∞—Ä–æ–ª—è—Ö

# PCRE (-P) ‚Äî –Ω–∞–∏–±–æ–ª–µ–µ –º–æ—â–Ω—ã–µ:
grep -P "\b(?:\d{1,3}\.){3}\d{1,3}\b" access.log   # –¢–æ—á–Ω—ã–π IP
grep -P "(?<=user=)\w+" auth.log                     # Lookahead/lookbehind
grep -P "[\x80-\xFF]" file.txt                       # –ù–æ–Ω-ASCII —Å–∏–º–≤–æ–ª—ã
```

### grep –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –ª–æ–≥–æ–≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

```bash
# === –ê–ù–ê–õ–ò–ó /var/log/auth.log ===

# –ù–µ—É–¥–∞—á–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏ –≤—Ö–æ–¥–∞:
grep "Failed password" /var/log/auth.log

# –£—Å–ø–µ—à–Ω—ã–µ –≤—Ö–æ–¥—ã:
grep "Accepted password\|Accepted publickey" /var/log/auth.log

# –ü–æ–ø—ã—Ç–∫–∏ –≤—Ö–æ–¥–∞ –¥–ª—è –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:
grep "Invalid user" /var/log/auth.log

# –ë—Ä—É—Ç—Ñ–æ—Ä—Å: IP —Å –º–Ω–æ–≥–æ—á–∏—Å–ª–µ–Ω–Ω—ã–º–∏ –Ω–µ—É–¥–∞—á–∞–º–∏:
grep "Failed password" /var/log/auth.log | \
    grep -oE "[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}" | \
    sort | uniq -c | sort -rn | head -20

# –ü–æ–ø—ã—Ç–∫–∏ sudo:
grep "sudo" /var/log/auth.log

# –ü–æ–≤—ã—à–µ–Ω–∏–µ –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π:
grep "su\[" /var/log/auth.log

# –ù–æ–≤—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏:
grep "useradd\|adduser" /var/log/auth.log

# === –ê–ù–ê–õ–ò–ó NGINX –õ–û–ì–û–í ===

# –ó–∞–ø—Ä–æ—Å—ã —Å –∫–æ–¥–æ–º 4xx/5xx:
grep -E " (4[0-9]{2}|5[0-9]{2}) " /var/log/nginx/access.log

# SQL –∏–Ω—ä–µ–∫—Ü–∏–∏ –≤ URL:
grep -iE "(union|select|insert|delete|update|drop|exec)" /var/log/nginx/access.log

# XSS –∞—Ç–∞–∫–∏:
grep -iE "(<script|javascript:|onerror=|onload=)" /var/log/nginx/access.log

# –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π (–º–Ω–æ–≥–æ 404):
grep " 404 " /var/log/nginx/access.log | \
    grep -oE "[0-9]+\.[0-9]+\.[0-9]+\.[0-9]+" | \
    sort | uniq -c | sort -rn

# –ü–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ User-Agent:
grep -iE "(nikto|sqlmap|nmap|masscan|zgrab|scanner)" /var/log/nginx/access.log

# –î–æ—Å—Ç—É–ø –∫ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–º —Ñ–∞–π–ª–∞–º:
grep -iE "(\\.env|\\.git|wp-config|admin|phpinfo)" /var/log/nginx/access.log
```

---

## 2.2.2 awk ‚Äî –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞

`awk` ‚Äî —ç—Ç–æ —Ü–µ–ª—ã–π —è–∑—ã–∫ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö. –ò–¥–µ–∞–ª—å–Ω–æ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ç–∞–±–ª–∏—á–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏, –ª–æ–≥–∞–º–∏ —Å —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π.

### –ë–∞–∑–æ–≤—ã–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å –∏ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏

```bash
# –°–∏–Ω—Ç–∞–∫—Å–∏—Å: awk '–ø—Ä–æ–≥—Ä–∞–º–º–∞' —Ñ–∞–π–ª
# –ü—Ä–æ–≥—Ä–∞–º–º–∞: '—É—Å–ª–æ–≤–∏–µ { –¥–µ–π—Å—Ç–≤–∏–µ }'

# awk –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Ñ–∞–π–ª —Å—Ç—Ä–æ–∫–∞ –∑–∞ —Å—Ç—Ä–æ–∫–æ–π
# –ö–∞–∂–¥–∞—è —Å—Ç—Ä–æ–∫–∞ —Ä–∞–∑–±–∏–≤–∞–µ—Ç—Å—è –Ω–∞ –ø–æ–ª—è –ø–æ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—é

# –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:
# $0  ‚Äî –≤—Å—è —Å—Ç—Ä–æ–∫–∞ —Ü–µ–ª–∏–∫–æ–º
# $1  ‚Äî –ø–µ—Ä–≤–æ–µ –ø–æ–ª–µ
# $2  ‚Äî –≤—Ç–æ—Ä–æ–µ –ø–æ–ª–µ
# $NF ‚Äî –ø–æ—Å–ª–µ–¥–Ω–µ–µ –ø–æ–ª–µ
# NR  ‚Äî –Ω–æ–º–µ—Ä —Ç–µ–∫—É—â–µ–π –∑–∞–ø–∏—Å–∏ (—Å—Ç—Ä–æ–∫–∏)
# NF  ‚Äî –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª–µ–π –≤ —Ç–µ–∫—É—â–µ–π —Å—Ç—Ä–æ–∫–µ
# FS  ‚Äî —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å –ø–æ–ª–µ–π (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: –ø—Ä–æ–±–µ–ª)
# OFS ‚Äî –≤—ã—Ö–æ–¥–Ω–æ–π —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å –ø–æ–ª–µ–π
# RS  ‚Äî —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å –∑–∞–ø–∏—Å–µ–π (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: newline)
# ORS ‚Äî –≤—ã—Ö–æ–¥–Ω–æ–π —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å –∑–∞–ø–∏—Å–µ–π
# FILENAME ‚Äî –∏–º—è —Ç–µ–∫—É—â–µ–≥–æ —Ñ–∞–π–ª–∞

# –ü–µ—á–∞—Ç—å –ø–æ–ª–µ–π:
awk '{print $1}' /etc/passwd         # –ü–µ—Ä–≤–æ–µ –ø–æ–ª–µ (–ª–æ–≥–∏–Ω)
awk -F: '{print $1}' /etc/passwd     # –†–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å ":"
awk -F: '{print $1, $3}' /etc/passwd # –õ–æ–≥–∏–Ω –∏ UID
```

### –†–∞–±–æ—Ç–∞ —Å /etc/passwd —á–µ—Ä–µ–∑ awk

```bash
# –†–∞–∑–±–æ—Ä /etc/passwd (—Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å :)
awk -F: '{print $1}' /etc/passwd                    # –í—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
awk -F: '{print $1, $3, $4}' /etc/passwd            # –õ–æ–≥–∏–Ω, UID, GID
awk -F: '$3 == 0 {print $1}' /etc/passwd            # –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å UID 0 (root!)
awk -F: '$3 >= 1000 {print $1}' /etc/passwd         # –û–±—ã—á–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
awk -F: '$7 !~ /nologin|false/ {print $1, $7}' /etc/passwd  # –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å –æ–±–æ–ª–æ—á–∫–æ–π
awk -F: 'NF < 7 {print NR": "$0}' /etc/passwd      # –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏

# –ü–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –ø—É—Å—Ç—ã–º –ø–∞—Ä–æ–ª–µ–º (–≤ /etc/shadow):
awk -F: '$2 == "" {print $1, "–ü–£–°–¢–û–ô –ü–ê–†–û–õ–¨!"}' /etc/shadow

# –í—ã–≤–æ–¥ —Å —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º:
awk -F: '{printf "%-20s UID: %5d  Shell: %s\n", $1, $3, $7}' /etc/passwd
```

### –£—Å–ª–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞ –≤ awk

```bash
# if-else:
awk -F: '{
    if ($3 == 0) {
        print $1, "ROOT!"
    } else if ($3 < 1000) {
        print $1, "—Å–∏—Å—Ç–µ–º–Ω—ã–π"
    } else {
        print $1, "–æ–±—ã—á–Ω—ã–π"
    }
}' /etc/passwd

# –û–ø–µ—Ä–∞—Ç–æ—Ä—ã —Å—Ä–∞–≤–Ω–µ–Ω–∏—è: == != < > <= >=
# –õ–æ–≥–∏—á–µ—Å–∫–∏–µ: && || !
# –†–µ–≥—É–ª—è—Ä–Ω—ã–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è: ~ !~

# –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏, —á—å—è –æ–±–æ–ª–æ—á–∫–∞ —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å regex:
awk -F: '$7 ~ /bash|zsh|sh/ {print $1}' /etc/passwd

# –ß–∏—Å–ª–æ–≤—ã–µ —É—Å–ª–æ–≤–∏—è:
awk -F: '$3 >= 1000 && $3 < 65534 {print $1, $3}' /etc/passwd
```

### –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã: BEGIN –∏ END

```bash
# BEGIN –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –¥–æ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ñ–∞–π–ª–∞
# END –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø–æ—Å–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ñ–∞–π–ª–∞

awk -F: '
BEGIN {
    print "=== –°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –æ–±–æ–ª–æ—á–∫–æ–π ==="
    count = 0
}
$7 ~ /bash|zsh|sh$/ {
    print $1
    count++
}
END {
    print "=== –ò—Ç–æ–≥–æ:", count, "–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π ==="
}' /etc/passwd

# –ü–æ–¥—Å—á—ë—Ç —Å—Ç–∞—Ç—É—Å–æ–≤ –≤ HTTP –ª–æ–≥–∞—Ö:
awk '{status[$9]++}
END {
    for (s in status)
        print s, status[s]
}' /var/log/nginx/access.log | sort -k1n
```

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –ª–æ–≥–æ–≤ —Å awk

```bash
# –§–æ—Ä–º–∞—Ç nginx access.log:
# IP - - [–¥–∞—Ç–∞] "–ú–ï–¢–û–î URL –ü–†–û–¢–û–ö–û–õ" –°–¢–ê–¢–£–° –†–ê–ó–ú–ï–† "–†–ï–§–ï–†–ï–†" "USER-AGENT"
# 192.168.1.1 - - [15/Jan/2024:10:30:00 +0000] "GET /index.html HTTP/1.1" 200 5040 "-" "Mozilla/5.0"

# –ò–∑–≤–ª–µ—á—å IP –∏ URL:
awk '{print $1, $7}' /var/log/nginx/access.log

# –ü–æ–¥—Å—á–∏—Ç–∞—Ç—å –∑–∞–ø—Ä–æ—Å—ã –ø–æ IP:
awk '{ip[$1]++} END {for (i in ip) print ip[i], i}' \
    /var/log/nginx/access.log | sort -rn | head -10

# –ù–∞–π—Ç–∏ —Å–∞–º—ã–µ –ø–æ—Å–µ—â–∞–µ–º—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã:
awk '{pages[$7]++} END {for (p in pages) print pages[p], p}' \
    /var/log/nginx/access.log | sort -rn | head -10

# –ü–æ–¥—Å—á–∏—Ç–∞—Ç—å –æ–±—ä—ë–º —Ç—Ä–∞—Ñ–∏–∫–∞ –ø–æ IP:
awk '{traffic[$1] += $10} END {for (i in traffic) print i, traffic[i]}' \
    /var/log/nginx/access.log | sort -k2 -rn | head -10

# –ü–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã (—Å—Ç–∞—Ç—É—Å 4xx):
awk '$9 ~ /^4/ {print $1, $9, $7}' /var/log/nginx/access.log | \
    sort | uniq -c | sort -rn | head -20

# –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞ (–µ—Å–ª–∏ –µ—Å—Ç—å –ø–æ–ª–µ):
awk '{sum += $NF; count++} END {print "–°—Ä–µ–¥–Ω–µ–µ:", sum/count, "–º—Å"}' response_times.log

# –ê–Ω–∞–ª–∏–∑ SSH auth.log:
# –§–æ—Ä–º–∞—Ç: Jan 15 10:30:00 hostname sshd[PID]: message

# –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–µ—É–¥–∞—á–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫ –ø–æ IP:
awk '/Failed password/{
    match($0, /from ([0-9.]+)/, arr)
    failed[arr[1]]++
}
END {
    for (ip in failed)
        if (failed[ip] > 5)
            print failed[ip], ip, "–í–û–ó–ú–û–ñ–ù–´–ô –ë–†–£–¢–§–û–†–°"
}' /var/log/auth.log | sort -rn

# –£—Å–ø–µ—à–Ω—ã–µ –≤—Ö–æ–¥—ã —Å —É–∫–∞–∑–∞–Ω–∏–µ–º –≤—Ä–µ–º–µ–Ω–∏:
awk '/Accepted/{print $1, $2, $3, $9, $11}' /var/log/auth.log
```

### –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ —Ç–µ—Ö–Ω–∏–∫–∏ awk

```bash
# –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Ñ–∞–π–ª–æ–≤:
awk 'FNR==1{print "=== –§–∞–π–ª:", FILENAME}
     {print NR": "$0}' file1.txt file2.txt

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –º–∞—Å—Å–∏–≤–æ–≤:
awk '{
    users[$1]++
    if (users[$1] > 100) {
        print $1, "–ø—Ä–µ–≤—ã—Å–∏–ª –ª–∏–º–∏—Ç:", users[$1]
    }
}' access.log

# –ú–Ω–æ–≥–æ—Å—Ç—Ä–æ—á–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞:
awk '
/START/ { capture=1; block="" }
capture { block = block $0 "\n" }
/END/ { if (capture) { print block; capture=0 } }
' logfile.txt

# –í—ã–∑–æ–≤ awk –∏–∑ bash-–ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö:
THRESHOLD=50
awk -v limit=$THRESHOLD '$9 > limit {print $0}' access.log

# –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –≤—ã–≤–æ–¥:
awk -F: '
BEGIN {
    printf "%-15s %6s %6s %-20s\n", "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å", "UID", "GID", "–û–±–æ–ª–æ—á–∫–∞"
    printf "%-15s %6s %6s %-20s\n", "-------------", "---", "---", "-------"
}
$3 >= 1000 && $3 < 65534 {
    printf "%-15s %6d %6d %-20s\n", $1, $3, $4, $7
}' /etc/passwd

# –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è:
awk '{sum += $5; if ($5 > max) max = $5}
END {
    print "–°—É–º–º–∞:", sum
    print "–ú–∞–∫—Å–∏–º—É–º:", max
    print "–°—Ä–µ–¥–Ω–µ–µ:", sum/NR
}' data.txt
```

---

## 2.2.3 sed ‚Äî –ø–æ—Ç–æ–∫–æ–≤—ã–π —Ä–µ–¥–∞–∫—Ç–æ—Ä

`sed` (Stream Editor) ‚Äî –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è —Ç–µ–∫—Å—Ç–∞. –ü—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –¥–ª—è –∑–∞–º–µ–Ω—ã, —É–¥–∞–ª–µ–Ω–∏—è –∏ –≤—Å—Ç–∞–≤–∫–∏ —Å—Ç—Ä–æ–∫ –≤ —Ñ–∞–π–ª–∞—Ö –∏ –ø–æ—Ç–æ–∫–∞—Ö –¥–∞–Ω–Ω—ã—Ö.

### –ë–∞–∑–æ–≤—ã–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å

```bash
sed [–æ–ø—Ü–∏–∏] '–∫–æ–º–∞–Ω–¥—ã' [—Ñ–∞–π–ª]

# –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã sed:
# s  ‚Äî –∑–∞–º–µ–Ω–∞ (substitute)
# d  ‚Äî —É–¥–∞–ª–µ–Ω–∏–µ (delete)
# p  ‚Äî –ø–µ—á–∞—Ç—å (print)
# i  ‚Äî –≤—Å—Ç–∞–≤–∫–∞ –ø–µ—Ä–µ–¥ —Å—Ç—Ä–æ–∫–æ–π (insert)
# a  ‚Äî –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–æ—Å–ª–µ —Å—Ç—Ä–æ–∫–∏ (append)
# q  ‚Äî –≤—ã—Ö–æ–¥ (quit)
# y  ‚Äî —Ç—Ä–∞–Ω—Å–ª–∏—Ç–µ—Ä–∞—Ü–∏—è

# –ê–¥—Ä–µ—Å–∞—Ü–∏—è:
# n      ‚Äî —Å—Ç—Ä–æ–∫–∞ —Å –Ω–æ–º–µ—Ä–æ–º n
# $      ‚Äî –ø–æ—Å–ª–µ–¥–Ω—è—è —Å—Ç—Ä–æ–∫–∞
# /regex/ ‚Äî —Å—Ç—Ä–æ–∫–∏, —Å–æ–≤–ø–∞–¥–∞—é—â–∏–µ —Å regex
# n,m    ‚Äî —Å—Ç—Ä–æ–∫–∏ —Å n –ø–æ m
# n~step ‚Äî –∫–∞–∂–¥–∞—è step-—è —Å—Ç—Ä–æ–∫–∞ –Ω–∞—á–∏–Ω–∞—è —Å n
```

### –ö–æ–º–∞–Ω–¥–∞ –∑–∞–º–µ–Ω—ã (s)

```bash
# –°–∏–Ω—Ç–∞–∫—Å–∏—Å: s/—à–∞–±–ª–æ–Ω/–∑–∞–º–µ–Ω–∞/—Ñ–ª–∞–≥–∏
# –§–ª–∞–≥–∏: g (–≤—Å–µ –≤—Ö–æ–∂–¥–µ–Ω–∏—è), i (–±–µ–∑ —É—á—ë—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞), p (–≤—ã–≤–µ—Å—Ç–∏), n (–Ω–µ—Ç –≤—ã–≤–æ–¥–∞)

# –ë–∞–∑–æ–≤—ã–µ –∑–∞–º–µ–Ω—ã:
sed 's/foo/bar/' file.txt          # –ü–µ—Ä–≤–æ–µ –≤—Ö–æ–∂–¥–µ–Ω–∏–µ –≤ –∫–∞–∂–¥–æ–π —Å—Ç—Ä–æ–∫–µ
sed 's/foo/bar/g' file.txt         # –í—Å–µ –≤—Ö–æ–∂–¥–µ–Ω–∏—è
sed 's/foo/bar/2' file.txt         # –¢–æ–ª—å–∫–æ –≤—Ç–æ—Ä–æ–µ –≤—Ö–æ–∂–¥–µ–Ω–∏–µ
sed 's/foo/bar/gi' file.txt        # –í—Å–µ, –±–µ–∑ —É—á—ë—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞

# –ó–∞–º–µ–Ω–∞ —Å —Ä–∞–∑–Ω—ã–º–∏ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—è–º–∏ (–∫–æ–≥–¥–∞ / –µ—Å—Ç—å –≤ —à–∞–±–ª–æ–Ω–µ):
sed 's|/etc/passwd|/etc/shadow|' file.txt
sed 's,old/path,new/path,g' file.txt

# –ó–∞—Ö–≤–∞—Ç –≥—Ä—É–ø–ø:
sed 's/\(error\)/[\1]/g' file.txt      # BRE: –æ–±–µ—Ä–Ω—É—Ç—å "error" –≤ []
sed -E 's/(error)/[\1]/g' file.txt     # ERE (extended)
sed -E 's/([0-9]+)/NUM/g' file.txt     # –ó–∞–º–µ–Ω–∏—Ç—å —á–∏—Å–ª–∞ –Ω–∞ NUM

# –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ —Å –∑–∞–º–µ–Ω–æ–π –≤ –Ω—ë–º (in-place):
sed -i 's/PermitRootLogin yes/PermitRootLogin no/' /etc/ssh/sshd_config
sed -i.bak 's/old/new/g' config.txt    # .bak ‚Äî —Å–æ–∑–¥–∞—Ç—å —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é

# –ó–∞–º–µ–Ω–∞ —Å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ bash:
OLD="192.168.1.1"
NEW="10.0.0.1"
sed "s/$OLD/$NEW/g" config.txt         # –î–≤–æ–π–Ω—ã–µ –∫–∞–≤—ã—á–∫–∏ –¥–ª—è —Ä–∞—Å–∫—Ä—ã—Ç–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
```

### –£–¥–∞–ª–µ–Ω–∏–µ —Å—Ç—Ä–æ–∫

```bash
# –£–¥–∞–ª–µ–Ω–∏–µ –ø–æ –Ω–æ–º–µ—Ä—É —Å—Ç—Ä–æ–∫–∏:
sed '5d' file.txt                  # –£–¥–∞–ª–∏—Ç—å —Å—Ç—Ä–æ–∫—É 5
sed '1,3d' file.txt                # –£–¥–∞–ª–∏—Ç—å —Å—Ç—Ä–æ–∫–∏ 1-3
sed '$d' file.txt                  # –£–¥–∞–ª–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω—é—é —Å—Ç—Ä–æ–∫—É
sed '2~2d' file.txt                # –£–¥–∞–ª–∏—Ç—å –∫–∞–∂–¥—É—é –≤—Ç–æ—Ä—É—é —Å—Ç—Ä–æ–∫—É

# –£–¥–∞–ª–µ–Ω–∏–µ –ø–æ —à–∞–±–ª–æ–Ω—É:
sed '/^#/d' /etc/ssh/sshd_config   # –£–¥–∞–ª–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏
sed '/^$/d' file.txt               # –£–¥–∞–ª–∏—Ç—å –ø—É—Å—Ç—ã–µ —Å—Ç—Ä–æ–∫–∏
sed '/^#\|^$/d' file.txt           # –£–¥–∞–ª–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –∏ –ø—É—Å—Ç—ã–µ —Å—Ç—Ä–æ–∫–∏

# –£–¥–∞–ª–µ–Ω–∏–µ –æ—Ç —à–∞–±–ª–æ–Ω–∞ –¥–æ –∫–æ–Ω—Ü–∞ —Ñ–∞–π–ª–∞:
sed '/^END/,$d' file.txt           # –£–¥–∞–ª–∏—Ç—å –æ—Ç —Å—Ç—Ä–æ–∫–∏ END –¥–æ –∫–æ–Ω—Ü–∞
```

### –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤—ã–≤–æ–¥–æ–º

```bash
# -n –ø–æ–¥–∞–≤–ª—è–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—ã–≤–æ–¥
# p —è–≤–Ω–æ –ø–µ—á–∞—Ç–∞–µ—Ç —Å—Ç—Ä–æ–∫—É

# –í—ã–≤–µ—Å—Ç–∏ —Ç–æ–ª—å–∫–æ —Å—Ç—Ä–æ–∫–∏ —Å —à–∞–±–ª–æ–Ω–æ–º (–∫–∞–∫ grep):
sed -n '/error/p' /var/log/syslog

# –í—ã–≤–µ—Å—Ç–∏ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏:
sed -n '10,20p' file.txt           # –°—Ç—Ä–æ–∫–∏ 10-20
sed -n '10p' file.txt              # –¢–æ–ª—å–∫–æ —Å—Ç—Ä–æ–∫–∞ 10
sed -n '$p' file.txt               # –¢–æ–ª—å–∫–æ –ø–æ—Å–ª–µ–¥–Ω—è—è —Å—Ç—Ä–æ–∫–∞

# –í—ã–≤–µ—Å—Ç–∏ —Å—Ç—Ä–æ–∫–∏ –≤–æ–∫—Ä—É–≥ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è:
sed -n '/error/{N;p}' file.txt     # –°—Ç—Ä–æ–∫—É —Å error –∏ —Å–ª–µ–¥—É—é—â—É—é
```

### –í—Å—Ç–∞–≤–∫–∞ –∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ

```bash
# –í—Å—Ç–∞–≤–∏—Ç—å —Å—Ç—Ä–æ–∫—É –ü–ï–†–ï–î —à–∞–±–ª–æ–Ω–æ–º:
sed '/ServerName/i\# –î–æ–±–∞–≤–ª–µ–Ω–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏' nginx.conf

# –î–æ–±–∞–≤–∏—Ç—å —Å—Ç—Ä–æ–∫—É –ü–û–°–õ–ï —à–∞–±–ª–æ–Ω–∞:
sed '/ServerName/a\ServerAlias www.example.com' nginx.conf

# –ò–∑–º–µ–Ω–∏—Ç—å —Å—Ç—Ä–æ–∫—É, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â—É—é —à–∞–±–ª–æ–Ω—É:
sed '/PermitRootLogin/c\PermitRootLogin no' /etc/ssh/sshd_config
```

### –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è sed –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

```bash
# –û—á–∏—Å—Ç–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ –æ—Ç –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤:
sed '/^#/d; /^$/d' /etc/ssh/sshd_config

# –ê–Ω–æ–Ω–∏–º–∏–∑–∞—Ü–∏—è IP-–∞–¥—Ä–µ—Å–æ–≤ –≤ –ª–æ–≥–∞—Ö:
sed -E 's/([0-9]{1,3}\.){3}[0-9]{1,3}/X.X.X.X/g' access.log

# –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π –∏–∑ –∫–æ–Ω—Ñ–∏–≥–æ–≤ (–¥–ª—è –∞—É–¥–∏—Ç–∞):
sed -n 's/.*password[[:space:]]*=[[:space:]]*\(.*\)/\1/Ip' config.php

# –•–∞—Ä–¥–µ–Ω–∏–µ SSH –∫–æ–Ω—Ñ–∏–≥–∞ –æ–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π:
sed -i 's/^#*PermitRootLogin.*/PermitRootLogin no/;
        s/^#*PasswordAuthentication.*/PasswordAuthentication no/;
        s/^#*X11Forwarding.*/X11Forwarding no/' /etc/ssh/sshd_config

# –£–¥–∞–ª–µ–Ω–∏–µ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø—É—Å—Ç—ã—Ö —Å—Ç—Ä–æ–∫:
sed '/^$/N;/^\n$/d' file.txt

# –ú–∞—Å–∫–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–µ–∫—Ä–µ—Ç–æ–≤ –≤ –∫–æ–Ω—Ñ–∏–≥–∞—Ö –ø–µ—Ä–µ–¥ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º:
sed -E 's/(password|secret|token|key)([[:space:]]*=[[:space:]]*)([^[:space:]]+)/\1\2*****/gi' config.txt

# –ú–Ω–æ–≥–æ—Å—Ç—Ä–æ—á–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞:
sed -n '/BEGIN CERTIFICATE/,/END CERTIFICATE/p' cert_file.pem
```

---

## 2.2.4 –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —É—Ç–∏–ª–∏—Ç—ã

### cut ‚Äî –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –ø–æ–ª–µ–π

```bash
# –°–∏–Ω—Ç–∞–∫—Å–∏—Å: cut [–æ–ø—Ü–∏–∏] —Ñ–∞–π–ª
# -d : —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å (delimiter)
# -f : –ø–æ–ª—è (fields)
# -c : —Å–∏–º–≤–æ–ª—ã (characters)
# -b : –±–∞–π—Ç—ã

# –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –ø–æ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—é:
cut -d: -f1 /etc/passwd              # –ò–º–µ–Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
cut -d: -f1,3 /etc/passwd            # –ò–º–µ–Ω–∞ –∏ UID
cut -d: -f1-4 /etc/passwd            # –ü–æ–ª—è 1-4

# –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –ø–æ —Å–∏–º–≤–æ–ª–∞–º:
cut -c1-10 file.txt                  # –°–∏–º–≤–æ–ª—ã 1-10 –∫–∞–∂–¥–æ–π —Å—Ç—Ä–æ–∫–∏
cut -c5- file.txt                    # –û—Ç 5-–≥–æ —Å–∏–º–≤–æ–ª–∞ –¥–æ –∫–æ–Ω—Ü–∞

# –ü—Ä–∞–∫—Ç–∏–∫–∞:
cut -d: -f1 /etc/group               # –ò–º–µ–Ω–∞ –≥—Ä—É–ø–ø
cut -d' ' -f1 /var/log/nginx/access.log | sort -u  # –£–Ω–∏–∫–∞–ª—å–Ω—ã–µ IP
```

### sort ‚Äî —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞

```bash
sort file.txt                    # –ê–ª—Ñ–∞–≤–∏—Ç–Ω–∞—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞
sort -n file.txt                 # –ß–∏—Å–ª–æ–≤–∞—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞
sort -r file.txt                 # –û–±—Ä–∞—Ç–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫
sort -rn file.txt                # –ß–∏—Å–ª–æ–≤–∞—è –æ–±—Ä–∞—Ç–Ω–∞—è
sort -u file.txt                 # –£–Ω–∏–∫–∞–ª—å–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏ (—É–¥–∞–ª–∏—Ç—å –¥—É–±–ª–∏)
sort -k2 file.txt                # –ü–æ –≤—Ç–æ—Ä–æ–º—É –ø–æ–ª—é
sort -k2n file.txt               # –ü–æ –≤—Ç–æ—Ä–æ–º—É –ø–æ–ª—é —á–∏—Å–ª–æ–≤–æ
sort -t: -k3n /etc/passwd        # –ü–æ UID (—Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å :)

# –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ IP-–∞–¥—Ä–µ—Å—É:
sort -t. -k1,1n -k2,2n -k3,3n -k4,4n ips.txt

# –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –∏ —É–¥–∞–ª–µ–Ω–∏–µ –¥—É–±–ª–µ–π —Å –ø–æ–¥—Å—á—ë—Ç–æ–º:
sort /var/log/nginx/access.log | uniq -c | sort -rn
```

### uniq ‚Äî —Ä–∞–±–æ—Ç–∞ —Å –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ —Å—Ç—Ä–æ–∫–∞–º–∏

```bash
# –í–ê–ñ–ù–û: uniq —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ —Å –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–º–∏ –¥—É–±–ª—è–º–∏, –ø–æ—ç—Ç–æ–º—É —Å–Ω–∞—á–∞–ª–∞ sort!

uniq file.txt                    # –£–¥–∞–ª–∏—Ç—å –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–µ –¥—É–±–ª–∏
uniq -c file.txt                 # –ü–æ–¥—Å—á–∏—Ç–∞—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–π
uniq -d file.txt                 # –ü–æ–∫–∞–∑–∞—Ç—å —Ç–æ–ª—å–∫–æ –¥—É–±–ª–∏
uniq -u file.txt                 # –ü–æ–∫–∞–∑–∞—Ç—å —Ç–æ–ª—å–∫–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ
uniq -i file.txt                 # –ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–≥–∏—Å—Ç—Ä

# –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –ø–∞—Ç—Ç–µ—Ä–Ω: sort | uniq -c | sort -rn
cat /var/log/auth.log | grep "Failed password" | \
    awk '{print $(NF-3)}' | sort | uniq -c | sort -rn | head -10
```

### wc ‚Äî –ø–æ–¥—Å—á—ë—Ç

```bash
wc file.txt              # –°—Ç—Ä–æ–∫–∏, —Å–ª–æ–≤–∞, –±–∞–π—Ç—ã
wc -l file.txt           # –¢–æ–ª—å–∫–æ —Å—Ç—Ä–æ–∫–∏
wc -w file.txt           # –¢–æ–ª—å–∫–æ —Å–ª–æ–≤–∞
wc -c file.txt           # –¢–æ–ª—å–∫–æ –±–∞–π—Ç—ã
wc -m file.txt           # –¢–æ–ª—å–∫–æ —Å–∏–º–≤–æ–ª—ã

# –ü—Ä–∞–∫—Ç–∏–∫–∞:
wc -l /etc/passwd        # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
grep "Failed" /var/log/auth.log | wc -l    # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–µ—É–¥–∞—á
ls /etc/ | wc -l         # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ñ–∞–π–ª–æ–≤ –≤ /etc
```

### head –∏ tail ‚Äî –Ω–∞—á–∞–ª–æ –∏ –∫–æ–Ω–µ—Ü —Ñ–∞–π–ª–æ–≤

```bash
head file.txt            # –ü–µ—Ä–≤—ã–µ 10 —Å—Ç—Ä–æ–∫
head -n 20 file.txt      # –ü–µ—Ä–≤—ã–µ 20 —Å—Ç—Ä–æ–∫
head -c 100 file.txt     # –ü–µ—Ä–≤—ã–µ 100 –±–∞–π—Ç

tail file.txt            # –ü–æ—Å–ª–µ–¥–Ω–∏–µ 10 —Å—Ç—Ä–æ–∫
tail -n 50 file.txt      # –ü–æ—Å–ª–µ–¥–Ω–∏–µ 50 —Å—Ç—Ä–æ–∫
tail -c 200 file.txt     # –ü–æ—Å–ª–µ–¥–Ω–∏–µ 200 –±–∞–π—Ç

# -f : —Å–ª–µ–¥–∏—Ç—å –∑–∞ —Ñ–∞–π–ª–æ–º –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ (follow)
tail -f /var/log/auth.log
tail -f /var/log/nginx/access.log

# -F : follow —Å –ø–æ–≤—Ç–æ—Ä–Ω—ã–º –æ—Ç–∫—Ä—ã—Ç–∏–µ–º –ø—Ä–∏ —Ä–æ—Ç–∞—Ü–∏–∏
tail -F /var/log/syslog

# –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ head –∏ tail:
tail -n +5 file.txt | head -n 10    # –°—Ç—Ä–æ–∫–∏ 5-14 (–ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å –ø–µ—Ä–≤—ã–µ 4)
head -n 20 file.txt | tail -n 10    # –°—Ç—Ä–æ–∫–∏ 11-20
```

---

## 2.2.5 –ö–æ–Ω–≤–µ–π–µ—Ä—ã –∏ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è

```bash
# –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –ø–æ—Ç–æ–∫–∏:
# stdin  (0) ‚Äî —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –≤–≤–æ–¥
# stdout (1) ‚Äî —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –≤—ã–≤–æ–¥
# stderr (2) ‚Äî —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –≤—ã–≤–æ–¥ –æ—à–∏–±–æ–∫

# –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤—ã–≤–æ–¥–∞:
command > file.txt           # –ü–µ—Ä–µ–∑–∞–ø–∏—Å–∞—Ç—å —Ñ–∞–π–ª
command >> file.txt          # –î–æ–±–∞–≤–∏—Ç—å –≤ –∫–æ–Ω–µ—Ü —Ñ–∞–π–ª–∞
command 2> error.log         # –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–∏—Ç—å stderr
command 2>> error.log        # –î–æ–±–∞–≤–∏—Ç—å stderr –≤ —Ñ–∞–π–ª
command > out.txt 2>&1       # –û–±—ä–µ–¥–∏–Ω–∏—Ç—å stdout –∏ stderr
command &> both.txt          # –ö—Ä–∞—Ç–∫–∞—è —Ñ–æ—Ä–º–∞ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è (bash)
command > /dev/null 2>&1     # –ü–æ–¥–∞–≤–∏—Ç—å –≤–µ—Å—å –≤—ã–≤–æ–¥

# –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–≤–æ–¥–∞:
command < file.txt           # –ß–∏—Ç–∞—Ç—å stdin –∏–∑ —Ñ–∞–π–ª–∞
command << 'EOF'             # Here-document
    —Ç–µ–∫—Å—Ç
EOF
command <<< "—Å—Ç—Ä–æ–∫–∞"         # Here-string

# –ü—Ä–∏–º–µ—Ä—ã:
grep "error" /var/log/syslog > errors.txt 2>/dev/null
find / -perm -4000 2>/dev/null > suid_files.txt
sort /etc/passwd > /tmp/sorted_passwd.txt
```

### –ö–æ–Ω–≤–µ–π–µ—Ä—ã (pipes)

```bash
# –°–∏–º–≤–æ–ª | –ø–µ—Ä–µ–¥–∞—ë—Ç stdout –æ–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥—ã –≤ stdin —Å–ª–µ–¥—É—é—â–µ–π

# –ë–∞–∑–æ–≤—ã–µ –∫–æ–Ω–≤–µ–π–µ—Ä—ã:
cat /etc/passwd | grep bash        # –≠–∫–≤–∏–≤–∞–ª–µ–Ω—Ç–Ω–æ grep bash /etc/passwd
ps aux | grep nginx
ls -la /var/log/ | sort -k5 -rn   # –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ —Ä–∞–∑–º–µ—Ä—É

# –ú–Ω–æ–≥–æ—Å—Ç—É–ø–µ–Ω—á–∞—Ç—ã–µ –∫–æ–Ω–≤–µ–π–µ—Ä—ã:
cat /var/log/auth.log | \
    grep "Failed password" | \
    awk '{print $(NF-3)}' | \
    sort | \
    uniq -c | \
    sort -rn | \
    head -10

# –ö–æ–Ω–≤–µ–π–µ—Ä —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞–º–∏:
netstat -an | grep ESTABLISHED | awk '{print $5}' | \
    cut -d: -f1 | sort | uniq -c | sort -rn
```

### tee ‚Äî —Ä–∞–∑–¥–≤–æ–µ–Ω–∏–µ –ø–æ—Ç–æ–∫–∞

```bash
# tee –∫–æ–ø–∏—Ä—É–µ—Ç stdin –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –≤ stdout –∏ –≤ —Ñ–∞–π–ª(—ã)
command | tee file.txt                    # –í—ã–≤–µ—Å—Ç–∏ –∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å
command | tee file.txt | another_command  # –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏ –ø–µ—Ä–µ–¥–∞—Ç—å –¥–∞–ª—å—à–µ
command | tee -a file.txt                 # –î–æ–±–∞–≤–∏—Ç—å –≤ —Ñ–∞–π–ª (–Ω–µ –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞—Ç—å)
command | tee file1.txt file2.txt        # –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ñ–∞–π–ª–æ–≤

# –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω–æ–≥–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –≤ –∫–æ–Ω–≤–µ–π–µ—Ä–µ:
cat /var/log/auth.log | \
    grep "Failed password" | \
    tee /tmp/failed_attempts.txt | \
    awk '{print $(NF-3)}' | \
    sort | uniq -c | sort -rn
```

### xargs ‚Äî –ø–µ—Ä–µ–¥–∞—á–∞ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤

```bash
# xargs –±–µ—Ä—ë—Ç stdin –∏ –ø–µ—Ä–µ–¥–∞—ë—Ç –∫–∞–∫ –∞—Ä–≥—É–º–µ–Ω—Ç—ã –∫–æ–º–∞–Ω–¥–µ
find /tmp -name "*.tmp" | xargs rm         # –£–¥–∞–ª–∏—Ç—å –Ω–∞–π–¥–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
find /etc -name "*.conf" | xargs grep -l "password"
echo "file1 file2 file3" | xargs ls -la

# -n : –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ –∑–∞ —Ä–∞–∑
cat ip_list.txt | xargs -n1 ping -c1

# -I : –∑–∞–º–µ–Ω–∏—Ç—å placeholder
cat urls.txt | xargs -I{} curl -s {}

# -P : –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ
find /var/log -name "*.log" | xargs -P4 -n1 gzip

# –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏–º—ë–Ω —Å –ø—Ä–æ–±–µ–ª–∞–º–∏:
find /tmp -name "*.tmp" -print0 | xargs -0 rm
find /etc -name "*.conf" -print0 | xargs -0 grep -l "password"

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞:
find /etc -name "*.conf" | xargs -n1 -I{} sh -c 'echo "–û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º: {}"'
```

---

## 2.2.6 –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –ª–æ–≥–æ–≤ –¥–ª—è SOC

### –°–∫—Ä–∏–ø—Ç –∞–Ω–∞–ª–∏–∑–∞ SSH-–∞—Ç–∞–∫

```bash
#!/bin/bash
# ssh_attack_analyzer.sh ‚Äî –∞–Ω–∞–ª–∏–∑ –∞—Ç–∞–∫ –Ω–∞ SSH

AUTH_LOG="/var/log/auth.log"
THRESHOLD=10    # –ü–æ—Ä–æ–≥ –¥–ª—è –±—Ä—É—Ç—Ñ–æ—Ä—Å–∞
REPORT="/tmp/ssh_report_$(date +%Y%m%d_%H%M%S).txt"

echo "=== SSH –ê–ù–ê–õ–ò–ó –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–ò ===" | tee "$REPORT"
echo "–î–∞—Ç–∞ –∞–Ω–∞–ª–∏–∑–∞: $(date)" | tee -a "$REPORT"
echo "–ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º—ã–π —Ñ–∞–π–ª: $AUTH_LOG" | tee -a "$REPORT"
echo "" | tee -a "$REPORT"

# 1. –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
echo "--- –û–ë–©–ê–Ø –°–¢–ê–¢–ò–°–¢–ò–ö–ê ---" | tee -a "$REPORT"
echo "–í—Å–µ–≥–æ —Å—Ç—Ä–æ–∫ –≤ –ª–æ–≥–µ: $(wc -l < $AUTH_LOG)" | tee -a "$REPORT"
echo "–ù–µ—É–¥–∞—á–Ω—ã—Ö –≤—Ö–æ–¥–æ–≤: $(grep -c "Failed password" $AUTH_LOG)" | tee -a "$REPORT"
echo "–£—Å–ø–µ—à–Ω—ã—Ö –≤—Ö–æ–¥–æ–≤: $(grep -c "Accepted" $AUTH_LOG)" | tee -a "$REPORT"
echo "" | tee -a "$REPORT"

# 2. –¢–æ–ø –∞—Ç–∞–∫—É—é—â–∏—Ö IP
echo "--- –¢–û–ü 20 –ê–¢–ê–ö–£–Æ–©–ò–• IP ---" | tee -a "$REPORT"
grep "Failed password" "$AUTH_LOG" | \
    grep -oE "[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}" | \
    sort | uniq -c | sort -rn | head -20 | \
    awk '{printf "%-8s %s\n", $1, $2}' | tee -a "$REPORT"
echo "" | tee -a "$REPORT"

# 3. –ë—Ä—É—Ç—Ñ–æ—Ä—Å: IP –≤—ã—à–µ –ø–æ—Ä–æ–≥–∞
echo "--- –í–û–ó–ú–û–ñ–ù–´–ô –ë–†–£–¢–§–û–†–° (>${THRESHOLD} –ø–æ–ø—ã—Ç–æ–∫) ---" | tee -a "$REPORT"
grep "Failed password" "$AUTH_LOG" | \
    grep -oE "[0-9]{1,3}(\.[0-9]{1,3}){3}" | \
    sort | uniq -c | awk -v t="$THRESHOLD" '$1 > t {print $1, $2}' | \
    sort -rn | tee -a "$REPORT"
echo "" | tee -a "$REPORT"

# 4. –ê—Ç–∞–∫—É–µ–º—ã–µ –ª–æ–≥–∏–Ω—ã
echo "--- –ê–¢–ê–ö–£–ï–ú–´–ï –ò–ú–ï–ù–ê –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–ï–ô ---" | tee -a "$REPORT"
grep "Failed password\|Invalid user" "$AUTH_LOG" | \
    awk '{
        for(i=1;i<=NF;i++)
            if ($i=="user" || $i=="for") { print $(i+1); break }
    }' | sort | uniq -c | sort -rn | head -20 | tee -a "$REPORT"
echo "" | tee -a "$REPORT"

# 5. –£—Å–ø–µ—à–Ω—ã–µ –≤—Ö–æ–¥—ã
echo "--- –£–°–ü–ï–®–ù–´–ï –í–•–û–î–´ ---" | tee -a "$REPORT"
grep "Accepted" "$AUTH_LOG" | \
    awk '{print $1, $2, $3, $9, "–æ—Ç", $11}' | tee -a "$REPORT"

echo "" | tee -a "$REPORT"
echo "–û—Ç—á—ë—Ç —Å–æ—Ö—Ä–∞–Ω—ë–Ω: $REPORT"
```

### –°–∫—Ä–∏–ø—Ç –∞–Ω–∞–ª–∏–∑–∞ –≤–µ–±-–ª–æ–≥–æ–≤

```bash
#!/bin/bash
# web_log_analyzer.sh ‚Äî –∞–Ω–∞–ª–∏–∑ –≤–µ–±-–ª–æ–≥–æ–≤ –Ω–∞ –ø—Ä–∏–∑–Ω–∞–∫–∏ –∞—Ç–∞–∫

NGINX_LOG="/var/log/nginx/access.log"

echo "=== –ê–ù–ê–õ–ò–ó –í–ï–ë-–õ–û–ì–û–í ==="
echo "–§–∞–π–ª: $NGINX_LOG"
echo "–ó–∞–ø–∏—Å–µ–π: $(wc -l < $NGINX_LOG)"
echo ""

# –¢–æ–ø IP –ø–æ –∑–∞–ø—Ä–æ—Å–∞–º
echo "--- –¢–û–ü 10 IP –ü–û –ó–ê–ü–†–û–°–ê–ú ---"
awk '{print $1}' "$NGINX_LOG" | sort | uniq -c | sort -rn | head -10

echo ""
echo "--- –†–ê–°–ü–†–ï–î–ï–õ–ï–ù–ò–ï –°–¢–ê–¢–£–°–û–í ---"
awk '{status[$9]++} END {
    for (s in status)
        printf "%s  %d\n", s, status[s]
}' "$NGINX_LOG" | sort

echo ""
echo "--- –ü–û–î–û–ó–†–ò–¢–ï–õ–¨–ù–´–ï –ó–ê–ü–†–û–°–´ ---"
echo "SQL-–∏–Ω—ä–µ–∫—Ü–∏–∏:"
grep -iE "(union.*select|insert.*into|drop.*table|exec\(|xp_cmdshell)" \
    "$NGINX_LOG" | awk '{print $1, $7}' | head -10

echo "XSS –ø–æ–ø—ã—Ç–∫–∏:"
grep -iE "(<script|alert\(|javascript:|onload=|onerror=)" \
    "$NGINX_LOG" | awk '{print $1, $7}' | head -10

echo "–°–∫–∞–Ω–µ—Ä—ã –∏ –±–æ—Ç—ã:"
grep -iE "(nikto|sqlmap|nmap|masscan|dirbuster|hydra|burp)" \
    "$NGINX_LOG" | awk '{print $1}' | sort | uniq -c | sort -rn

echo "–î–æ—Å—Ç—É–ø –∫ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–º —Ñ–∞–π–ª–∞–º:"
grep -E "\.(env|git|bak|sql|config|yml|yaml|json)" \
    "$NGINX_LOG" | awk '{print $1, $9, $7}' | head -20

echo ""
echo "--- –í–†–ï–ú–ï–ù–ù–û–ô –ê–ù–ê–õ–ò–ó (–∑–∞–ø—Ä–æ—Å—ã –ø–æ —á–∞—Å–∞–º) ---"
awk '{
    match($4, /\[([^:]+):([0-9]+):/, arr)
    hours[arr[2]]++
}
END {
    for (h in hours)
        printf "%02d:00  %d\n", h, hours[h]
}' "$NGINX_LOG" | sort
```

### –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ IOC (Indicators of Compromise) –∏–∑ –ª–æ–≥–æ–≤

```bash
#!/bin/bash
# extract_ioc.sh ‚Äî –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤ –∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏–∏

LOG_FILES="/var/log/auth.log /var/log/syslog /var/log/nginx/access.log"
OUTPUT_DIR="/tmp/ioc_$(date +%Y%m%d)"
mkdir -p "$OUTPUT_DIR"

echo "=== –ò–ó–í–õ–ï–ß–ï–ù–ò–ï IOC ==="

# –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ IP-–∞–¥—Ä–µ—Å–æ–≤
echo "[*] –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ IP-–∞–¥—Ä–µ—Å–æ–≤..."
for log in $LOG_FILES; do
    [ -f "$log" ] && grep -oE "\b([0-9]{1,3}\.){3}[0-9]{1,3}\b" "$log"
done | sort | uniq -c | sort -rn > "$OUTPUT_DIR/ip_addresses.txt"
echo "  –£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö IP: $(wc -l < $OUTPUT_DIR/ip_addresses.txt)"

# –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –¥–æ–º–µ–Ω–Ω—ã—Ö –∏–º—ë–Ω
echo "[*] –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –¥–æ–º–µ–Ω–æ–≤..."
grep -ohE "[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(\.[a-zA-Z]{2,})+" \
    /var/log/syslog 2>/dev/null | \
    grep -v "^[0-9]" | sort | uniq > "$OUTPUT_DIR/domains.txt"
echo "  –£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –¥–æ–º–µ–Ω–æ–≤: $(wc -l < $OUTPUT_DIR/domains.txt)"

# –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ Email-–∞–¥—Ä–µ—Å–æ–≤
echo "[*] –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ email..."
grep -ohE "[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}" \
    /var/log/mail.log 2>/dev/null | sort | uniq > "$OUTPUT_DIR/emails.txt"
echo "  –£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö email: $(wc -l < $OUTPUT_DIR/emails.txt)"

# –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ URL
echo "[*] –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ URL..."
grep -ohE "https?://[^\s\"]+" \
    /var/log/nginx/access.log 2>/dev/null | sort | uniq > "$OUTPUT_DIR/urls.txt"
echo "  –£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö URL: $(wc -l < $OUTPUT_DIR/urls.txt)"

# –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ User-Agent —Å—Ç—Ä–æ–∫ (—É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö)
echo "[*] –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ User-Agent..."
awk -F'"' '{print $6}' /var/log/nginx/access.log 2>/dev/null | \
    sort | uniq -c | sort -rn | head -50 > "$OUTPUT_DIR/user_agents.txt"

echo ""
echo "IOC —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤: $OUTPUT_DIR"
ls -la "$OUTPUT_DIR"
```

---

## 2.2.7 –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ —Ç–µ—Ö–Ω–∏–∫–∏ –¥–ª—è SOC-–∞–Ω–∞–ª–∏—Ç–∏–∫–∞

### –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –¥–ª—è —Ä–∞—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è

```bash
# –°—Ü–µ–Ω–∞—Ä–∏–π: –†–∞—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –≤–æ–∑–º–æ–∂–Ω–æ–≥–æ –±—Ä—É—Ç—Ñ–æ—Ä—Å–∞ SSH

# –®–∞–≥ 1: –ù–∞–π—Ç–∏ –≤—Å–µ –Ω–µ—É–¥–∞—á–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π —á–∞—Å
RECENT=$(date -d "1 hour ago" "+%b %e %H")
grep "Failed password" /var/log/auth.log | \
    grep "^$RECENT" | \
    awk '{print $(NF-3)}' | \
    sort | uniq -c | sort -rn

# –®–∞–≥ 2: –î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ IP
ATTACKER_IP="203.0.113.10"
grep "$ATTACKER_IP" /var/log/auth.log | \
    awk '{print $1, $2, $3, $6}' | \
    head -20

# –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –±—ã–ª –ª–∏ —É—Å–ø–µ—à–Ω—ã–π –≤—Ö–æ–¥
grep "Accepted.*$ATTACKER_IP" /var/log/auth.log

# –®–∞–≥ 4: –ß—Ç–æ –¥–µ–ª–∞–ª –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –µ—Å–ª–∏ –≤–æ—à—ë–ª
grep "session opened" /var/log/auth.log | grep "$ATTACKER_IP" | \
    awk '{print $NF}' | sed 's/user=//; s/)$//' | \
    while read user; do
        echo "=== –î–µ–π—Å—Ç–≤–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è $user ==="
        grep "$user" /var/log/auth.log | tail -20
    done

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö –∫–æ–º–∞–Ω–¥ –≤ bash_history:
for home in /home/*/; do
    user=$(basename "$home")
    if [ -f "$home/.bash_history" ]; then
        echo "=== –ò—Å—Ç–æ—Ä–∏—è $user ==="
        grep -iE "(wget|curl|nc|netcat|python|perl|php|bash -i|/dev/tcp)" \
            "$home/.bash_history" 2>/dev/null
    fi
done
```

### Realtime –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å –∫–æ–Ω–≤–µ–π–µ—Ä–∞–º–∏

```bash
# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –Ω–µ—É–¥–∞—á–Ω—ã—Ö SSH –≤—Ö–æ–¥–æ–≤ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏:
tail -f /var/log/auth.log | grep --line-buffered "Failed password" | \
    awk '{print strftime("%H:%M:%S"), "FAIL:", $(NF-3), $(NF-1)}'

# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ HTTP 4xx/5xx –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏:
tail -f /var/log/nginx/access.log | \
    awk '$9 ~ /^[45]/ {print strftime("%H:%M:%S"), $1, $9, $7}'

# –ê–ª–µ—Ä—Ç –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –ø–æ—Ä–æ–≥–∞:
tail -f /var/log/auth.log | grep --line-buffered "Failed" | \
    awk '
    {
        ip = $(NF-3)
        count[ip]++
        if (count[ip] == 10) {
            print "ALERT: –ë—Ä—É—Ç—Ñ–æ—Ä—Å —Å " ip " (" count[ip] " –ø–æ–ø—ã—Ç–æ–∫)"
            system("echo \"–ê—Ç–∞–∫–∞ —Å " ip "\" | mail -s \"SSH Alert\" admin@company.com")
        }
    }'
```

---

## üîß –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –∑–∞–¥–∞–Ω–∏—è

### –ó–∞–¥–∞–Ω–∏–µ 1: grep ‚Äî –ø–æ–∏—Å–∫ –≤ –ª–æ–≥–∞—Ö

```bash
# 1. –ù–∞–π–¥–∏—Ç–µ –≤—Å–µ —Å—Ç—Ä–æ–∫–∏ –≤ /var/log/auth.log —Å–æ–¥–µ—Ä–∂–∞—â–∏–µ "sudo"
grep "sudo" /var/log/auth.log | head -20

# 2. –ü–æ–¥—Å—á–∏—Ç–∞–π—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö IP-–∞–¥—Ä–µ—Å–æ–≤ –≤ auth.log
grep -oE "\b([0-9]{1,3}\.){3}[0-9]{1,3}\b" /var/log/auth.log | \
    sort -u | wc -l

# 3. –ù–∞–π–¥–∏—Ç–µ —Å—Ç—Ä–æ–∫–∏ —Å –æ—à–∏–±–∫–∞–º–∏, –ø–æ–∫–∞–∑—ã–≤–∞—è 2 —Å—Ç—Ä–æ–∫–∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞:
grep -C 2 "error\|Error\|ERROR" /var/log/syslog | head -30

# 4. –ù–∞–π–¥–∏—Ç–µ —Ñ–∞–π–ª—ã –≤ /etc, —Å–æ–¥–µ—Ä–∂–∞—â–∏–µ —Å–ª–æ–≤–æ "password" (–±–µ–∑ —É—á—ë—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞):
grep -ril "password" /etc/ 2>/dev/null
```

### –ó–∞–¥–∞–Ω–∏–µ 2: awk ‚Äî –æ–±—Ä–∞–±–æ—Ç–∫–∞ /etc/passwd

```bash
# 1. –í—ã–≤–µ–¥–∏—Ç–µ —Å–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –∏—Ö UID –∏ –¥–æ–º–∞—à–Ω–µ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–µ–π:
awk -F: '{printf "%-20s %5d  %s\n", $1, $3, $6}' /etc/passwd

# 2. –ü–æ–¥—Å—á–∏—Ç–∞–π—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø–æ —Ç–∏–ø–∞–º (—Å–∏—Å—Ç–µ–º–Ω—ã–µ/–æ–±—ã—á–Ω—ã–µ):
awk -F: '
BEGIN {sys=0; regular=0; nobody=0}
$3 == 65534 {nobody++; next}
$3 < 1000 {sys++; next}
{regular++}
END {
    print "–°–∏—Å—Ç–µ–º–Ω—ã—Ö:", sys
    print "–û–±—ã—á–Ω—ã—Ö:", regular
    print "Nobody:", nobody
}' /etc/passwd

# 3. –ù–∞–π–¥–∏—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º UID (–ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞):
awk -F: '{uid[$3] = uid[$3] " " $1}
END {
    for (u in uid)
        if (split(uid[u], a, " ") > 2)
            print "UID", u, ":", uid[u]
}' /etc/passwd
```

### –ó–∞–¥–∞–Ω–∏–µ 3: sed ‚Äî —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

```bash
# 1. –°–æ–∑–¥–∞–π—Ç–µ –∫–æ–ø–∏—é sshd_config —Å –±–µ–∑–æ–ø–∞—Å–Ω—ã–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏:
cp /etc/ssh/sshd_config /tmp/sshd_config_secure
sed -i '
    s/^#*PermitRootLogin.*/PermitRootLogin no/;
    s/^#*PasswordAuthentication.*/PasswordAuthentication no/;
    s/^#*X11Forwarding.*/X11Forwarding no/;
    s/^#*MaxAuthTries.*/MaxAuthTries 3/;
    s/^#*LoginGraceTime.*/LoginGraceTime 30/
' /tmp/sshd_config_secure

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è:
diff /etc/ssh/sshd_config /tmp/sshd_config_secure

# 2. –ò–∑–≤–ª–µ—á—å —Ç–æ–ª—å–∫–æ –∞–∫—Ç–∏–≤–Ω—ã–µ (—Ä–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ) –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:
sed '/^#/d; /^$/d' /etc/ssh/sshd_config
```

### –ó–∞–¥–∞–Ω–∏–µ 4: –ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–π –∞–Ω–∞–ª–∏–∑

–°–æ–∑–¥–∞–π—Ç–µ —Å–∫—Ä–∏–ø—Ç, –∫–æ—Ç–æ—Ä—ã–π:
1. –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç /var/log/auth.log
2. –ù–∞—Ö–æ–¥–∏—Ç IP —Å >5 –Ω–µ—É–¥–∞—á–Ω—ã–º–∏ –ø–æ–ø—ã—Ç–∫–∞–º–∏
3. –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç –≤—ã–≤–æ–¥ –≤ —Ç–∞–±–ª–∏—Ü—É
4. –°–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ —Ñ–∞–π–ª

```bash
#!/bin/bash
# –í–∞—à —Å–∫—Ä–∏–ø—Ç –∑–¥–µ—Å—å:
grep "Failed password" /var/log/auth.log | \
    grep -oE "([0-9]{1,3}\.){3}[0-9]{1,3}" | \
    sort | uniq -c | awk '$1 > 5' | sort -rn | \
    awk 'BEGIN{printf "%-8s %-16s\n", "–ü–æ–ø—ã—Ç–æ–∫", "IP-–∞–¥—Ä–µ—Å"; \
               print "-------- ----------------"}
         {printf "%-8d %-16s\n", $1, $2}' | \
    tee /tmp/brute_force_report.txt
```

---

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è grep:** `man grep`, `info grep`
- **GNU awk:** https://www.gnu.org/software/gawk/manual/
- **sed manual:** https://www.gnu.org/software/sed/manual/sed.html
- **Regex101:** https://regex101.com ‚Äî —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–≥—É–ª—è—Ä–Ω—ã—Ö –≤—ã—Ä–∞–∂–µ–Ω–∏–π
- **–ö–Ω–∏–≥–∞:** ¬´sed & awk¬ª O'Reilly, Dale Dougherty
- **Bash Cookbook:** O'Reilly ‚Äî –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–º–µ—Ä—ã
- **SANS Log Analysis:** https://www.sans.org/reading-room/whitepapers/logging/
- **–ü—Ä–∞–∫—Ç–∏–∫–∞:** `grep -r "" /var/log/` ‚Äî –∏–∑—É—á–∏—Ç–µ –ª–æ–≥–∏ —Å–≤–æ–µ–π —Å–∏—Å—Ç–µ–º—ã

---

## ‚úÖ –ò—Ç–æ–≥–∏ –≥–ª–∞–≤—ã

–í —ç—Ç–æ–π –≥–ª–∞–≤–µ –º—ã –æ—Å–≤–æ–∏–ª–∏ —Ç—Ä–∏ —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞ Unix:

1. **grep** ‚Äî –ø–æ–∏—Å–∫ –ø–æ —à–∞–±–ª–æ–Ω—É:
   - –§–ª–∞–≥–∏ `-r`, `-i`, `-v`, `-E`, `-P`, `-A`, `-B`, `-C`, `-o`
   - –†–µ–≥—É–ª—è—Ä–Ω—ã–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è –¥–ª—è –ø–æ–∏—Å–∫–∞ IP, URL, –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ –∞—Ç–∞–∫
   - –ê–Ω–∞–ª–∏–∑ auth.log –Ω–∞ –±—Ä—É—Ç—Ñ–æ—Ä—Å –∏ –∞–Ω–æ–º–∞–ª—å–Ω—ã–µ –≤—Ö–æ–¥—ã

2. **awk** ‚Äî –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö:
   - –†–∞–∑–±–∏–≤–∫–∞ –Ω–∞ –ø–æ–ª—è (`$1`, `$NF`, `-F:`)
   - –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ (`NR`, `NF`, `FILENAME`)
   - –ú–∞—Å—Å–∏–≤—ã –¥–ª—è –∞–≥—Ä–µ–≥–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö
   - –ü–∞—Ç—Ç–µ—Ä–Ω—ã `BEGIN` –∏ `END`
   - –ü–æ–¥—Å—á—ë—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–æ –ª–æ–≥–∞–º

3. **sed** ‚Äî –ø–æ—Ç–æ–∫–æ–≤–æ–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:
   - –ó–∞–º–µ–Ω–∞ (`s/old/new/g`), —É–¥–∞–ª–µ–Ω–∏–µ (`d`), –≤—Å—Ç–∞–≤–∫–∞ (`i`, `a`)
   - In-place —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (`-i`)
   - –•–∞—Ä–¥–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤

4. **–í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —É—Ç–∏–ª–∏—Ç—ã:** `cut`, `sort`, `uniq`, `wc`, `head`, `tail`

5. **–ö–æ–Ω–≤–µ–π–µ—Ä—ã –∏ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
   - `|` ‚Äî –ø–µ—Ä–µ–¥–∞—á–∞ –º–µ–∂–¥—É –∫–æ–º–∞–Ω–¥–∞–º–∏
   - `>`, `>>`, `2>` ‚Äî –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ—Ç–æ–∫–æ–≤
   - `tee` ‚Äî —Ä–∞–∑–¥–≤–æ–µ–Ω–∏–µ –ø–æ—Ç–æ–∫–∞
   - `xargs` ‚Äî –ø–µ—Ä–µ–¥–∞—á–∞ –∫–∞–∫ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤

6. **SOC-–ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è:** –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ IOC, –∞–Ω–∞–ª–∏–∑ –±—Ä—É—Ç—Ñ–æ—Ä—Å–∞, –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –≤–µ–±-–∞—Ç–∞–∫.

