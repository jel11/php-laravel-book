# –ì–ª–∞–≤–∞ 4.1: –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç Python –¥–ª—è PHP-—Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞

## üéØ –¶–µ–ª–∏ –≥–ª–∞–≤—ã

- –ü–æ–Ω—è—Ç—å –∫–ª—é—á–µ–≤—ã–µ —Å–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∏–µ –æ—Ç–ª–∏—á–∏—è Python –æ—Ç PHP
- –ù–∞—Å—Ç—Ä–æ–∏—Ç—å —Ä–∞–±–æ—á–µ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ Python –¥–ª—è –∑–∞–¥–∞—á –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- –û—Å–≤–æ–∏—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è venv –∏ –º–µ–Ω–µ–¥–∂–µ—Ä –ø–∞–∫–µ—Ç–æ–≤ pip
- –ù–∞—É—á–∏—Ç—å—Å—è —Ä–∞–±–æ—Ç–∞—Ç—å —Å —Ç–∏–ø–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö, —Ñ—É–Ω–∫—Ü–∏—è–º–∏ –∏ –û–û–ü –≤ Python
- –ü—Ä–∏–º–µ–Ω—è—Ç—å f-strings, list comprehensions –∏ —Å–ª–æ–≤–∞—Ä–∏
- –†–∞–±–æ—Ç–∞—Ç—å —Å —Ñ–∞–π–ª–∞–º–∏, –∏—Å–∫–ª—é—á–µ–Ω–∏—è–º–∏ –∏ –º–æ–¥—É–ª—è–º–∏
- –ë—ã—Ç—å –≥–æ—Ç–æ–≤—ã–º –ø–∏—Å–∞—Ç—å –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –Ω–∞ Python —É–∂–µ –≤ —Å–ª–µ–¥—É—é—â–µ–π –≥–ª–∞–≤–µ

---

## 4.1.1 –ü–æ—á–µ–º—É Python ‚Äî —è–∑—ã–∫ –Ω–æ–º–µ—Ä –æ–¥–∏–Ω –≤ –∫–∏–±–µ—Ä–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

–ï—Å–ª–∏ –≤—ã PHP-—Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫, —á–∏—Ç–∞—é—â–∏–π –∫–Ω–∏–≥—É –ø–æ –∫–∏–±–µ—Ä–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏, –≤—ã –Ω–µ–∏–∑–±–µ–∂–Ω–æ —Å—Ç–æ–ª–∫–Ω—ë—Ç–µ—Å—å —Å Python. –ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –Ω–∞–ø–∏—Å–∞–Ω–æ –∏–º–µ–Ω–Ω–æ –Ω–∞ –Ω—ë–º: Metasploit –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Ruby, –Ω–æ –µ–≥–æ —Å–∫—Ä–∏–ø—Ç—ã ‚Äî Python; Scapy, Impacket, SQLMap, Volatility, Burp Suite Extensions ‚Äî –≤—Å—ë —ç—Ç–æ Python. OSCP, CEH, PNPT ‚Äî —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Ç—Ä–µ–±—É—é—Ç Python.

**–ü–æ—á–µ–º—É Python —Å—Ç–∞–ª —Å—Ç–∞–Ω–¥–∞—Ä—Ç–æ–º –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:**

1. **–ë–æ–≥–∞—Ç–∞—è —ç–∫–æ—Å–∏—Å—Ç–µ–º–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫** ‚Äî requests, scapy, paramiko, impacket, cryptography
2. **–°–∫–æ—Ä–æ—Å—Ç—å —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏** ‚Äî –ø—Ä–æ—Ç–æ—Ç–∏–ø –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞ –∑–∞ —á–∞—Å
3. **–ß–∏—Ç–∞–µ–º–æ—Å—Ç—å –∫–æ–¥–∞** ‚Äî –ª–µ–≥–∫–æ –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å —á—É–∂–∏–µ —ç–∫—Å–ø–ª–æ–π—Ç—ã
4. **–ö—Ä–æ—Å—Å–ø–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω–æ—Å—Ç—å** ‚Äî —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ Linux, Windows, macOS
5. **–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π —Ä–µ–∂–∏–º** ‚Äî –±—ã—Å—Ç—Ä–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–¥–µ–π –≤ REPL
6. **CTF –∏ PoC** ‚Äî –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –≤–µ—Å—å –ø—É–±–ª–∏—á–Ω—ã–π –∫–æ–¥ –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –Ω–∞ Python

–î–ª—è PHP-—Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞ –ø–µ—Ä–µ—Ö–æ–¥ –Ω–∞ Python ‚Äî —ç—Ç–æ –Ω–µ –∏–∑—É—á–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —è–∑—ã–∫–∞ —Å –Ω—É–ª—è. –≠—Ç–æ –∏–∑—É—á–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —Å–æ–≥–ª–∞—à–µ–Ω–∏–π. –ö–æ–Ω—Ü–µ–ø—Ü–∏–∏ –≤–∞–º —É–∂–µ –∑–Ω–∞–∫–æ–º—ã.

---

## 4.1.2 –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ Python

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–µ—Ä—Å–∏—é Python
python3 --version
# Python 3.11.5

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å pip
pip3 --version
# pip 23.2.1

# –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π —Ä–µ–∂–∏–º (–∞–Ω–∞–ª–æ–≥ php -a)
python3
>>> print("Hello, Security!")
>>> exit()
```

> **–í–∞–∂–Ω–æ:** –í 2024 –≥–æ–¥—É Python 2 –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ —É—Å—Ç–∞—Ä–µ–ª. –í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `python3`. –í –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö –∫–æ–º–∞–Ω–¥–∞ `python` –º–æ–∂–µ—Ç —É–∫–∞–∑—ã–≤–∞—Ç—å –Ω–∞ Python 2. –ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ –≤–µ—Ä—Å–∏—é –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º —Å–∫—Ä–∏–ø—Ç–æ–≤.

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Python –Ω–∞ —Ä–∞–∑–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö

```bash
# Ubuntu/Debian
sudo apt update && sudo apt install python3 python3-pip python3-venv

# CentOS/RHEL
sudo yum install python3 python3-pip

# macOS (—á–µ—Ä–µ–∑ Homebrew)
brew install python3

# Windows ‚Äî —Å–∫–∞—á–∞—Ç—å —Å python.org, –¥–æ–±–∞–≤–∏—Ç—å –≤ PATH
```

### –ü–µ—Ä–≤—ã–π —Å–∫—Ä–∏–ø—Ç

```python
#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
–ú–æ–π –ø–µ—Ä–≤—ã–π —Å–∫—Ä–∏–ø—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏.
–ê–≤—Ç–æ—Ä: Security Researcher
"""

# PHP: echo "Hello, World!\n";
print("Hello, Security World!")

# PHP: $name = "Hacker";
name = "Hacker"

# PHP: echo "Hello, $name!\n";
print(f"Hello, {name}!")
```

```bash
# –ó–∞–ø—É—Å–∫ (–∞–Ω–∞–ª–æ–≥ php script.php)
python3 hello.py

# –°–¥–µ–ª–∞—Ç—å –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º
chmod +x hello.py
./hello.py
```

---

## 4.1.3 –í–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è ‚Äî venv –∏ pip

–í PHP –≤—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ Composer –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏ –ø—Ä–æ–µ–∫—Ç–∞. –í Python –¥–ª—è —ç—Ç–æ–≥–æ —Å–ª—É–∂–∞—Ç –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (virtual environments) –∏ pip.

**–ü—Ä–æ–±–ª–µ–º–∞ –±–µ–∑ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è:** –≤—Å–µ –ø–∞–∫–µ—Ç—ã —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è –≥–ª–æ–±–∞–ª—å–Ω–æ. –ü—Ä–æ–µ–∫—Ç A —Ç—Ä–µ–±—É–µ—Ç requests==2.28, –ø—Ä–æ–µ–∫—Ç B —Ç—Ä–µ–±—É–µ—Ç requests==2.31 ‚Äî –∫–æ–Ω—Ñ–ª–∏–∫—Ç.

**–†–µ—à–µ–Ω–∏–µ:** –∫–∞–∂–¥—ã–π –ø—Ä–æ–µ–∫—Ç –ø–æ–ª—É—á–∞–µ—Ç —Å–≤–æ—ë –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ.

```bash
# PHP –∞–Ω–∞–ª–æ–≥–∏—è:
# composer init          ‚Üí python3 -m venv venv
# composer install       ‚Üí pip install -r requirements.txt
# vendor/                ‚Üí venv/
# composer.json          ‚Üí requirements.txt
# composer.lock          ‚Üí pip freeze > requirements.txt

# –°–æ–∑–¥–∞—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
python3 -m venv venv

# –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å (Linux/macOS)
source venv/bin/activate

# –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å (Windows)
venv\Scripts\activate

# –ü–æ—Å–ª–µ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ ‚Äî –≤ —Å–∫–æ–±–∫–∞—Ö –ø–æ—è–≤–∏—Ç—Å—è (venv)
(venv) $ python --version
(venv) $ pip --version

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–∞–∫–µ—Ç—ã
(venv) $ pip install requests
(venv) $ pip install scapy paramiko cryptography

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏–∑ —Ñ–∞–π–ª–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
(venv) $ pip install -r requirements.txt

# –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
(venv) $ pip freeze > requirements.txt

# –°–ø–∏—Å–æ–∫ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö –ø–∞–∫–µ—Ç–æ–≤
(venv) $ pip list

# –î–µ–∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –æ–∫—Ä—É–∂–µ–Ω–∏–µ
(venv) $ deactivate
```

### –¢–∏–ø–∏—á–Ω—ã–π —Ñ–∞–π–ª requirements.txt –¥–ª—è –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

```text
requests==2.31.0
scapy==2.5.0
paramiko==3.3.1
cryptography==41.0.5
python-nmap==0.7.1
impacket==0.11.0
colorama==0.4.6
tabulate==0.9.0
```

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

```
my-security-tool/
‚îú‚îÄ‚îÄ venv/                  # –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ (–≤ .gitignore!)
‚îú‚îÄ‚îÄ requirements.txt       # –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (–∫–∞–∫ composer.json)
‚îú‚îÄ‚îÄ README.md
‚îú‚îÄ‚îÄ main.py                # —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞
‚îú‚îÄ‚îÄ tools/                 # –º–æ–¥—É–ª–∏ (–∫–∞–∫ src/ –≤ PHP)
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py        # –¥–µ–ª–∞–µ—Ç –ø–∞–ø–∫—É –ø–∞–∫–µ—Ç–æ–º (–∫–∞–∫ autoload)
‚îÇ   ‚îú‚îÄ‚îÄ scanner.py
‚îÇ   ‚îî‚îÄ‚îÄ parser.py
‚îî‚îÄ‚îÄ tests/
    ‚îî‚îÄ‚îÄ test_scanner.py
```

---

## 4.1.4 –°–∏–Ω—Ç–∞–∫—Å–∏—Å Python vs PHP: –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏ —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ

```php
<?php
// PHP: —Ç–∏–ø–∏–∑–∞—Ü–∏—è –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞
$name = "Alice";
$age = 30;
$salary = 99.5;
$isHacker = true;
$nothing = null;

// –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–∞
echo gettype($name);  // string
var_dump($age);       // int(30)
```

```python
# Python: —Ç–æ –∂–µ —Å–∞–º–æ–µ, –±–µ–∑ $ –∏ ;
name = "Alice"
age = 30
salary = 99.5
is_hacker = True    # –í–Ω–∏–º–∞–Ω–∏–µ: True —Å –±–æ–ª—å—à–æ–π –±—É–∫–≤—ã!
nothing = None      # None, –∞ –Ω–µ null

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–∞
print(type(name))   # <class 'str'>
print(type(age))    # <class 'int'>
isinstance(age, int)  # True ‚Äî –∞–Ω–∞–ª–æ–≥ is_int() –≤ PHP
```

### –°—Ç—Ä–æ–∫–∏

```php
<?php
// PHP —Å—Ç—Ä–æ–∫–∏
$ip = "192.168.1.1";
$port = 80;

// –ö–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏—è
$result = "Target: " . $ip . ":" . $port;

// –ò–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏—è (–¥–≤–æ–π–Ω—ã–µ –∫–∞–≤—ã—á–∫–∏)
$result = "Target: {$ip}:{$port}";

// –ú–Ω–æ–≥–æ—Å—Ç—Ä–æ—á–Ω–∞—è —Å—Ç—Ä–æ–∫–∞
$banner = "HTTP/1.1 200 OK
Server: Apache
Content-Type: text/html";

// –î–ª–∏–Ω–∞ —Å—Ç—Ä–æ–∫–∏
echo strlen($ip);  // 11

// –°—Ä–µ–∑ —Å—Ç—Ä–æ–∫–∏
echo substr($ip, 0, 3);  // "192"

// –ü–æ–∏—Å–∫
echo strpos($ip, ".");  // 3
```

```python
# Python —Å—Ç—Ä–æ–∫–∏
ip = "192.168.1.1"
port = 80

# –ö–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏—è (—á–µ—Ä–µ–∑ + –∏–ª–∏ join)
result = "Target: " + ip + ":" + str(port)

# f-strings (Python 3.6+) ‚Äî —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π —Å–ø–æ—Å–æ–±
result = f"Target: {ip}:{port}"

# format() ‚Äî —Å—Ç–∞—Ä—ã–π —Å–ø–æ—Å–æ–±
result = "Target: {}:{}".format(ip, port)

# % ‚Äî –æ—á–µ–Ω—å —Å—Ç–∞—Ä—ã–π —Å–ø–æ—Å–æ–± (–≤—Å—Ç—Ä–µ—á–∞–µ—Ç—Å—è –≤ legacy)
result = "Target: %s:%d" % (ip, port)

# –ú–Ω–æ–≥–æ—Å—Ç—Ä–æ—á–Ω–∞—è —Å—Ç—Ä–æ–∫–∞ (—Ç—Ä–æ–π–Ω—ã–µ –∫–∞–≤—ã—á–∫–∏)
banner = """HTTP/1.1 200 OK
Server: Apache
Content-Type: text/html"""

# –î–ª–∏–Ω–∞ —Å—Ç—Ä–æ–∫–∏
len(ip)        # 11

# –°—Ä–µ–∑ —Å—Ç—Ä–æ–∫–∏ (slice notation) ‚Äî –º–æ—â–Ω–∞—è —Ñ–∏—á–∞ Python!
ip[0:3]        # "192"
ip[:3]         # "192" ‚Äî —Ç–æ –∂–µ —Å–∞–º–æ–µ
ip[-1]         # "1" ‚Äî –ø–æ—Å–ª–µ–¥–Ω–∏–π —Å–∏–º–≤–æ–ª
ip[::2]        # –∫–∞–∂–¥—ã–π –≤—Ç–æ—Ä–æ–π —Å–∏–º–≤–æ–ª

# –ü–æ–∏—Å–∫
ip.find(".")   # 3
ip.index(".")  # 3 (–±—Ä–æ—Å–∞–µ—Ç –∏—Å–∫–ª—é—á–µ–Ω–∏–µ –µ—Å–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ)
"." in ip      # True ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤—Ö–æ–∂–¥–µ–Ω–∏—è

# –ú–µ—Ç–æ–¥—ã —Å—Ç—Ä–æ–∫
ip.upper()           # "192.168.1.1" (–Ω–µ –º–µ–Ω—è–µ—Ç—Å—è ‚Äî —É–∂–µ –±–µ–∑ –±—É–∫–≤)
"apache".upper()     # "APACHE"
"  spaces  ".strip() # "spaces"
"a,b,c".split(",")   # ["a", "b", "c"]
",".join(["a","b"])  # "a,b"
ip.startswith("192") # True
ip.endswith(".1")    # True
ip.replace(".", "-") # "192-168-1-1"
```

### –ß–∏—Å–ª–∞

```php
<?php
$decimal = 42;
$float = 3.14;
$hex = 0xFF;
$binary = 0b1010;
$octal = 0777;

echo intdiv(10, 3);  // 3
echo 10 % 3;         // 1
echo 2 ** 8;         // 256
```

```python
decimal = 42
float_num = 3.14
hex_num = 0xFF        # 255
binary_num = 0b1010   # 10
octal_num = 0o777     # 511

# –¶–µ–ª–æ—á–∏—Å–ª–µ–Ω–Ω–æ–µ –¥–µ–ª–µ–Ω–∏–µ
10 // 3    # 3
10 % 3     # 1
2 ** 8     # 256 ‚Äî —Å—Ç–µ–ø–µ–Ω—å
abs(-5)    # 5

# Python –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –æ–≥—Ä–æ–º–Ω—ã–µ —á–∏—Å–ª–∞ –Ω–∞—Ç–∏–≤–Ω–æ
big = 2 ** 256  # –Ω–∏–∫–∞–∫–∏—Ö bcmath –Ω–µ –Ω—É–∂–Ω–æ!

# –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ —Ç–∏–ø–æ–≤
int("42")       # 42
int("0xFF", 16) # 255 ‚Äî –∏–∑ hex-—Å—Ç—Ä–æ–∫–∏
float("3.14")   # 3.14
str(42)         # "42"
hex(255)        # "0xff"
bin(10)         # "0b1010"
ord("A")        # 65 ‚Äî —Å–∏–º–≤–æ–ª ‚Üí ASCII –∫–æ–¥
chr(65)         # "A" ‚Äî ASCII –∫–æ–¥ ‚Üí —Å–∏–º–≤–æ–ª
```

---

## 4.1.5 –°—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö: —Å–ø–∏—Å–∫–∏, –∫–æ—Ä—Ç–µ–∂–∏, —Å–ª–æ–≤–∞—Ä–∏, –º–Ω–æ–∂–µ—Å—Ç–≤–∞

### –°–ø–∏—Å–∫–∏ (Lists) ‚Äî –∞–Ω–∞–ª–æ–≥ –º–∞—Å—Å–∏–≤–æ–≤ PHP

```php
<?php
// PHP –∏–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –º–∞—Å—Å–∏–≤
$ports = [80, 443, 22, 21, 25];
$ports[] = 8080;         // –¥–æ–±–∞–≤–∏—Ç—å
$ports[0] = 81;          // –∏–∑–º–µ–Ω–∏—Ç—å
echo count($ports);      // –¥–ª–∏–Ω–∞
echo implode(",", $ports); // –æ–±—ä–µ–¥–∏–Ω–∏—Ç—å
array_push($ports, 3306);
array_pop($ports);
sort($ports);
$slice = array_slice($ports, 0, 3);
```

```python
# Python —Å–ø–∏—Å–æ–∫
ports = [80, 443, 22, 21, 25]
ports.append(8080)      # –¥–æ–±–∞–≤–∏—Ç—å –≤ –∫–æ–Ω–µ—Ü
ports.insert(0, 81)     # –≤—Å—Ç–∞–≤–∏—Ç—å –ø–æ –∏–Ω–¥–µ–∫—Å—É
ports[0] = 90           # –∏–∑–º–µ–Ω–∏—Ç—å —ç–ª–µ–º–µ–Ω—Ç
len(ports)              # –¥–ª–∏–Ω–∞
",".join(str(p) for p in ports)  # –æ–±—ä–µ–¥–∏–Ω–∏—Ç—å
ports.pop()             # —É–¥–∞–ª–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–π
ports.pop(0)            # —É–¥–∞–ª–∏—Ç—å –ø–æ –∏–Ω–¥–µ–∫—Å—É
ports.remove(443)       # —É–¥–∞–ª–∏—Ç—å –ø–æ –∑–Ω–∞—á–µ–Ω–∏—é
ports.sort()            # —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –Ω–∞ –º–µ—Å—Ç–µ
sorted(ports)           # –Ω–æ–≤—ã–π –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫
ports[0:3]              # —Å—Ä–µ–∑ ‚Äî –ø–µ—Ä–≤—ã–µ 3 —ç–ª–µ–º–µ–Ω—Ç–∞
ports[-3:]              # –ø–æ—Å–ª–µ–¥–Ω–∏–µ 3 —ç–ª–µ–º–µ–Ω—Ç–∞
22 in ports             # True ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤—Ö–æ–∂–¥–µ–Ω–∏—è
ports.count(80)         # –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤—Ö–æ–∂–¥–µ–Ω–∏–π
ports.index(22)         # –∏–Ω–¥–µ–∫—Å —ç–ª–µ–º–µ–Ω—Ç–∞
ports.reverse()         # —Ä–µ–≤–µ—Ä—Å –Ω–∞ –º–µ—Å—Ç–µ
ports.extend([8080, 8443])  # —Ä–∞—Å—à–∏—Ä–∏—Ç—å –¥—Ä—É–≥–∏–º —Å–ø–∏—Å–∫–æ–º

# –°–æ–∑–¥–∞–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –∏–∑ –¥–∏–∞–ø–∞–∑–æ–Ω–∞
range(1, 11)            # 1..10
list(range(1, 11))      # [1, 2, 3, ..., 10]

# –†–∞—Å–ø–∞–∫–æ–≤–∫–∞
first, *rest = ports
first, second, *tail = ports
```

### –ö–æ—Ä—Ç–µ–∂–∏ (Tuples) ‚Äî –Ω–µ–∏–∑–º–µ–Ω—è–µ–º—ã–µ —Å–ø–∏—Å–∫–∏

```python
# –ö–æ—Ä—Ç–µ–∂ ‚Äî –∫–∞–∫ —Å–ø–∏—Å–æ–∫, –Ω–æ –Ω–µ–∏–∑–º–µ–Ω—è–µ–º—ã–π
# –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –≤–æ–∑–≤—Ä–∞—Ç–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∑–Ω–∞—á–µ–Ω–∏–π –∏–∑ —Ñ—É–Ω–∫—Ü–∏–∏
coordinates = (192, 168, 1, 1)
host, port = ("192.168.1.1", 80)  # —Ä–∞—Å–ø–∞–∫–æ–≤–∫–∞

# –ü—Ä–∏–º–µ—Ä –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏: —Å–ø–∏—Å–æ–∫ –æ—Ç–∫—Ä—ã—Ç—ã—Ö –ø–æ—Ä—Ç–æ–≤ (–Ω–µ –º–µ–Ω—è–µ—Ç—Å—è)
COMMON_PORTS = (21, 22, 23, 25, 53, 80, 110, 143, 443, 3306, 3389, 8080)
```

### –°–ª–æ–≤–∞—Ä–∏ (Dictionaries) ‚Äî –∞—Å—Å–æ—Ü–∏–∞—Ç–∏–≤–Ω—ã–µ –º–∞—Å—Å–∏–≤—ã PHP

```php
<?php
// PHP –∞—Å—Å–æ—Ü–∏–∞—Ç–∏–≤–Ω—ã–π –º–∞—Å—Å–∏–≤
$host = [
    "ip" => "192.168.1.1",
    "port" => 80,
    "service" => "http",
    "open" => true
];

echo $host["ip"];           // –¥–æ—Å—Ç—É–ø
$host["os"] = "Linux";      // –¥–æ–±–∞–≤–∏—Ç—å
unset($host["open"]);       // —É–¥–∞–ª–∏—Ç—å
isset($host["port"]);       // –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–ª–∏—á–∏–µ
array_keys($host);          // –∫–ª—é—á–∏
array_values($host);        // –∑–Ω–∞—á–µ–Ω–∏—è
```

```python
# Python —Å–ª–æ–≤–∞—Ä—å
host = {
    "ip": "192.168.1.1",
    "port": 80,
    "service": "http",
    "open": True
}

host["ip"]              # –¥–æ—Å—Ç—É–ø: "192.168.1.1"
host["os"] = "Linux"    # –¥–æ–±–∞–≤–∏—Ç—å/–∏–∑–º–µ–Ω–∏—Ç—å
del host["open"]        # —É–¥–∞–ª–∏—Ç—å
"port" in host          # True ‚Äî –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–ª–∏—á–∏–µ –∫–ª—é—á–∞
host.keys()             # –∫–ª—é—á–∏
host.values()           # –∑–Ω–∞—á–µ–Ω–∏—è
host.items()            # –ø–∞—Ä—ã (–∫–ª—é—á, –∑–Ω–∞—á–µ–Ω–∏–µ)

# get() ‚Äî –±–µ–∑–æ–ø–∞—Å–Ω—ã–π –¥–æ—Å—Ç—É–ø (–Ω–µ –±—Ä–æ—Å–∞–µ—Ç –∏—Å–∫–ª—é—á–µ–Ω–∏–µ)
host.get("port")        # 80
host.get("missing")     # None
host.get("missing", 0)  # 0 ‚Äî –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é

# update() ‚Äî –æ–±–Ω–æ–≤–∏—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –ø–∞—Ä–∞–º–∏
host.update({"status": "active", "latency": 12})

# –°–ª–æ–≤–∞—Ä—å –∏–∑ –¥–≤—É—Ö —Å–ø–∏—Å–∫–æ–≤
keys = ["ip", "port", "service"]
values = ["192.168.1.1", 80, "http"]
host = dict(zip(keys, values))

# –í–ª–æ–∂–µ–Ω–Ω—ã–µ —Å–ª–æ–≤–∞—Ä–∏ ‚Äî –¥–ª—è –æ—Ç—á—ë—Ç–æ–≤ –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
scan_result = {
    "192.168.1.1": {
        "open_ports": [22, 80, 443],
        "os": "Linux",
        "services": {22: "ssh", 80: "http", 443: "https"}
    },
    "192.168.1.2": {
        "open_ports": [3389],
        "os": "Windows",
        "services": {3389: "rdp"}
    }
}

# –î–æ—Å—Ç—É–ø –∫ –≤–ª–æ–∂–µ–Ω–Ω—ã–º –¥–∞–Ω–Ω—ã–º
scan_result["192.168.1.1"]["services"][22]  # "ssh"
```

### –ú–Ω–æ–∂–µ—Å—Ç–≤–∞ (Sets) ‚Äî –¥–ª—è —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π

```python
# –ú–Ω–æ–∂–µ—Å—Ç–≤–æ ‚Äî —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã, –±–µ–∑ –ø–æ—Ä—è–¥–∫–∞
# –ê–Ω–∞–ª–æ–≥ array_unique() –≤ PHP, –Ω–æ –±–æ–ª–µ–µ –º–æ—â–Ω—ã–π

found_ips = {"192.168.1.1", "10.0.0.1", "192.168.1.1"}
# {"192.168.1.1", "10.0.0.1"} ‚Äî –¥—É–±–ª–∏–∫–∞—Ç —É–¥–∞–ª—ë–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

found_ips.add("172.16.0.1")       # –¥–æ–±–∞–≤–∏—Ç—å
found_ips.discard("10.0.0.1")     # —É–¥–∞–ª–∏—Ç—å (–±–µ–∑ –∏—Å–∫–ª—é—á–µ–Ω–∏—è)

# –¢–µ–æ—Ä–µ—Ç–∏–∫–æ-–º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ ‚Äî –ø–æ–ª–µ–∑–Ω—ã –ø—Ä–∏ –∞–Ω–∞–ª–∏–∑–µ –ª–æ–≥–æ–≤
set_a = {1, 2, 3, 4}
set_b = {3, 4, 5, 6}

set_a | set_b    # –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ: {1, 2, 3, 4, 5, 6}
set_a & set_b    # –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏–µ: {3, 4}
set_a - set_b    # —Ä–∞–∑–Ω–æ—Å—Ç—å: {1, 2}
set_a ^ set_b    # —Å–∏–º–º–µ—Ç—Ä–∏—á–Ω–∞—è —Ä–∞–∑–Ω–æ—Å—Ç—å: {1, 2, 5, 6}

# –ü—Ä–∏–º–µ—Ä: –Ω–∞–π—Ç–∏ IP, –∫–æ—Ç–æ—Ä—ã–µ –∞—Ç–∞–∫–æ–≤–∞–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–µ—Ä–≤–∏—Å–æ–≤
ssh_attackers = {"1.2.3.4", "5.6.7.8", "9.10.11.12"}
web_attackers = {"5.6.7.8", "13.14.15.16", "1.2.3.4"}
both = ssh_attackers & web_attackers  # {"1.2.3.4", "5.6.7.8"}
```

---

## 4.1.6 –£–ø—Ä–∞–≤–ª—è—é—â–∏–µ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏

### –£—Å–ª–æ–≤–∏—è

```php
<?php
$port = 80;

if ($port == 80) {
    echo "HTTP";
} elseif ($port == 443) {
    echo "HTTPS";
} else {
    echo "Unknown";
}

// –¢–µ—Ä–Ω–∞—Ä–Ω—ã–π –æ–ø–µ—Ä–∞—Ç–æ—Ä
$proto = ($port == 443) ? "https" : "http";
```

```python
port = 80

if port == 80:
    print("HTTP")
elif port == 443:          # elif, –Ω–µ elseif!
    print("HTTPS")
else:
    print("Unknown")

# –¢–µ—Ä–Ω–∞—Ä–Ω—ã–π –æ–ø–µ—Ä–∞—Ç–æ—Ä
proto = "https" if port == 443 else "http"

# match-case (Python 3.10+) ‚Äî –∞–Ω–∞–ª–æ–≥ switch
match port:
    case 22:
        service = "SSH"
    case 80:
        service = "HTTP"
    case 443:
        service = "HTTPS"
    case 3306 | 5432:      # –Ω–µ—Å–∫–æ–ª—å–∫–æ –∑–Ω–∞—á–µ–Ω–∏–π —á–µ—Ä–µ–∑ |
        service = "Database"
    case _:                # default
        service = "Unknown"

# –¶–µ–ø–æ—á–∫–∞ —Å—Ä–∞–≤–Ω–µ–Ω–∏–π ‚Äî —É–Ω–∏–∫–∞–ª—å–Ω–∞—è —Ñ–∏—á–∞ Python
1 <= port <= 1024          # True ‚Äî –ø—Ä–∏–≤–∏–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ—Ä—Ç—ã
# –í PHP: $port >= 1 && $port <= 1024

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–æ–≤ –∏ –∑–Ω–∞—á–µ–Ω–∏–π
port is None               # –∏–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç—å (not ==)
port is not None
not (port == 0)
```

### –¶–∏–∫–ª—ã

```php
<?php
// PHP for
for ($i = 0; $i < 10; $i++) {
    echo $i;
}

// PHP foreach
$ports = [80, 443, 22];
foreach ($ports as $port) {
    echo $port;
}
foreach ($ports as $index => $port) {
    echo "$index: $port";
}

// PHP while
while ($condition) {
    // ...
    break;
    continue;
}
```

```python
# Python for ‚Äî –∏—Ç–µ—Ä–∏—Ä—É–µ—Ç –ø–æ –ª—é–±–æ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
ports = [80, 443, 22]
for port in ports:
    print(port)

# –° –∏–Ω–¥–µ–∫—Å–æ–º ‚Äî enumerate() –≤–º–µ—Å—Ç–æ foreach with key
for index, port in enumerate(ports):
    print(f"{index}: {port}")

# –î–∏–∞–ø–∞–∑–æ–Ω —á–∏—Å–µ–ª
for i in range(10):        # 0..9
    print(i)

for i in range(1, 11):     # 1..10
    print(i)

for i in range(0, 100, 10):  # 0,10,20,...,90
    print(i)

# –ò—Ç–µ—Ä–∞—Ü–∏—è –ø–æ —Å–ª–æ–≤–∞—Ä—é
host = {"ip": "192.168.1.1", "port": 80}
for key in host:           # —Ç–æ–ª—å–∫–æ –∫–ª—é—á–∏
    print(key)

for key, value in host.items():  # –ø–∞—Ä—ã
    print(f"{key} = {value}")

# while
attempts = 0
while attempts < 3:
    attempts += 1
    if attempts == 2:
        continue           # –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å –∏—Ç–µ—Ä–∞—Ü–∏—é
    print(f"Attempt {attempts}")
else:
    # else –ø—Ä–∏ —Ü–∏–∫–ª–µ ‚Äî –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –µ—Å–ª–∏ –Ω–µ –±—ã–ª–æ break
    print("All attempts done")

# for —Å else ‚Äî –ø–æ–ª–µ–∑–Ω–æ –ø—Ä–∏ –ø–æ–∏—Å–∫–µ
for port in ports:
    if port == 443:
        print("HTTPS found!")
        break
else:
    print("HTTPS not found")  # —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ break –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª
```

---

## 4.1.7 –§—É–Ω–∫—Ü–∏–∏ –≤ Python

```php
<?php
// PHP —Ñ—É–Ω–∫—Ü–∏—è
function scanPort($host, $port, $timeout = 1) {
    // ...
    return true;
}

// –ò–º–µ–Ω–æ–≤–∞–Ω–Ω—ã–µ –∞—Ä–≥—É–º–µ–Ω—Ç—ã (PHP 8.0+)
scanPort(host: "192.168.1.1", port: 80);

// –ü–µ—Ä–µ–º–µ–Ω–Ω–æ–µ —á–∏—Å–ª–æ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤
function logPorts(...$ports) {
    foreach ($ports as $port) {
        echo $port;
    }
}
```

```python
# Python —Ñ—É–Ω–∫—Ü–∏—è
def scan_port(host, port, timeout=1):   # snake_case!
    # ...
    return True

# –í—ã–∑–æ–≤ —Å –∏–º–µ–Ω–æ–≤–∞–Ω–Ω—ã–º–∏ –∞—Ä–≥—É–º–µ–Ω—Ç–∞–º–∏
scan_port(host="192.168.1.1", port=80)
scan_port("192.168.1.1", port=80, timeout=2)

# *args ‚Äî –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–µ —á–∏—Å–ª–æ –ø–æ–∑–∏—Ü–∏–æ–Ω–Ω—ã—Ö –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤
def log_ports(*ports):
    for port in ports:
        print(port)

log_ports(80, 443, 22, 21)

# **kwargs ‚Äî –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–µ —á–∏—Å–ª–æ –∏–º–µ–Ω–æ–≤–∞–Ω–Ω—ã—Ö –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤
def create_request(**options):
    print(options)  # {'method': 'GET', 'url': '...'}

create_request(method="GET", url="http://example.com", timeout=5)

# –ê–Ω–Ω–æ—Ç–∞—Ü–∏–∏ —Ç–∏–ø–æ–≤ (Type Hints) ‚Äî Python 3.5+
# –ù–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã, –Ω–æ —É–ª—É—á—à–∞—é—Ç —á–∏—Ç–∞–µ–º–æ—Å—Ç—å
def scan_port(host: str, port: int, timeout: float = 1.0) -> bool:
    """
    –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, –æ—Ç–∫—Ä—ã—Ç –ª–∏ –ø–æ—Ä—Ç –Ω–∞ —Ö–æ—Å—Ç–µ.
    
    Args:
        host: IP-–∞–¥—Ä–µ—Å –∏–ª–∏ –¥–æ–º–µ–Ω–Ω–æ–µ –∏–º—è
        port: –ù–æ–º–µ—Ä –ø–æ—Ä—Ç–∞ (1-65535)
        timeout: –¢–∞–π–º–∞—É—Ç –≤ —Å–µ–∫—É–Ω–¥–∞—Ö
    
    Returns:
        True –µ—Å–ª–∏ –ø–æ—Ä—Ç –æ—Ç–∫—Ä—ã—Ç, False –∏–Ω–∞—á–µ
    """
    return True

from typing import List, Dict, Optional, Tuple

def parse_hosts(data: str) -> List[Dict[str, str]]:
    return []

def get_service(port: int) -> Optional[str]:
    return None

# –í–æ–∑–≤—Ä–∞—Ç –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∑–Ω–∞—á–µ–Ω–∏–π (–Ω–∞ —Å–∞–º–æ–º –¥–µ–ª–µ –∫–æ—Ä—Ç–µ–∂)
def get_host_info(ip: str) -> Tuple[str, int, bool]:
    hostname = "example.com"
    latency = 15
    is_alive = True
    return hostname, latency, is_alive  # –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–æ—Ä—Ç–µ–∂

# –†–∞—Å–ø–∞–∫–æ–≤–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
hostname, latency, is_alive = get_host_info("192.168.1.1")

# Lambda ‚Äî –∞–Ω–æ–Ω–∏–º–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ (–∞–Ω–∞–ª–æ–≥ PHP arrow functions)
# PHP: $double = fn($x) => $x * 2;
double = lambda x: x * 2
double(5)  # 10

# –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–µ –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏
hosts = [{"ip": "192.168.1.1", "port": 80}, {"ip": "10.0.0.1", "port": 22}]
hosts.sort(key=lambda h: h["port"])
open_ports = list(filter(lambda p: p > 1024, [80, 443, 8080, 3000]))
doubled = list(map(lambda p: p * 2, [40, 221, 11]))
```

---

## 4.1.8 List Comprehensions –∏ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä—ã

List Comprehensions ‚Äî –æ–¥–Ω–∞ –∏–∑ —Å–∞–º—ã—Ö –º–æ—â–Ω—ã—Ö –∏ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–Ω—ã—Ö –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–µ–π Python. –≠—Ç–æ –∫–æ–º–ø–∞–∫—Ç–Ω—ã–π —Å–ø–æ—Å–æ–± —Å–æ–∑–¥–∞—Ç—å —Å–ø–∏—Å–æ–∫ –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥—Ä—É–≥–æ–≥–æ —Å–ø–∏—Å–∫–∞.

```php
<?php
// PHP: —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∏ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –º–∞—Å—Å–∏–≤–∞
$ports = [80, 22, 443, 21, 8080, 3306];

// –ù–∞–π—Ç–∏ –ø—Ä–∏–≤–∏–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ—Ä—Ç—ã
$privileged = array_filter($ports, fn($p) => $p < 1024);

// –£–¥–≤–æ–∏—Ç—å –≤—Å–µ –ø–æ—Ä—Ç—ã
$doubled = array_map(fn($p) => $p * 2, $ports);

// –ö–æ–º–±–∏–Ω–∞—Ü–∏—è: –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –∏ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å
$result = array_map(
    fn($p) => "port_$p",
    array_filter($ports, fn($p) => $p < 1024)
);
```

```python
# Python List Comprehension: [–≤—ã—Ä–∞–∂–µ–Ω–∏–µ for —ç–ª–µ–º–µ–Ω—Ç in –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å if —É—Å–ª–æ–≤–∏–µ]
ports = [80, 22, 443, 21, 8080, 3306]

# –ù–∞–π—Ç–∏ –ø—Ä–∏–≤–∏–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ—Ä—Ç—ã
privileged = [p for p in ports if p < 1024]
# [80, 22, 443, 21]

# –£–¥–≤–æ–∏—Ç—å –≤—Å–µ –ø–æ—Ä—Ç—ã
doubled = [p * 2 for p in ports]
# [160, 44, 886, 42, 16160, 6612]

# –ö–æ–º–±–∏–Ω–∞—Ü–∏—è: –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –∏ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å
result = [f"port_{p}" for p in ports if p < 1024]
# ["port_80", "port_22", "port_443", "port_21"]

# –í–ª–æ–∂–µ–Ω–Ω—ã–µ list comprehensions
# –ü—Ä–∏–º–µ—Ä: –≤—Å–µ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ —Ö–æ—Å—Ç:–ø–æ—Ä—Ç
hosts = ["192.168.1.1", "192.168.1.2"]
scan_ports = [80, 443, 22]
targets = [f"{h}:{p}" for h in hosts for p in scan_ports]
# ["192.168.1.1:80", "192.168.1.1:443", ..., "192.168.1.2:22"]

# Dictionary Comprehension
services = {80: "http", 443: "https", 22: "ssh", 21: "ftp"}
# –ü–µ—Ä–µ–≤–µ—Ä–Ω—É—Ç—å —Å–ª–æ–≤–∞—Ä—å
reversed_services = {v: k for k, v in services.items()}
# {"http": 80, "https": 443, ...}

# –û—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å —Å–ª–æ–≤–∞—Ä—å
privileged_services = {p: s for p, s in services.items() if p < 1024}

# Set Comprehension
unique_first_octets = {ip.split(".")[0] for ip in ["192.168.1.1", "192.168.1.2", "10.0.0.1"]}
# {"192", "10"}

# –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä—ã ‚Äî –∫–∞–∫ list comprehension, –Ω–æ –ª–µ–Ω–∏–≤—ã–µ (–Ω–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç –≤—Å—ë –≤ –ø–∞–º—è—Ç—å)
# –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥–ª—è –±–æ–ª—å—à–∏—Ö —Ñ–∞–π–ª–æ–≤ –ª–æ–≥–æ–≤!
large_log = (line.strip() for line in open("access.log"))  # —á–∏—Ç–∞–µ—Ç –ø–æ—Å—Ç—Ä–æ—á–Ω–æ
for line in large_log:
    process(line)  # –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø–æ –æ–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–µ

# –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–∏–º–µ—Ä: –ø–∞—Ä—Å–∏–Ω–≥ –ø–æ—Ä—Ç–æ–≤ –∏–∑ nmap –≤—ã–≤–æ–¥–∞
nmap_output = "22/tcp open ssh\n80/tcp open http\n443/tcp open https\n8080/tcp closed http-proxy"
open_ports = [
    int(line.split("/")[0])
    for line in nmap_output.strip().split("\n")
    if "open" in line
]
# [22, 80, 443]
```

---

## 4.1.9 –û–±—ä–µ–∫—Ç–Ω–æ-–æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ

```php
<?php
// PHP –∫–ª–∞—Å—Å
class PortScanner {
    private string $host;
    private int $timeout;
    private array $openPorts = [];
    
    public function __construct(string $host, int $timeout = 1) {
        $this->host = $host;
        $this->timeout = $timeout;
    }
    
    public function scan(int $port): bool {
        // –ª–æ–≥–∏–∫–∞ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
        return false;
    }
    
    public function getOpenPorts(): array {
        return $this->openPorts;
    }
    
    public function __toString(): string {
        return "Scanner for {$this->host}";
    }
}

// –ù–∞—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ
class StealthScanner extends PortScanner {
    public function scan(int $port): bool {
        // —Å—Ç–µ–ª—Å-—Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
        return parent::scan($port);
    }
}
```

```python
# Python –∫–ª–∞—Å—Å
class PortScanner:
    # –ê—Ç—Ä–∏–±—É—Ç –∫–ª–∞—Å—Å–∞ (–Ω–µ —ç–∫–∑–µ–º–ø–ª—è—Ä–∞) ‚Äî –æ–±—â–∏–π –¥–ª—è –≤—Å–µ—Ö –æ–±—ä–µ–∫—Ç–æ–≤
    DEFAULT_TIMEOUT = 1.0
    
    def __init__(self, host: str, timeout: float = 1.0):
        # –ê—Ç—Ä–∏–±—É—Ç—ã —ç–∫–∑–µ–º–ø–ª—è—Ä–∞
        self.host = host           # –Ω–µ—Ç private/public ‚Äî —Å–æ–≥–ª–∞—à–µ–Ω–∏–µ
        self.timeout = timeout
        self._open_ports = []      # _ –æ–∑–Ω–∞—á–∞–µ—Ç "—É—Å–ª–æ–≤–Ω–æ –ø—Ä–∏–≤–∞—Ç–Ω—ã–π"
        self.__secret = "hidden"   # __ –æ–∑–Ω–∞—á–∞–µ—Ç name mangling
    
    def scan(self, port: int) -> bool:
        """–ü—Ä–æ–≤–µ—Ä—è–µ—Ç, –æ—Ç–∫—Ä—ã—Ç –ª–∏ –ø–æ—Ä—Ç."""
        # –ª–æ–≥–∏–∫–∞ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
        return False
    
    def scan_range(self, start: int, end: int) -> list:
        return [p for p in range(start, end + 1) if self.scan(p)]
    
    @property
    def open_ports(self):
        """–°–≤–æ–π—Å—Ç–≤–æ ‚Äî –∫–∞–∫ getter –≤ PHP."""
        return self._open_ports.copy()
    
    @open_ports.setter
    def open_ports(self, ports):
        """Setter."""
        self._open_ports = ports
    
    @classmethod
    def from_hostname(cls, hostname: str):
        """–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä."""
        import socket
        ip = socket.gethostbyname(hostname)
        return cls(ip)
    
    @staticmethod
    def is_valid_port(port: int) -> bool:
        """–°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π –º–µ—Ç–æ–¥ ‚Äî –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç self."""
        return 1 <= port <= 65535
    
    def __str__(self) -> str:
        """–ê–Ω–∞–ª–æ–≥ __toString() –≤ PHP."""
        return f"PortScanner(host={self.host})"
    
    def __repr__(self) -> str:
        """–ü—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏."""
        return f"PortScanner(host='{self.host}', timeout={self.timeout})"
    
    def __len__(self) -> int:
        """–ü–æ–∑–≤–æ–ª—è–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å len(scanner)."""
        return len(self._open_ports)


# –ù–∞—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ
class StealthScanner(PortScanner):
    def __init__(self, host: str, delay: float = 0.5):
        super().__init__(host)  # –≤—ã–∑–æ–≤ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–≥–æ __init__
        self.delay = delay
    
    def scan(self, port: int) -> bool:
        import time
        time.sleep(self.delay)  # –ø–∞—É–∑–∞ –º–µ–∂–¥—É —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è–º–∏
        return super().scan(port)


# –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ –Ω–∞—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ (—É–Ω–∏–∫–∞–ª—å–Ω–æ –¥–ª—è Python)
class Logging:
    def log(self, message: str):
        print(f"[LOG] {message}")

class NetworkScanner(PortScanner, Logging):
    def scan(self, port: int) -> bool:
        self.log(f"Scanning port {port}")
        return super().scan(port)


# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
scanner = PortScanner("192.168.1.1")
scanner.scan(80)
print(scanner)               # PortScanner(host=192.168.1.1)
print(repr(scanner))         # PortScanner(host='192.168.1.1', timeout=1.0)

# –°–æ–∑–¥–∞–Ω–∏–µ —á–µ—Ä–µ–∑ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä
scanner2 = PortScanner.from_hostname("example.com")

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–ª–∞—Å—Å–∞
isinstance(scanner, PortScanner)   # True
type(scanner).__name__             # "PortScanner"

# Dataclasses ‚Äî —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π —Å–ø–æ—Å–æ–± —Å–æ–∑–¥–∞–Ω–∏—è –ø—Ä–æ—Å—Ç—ã—Ö –∫–ª–∞—Å—Å–æ–≤ –¥–∞–Ω–Ω—ã—Ö
from dataclasses import dataclass, field
from typing import List

@dataclass
class ScanResult:
    ip: str
    open_ports: List[int] = field(default_factory=list)
    hostname: str = ""
    os: str = "Unknown"
    
    def is_alive(self) -> bool:
        return len(self.open_ports) > 0

result = ScanResult(ip="192.168.1.1", open_ports=[22, 80, 443])
print(result)  # ScanResult(ip='192.168.1.1', open_ports=[22, 80, 443], ...)
```

---

## 4.1.10 –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–π

```php
<?php
// PHP –∏—Å–∫–ª—é—á–µ–Ω–∏—è
try {
    $connection = new PDO($dsn, $user, $pass);
    if (!$socket = fsockopen($host, $port, $errno, $errstr, $timeout)) {
        throw new RuntimeException("Connection failed: $errstr");
    }
} catch (PDOException $e) {
    echo "Database error: " . $e->getMessage();
} catch (RuntimeException $e) {
    echo "Runtime error: " . $e->getMessage();
} catch (Exception $e) {
    echo "General error: " . $e->getMessage();
} finally {
    echo "Always executed";
}
```

```python
# Python –∏—Å–∫–ª—é—á–µ–Ω–∏—è
import socket

try:
    sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    sock.settimeout(1)
    result = sock.connect(("192.168.1.1", 80))
except socket.timeout:
    print("Connection timed out")
except ConnectionRefusedError:
    print("Connection refused")
except socket.gaierror as e:
    print(f"DNS error: {e}")
except OSError as e:
    print(f"OS error: {e}")
except Exception as e:
    print(f"Unexpected error: {type(e).__name__}: {e}")
finally:
    sock.close()  # –≤—Å–µ–≥–¥–∞ –∑–∞–∫—Ä—ã–≤–∞—Ç—å —Å–æ–∫–µ—Ç!

# –°–æ–∑–¥–∞–Ω–∏–µ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∏—Å–∫–ª—é—á–µ–Ω–∏–π
class SecurityToolError(Exception):
    """–ë–∞–∑–æ–≤–æ–µ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ –¥–ª—è –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏."""
    pass

class InvalidTargetError(SecurityToolError):
    """–ù–µ–¥–æ–ø—É—Å—Ç–∏–º–∞—è —Ü–µ–ª—å –¥–ª—è —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è."""
    def __init__(self, target: str, reason: str):
        self.target = target
        self.reason = reason
        super().__init__(f"Invalid target '{target}': {reason}")

class ScanTimeoutError(SecurityToolError):
    pass

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
try:
    raise InvalidTargetError("localhost", "loopback addresses not allowed")
except InvalidTargetError as e:
    print(f"Target error: {e}")
    print(f"Target was: {e.target}")

# Context managers (with) ‚Äî –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤
# –ê–Ω–∞–ª–æ–≥ try/finally –≤ PHP
with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as sock:
    sock.settimeout(1)
    try:
        sock.connect(("192.168.1.1", 80))
        print("Port 80 is open")
    except (socket.timeout, ConnectionRefusedError):
        print("Port 80 is closed")
# sock.close() –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏!

# –ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –∏—Å–∫–ª—é—á–µ–Ω–∏–π (–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ—Å—Ç–æ—Ä–æ–∂–Ω–æ!)
try:
    result = int("not a number")
except ValueError:
    pass  # pass ‚Äî –ø—É—Å—Ç–æ–π –±–ª–æ–∫ (–≤ PHP –ø—Ä–æ—Å—Ç–æ {})

# contextlib.suppress ‚Äî –±–æ–ª–µ–µ –ø–∏—Ç–æ–Ω–∏—á–µ—Å–∫–∏–π —Å–ø–æ—Å–æ–± –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏—è
from contextlib import suppress
with suppress(ValueError, TypeError):
    result = int("not a number")
```

---

## 4.1.11 –†–∞–±–æ—Ç–∞ —Å —Ñ–∞–π–ª–∞–º–∏

```php
<?php
// PHP —Ñ–∞–π–ª–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
$content = file_get_contents("/etc/passwd");
file_put_contents("/tmp/report.txt", $content);

$handle = fopen("/var/log/auth.log", "r");
while (($line = fgets($handle)) !== false) {
    process($line);
}
fclose($handle);

$lines = file("/var/log/syslog", FILE_IGNORE_NEW_LINES);
```

```python
# Python —Ñ–∞–π–ª–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏

# –ß—Ç–µ–Ω–∏–µ –≤—Å–µ–≥–æ —Ñ–∞–π–ª–∞
with open("/etc/passwd", "r") as f:
    content = f.read()

# –ß—Ç–µ–Ω–∏–µ —Å—Ç—Ä–æ–∫ –≤ —Å–ø–∏—Å–æ–∫
with open("/etc/passwd", "r") as f:
    lines = f.readlines()       # —Å —Å–∏–º–≤–æ–ª–∞–º–∏ \n
    lines = f.read().splitlines()  # –±–µ–∑ \n

# –ü–æ—Å—Ç—Ä–æ—á–Ω–æ–µ —á—Ç–µ–Ω–∏–µ (—ç–∫–æ–Ω–æ–º–∏—Ç –ø–∞–º—è—Ç—å –¥–ª—è –±–æ–ª—å—à–∏—Ö –ª–æ–≥–æ–≤!)
with open("/var/log/auth.log", "r") as f:
    for line in f:              # f ‚Äî –∏—Ç–µ—Ä–∏—Ä—É–µ–º—ã–π –æ–±—ä–µ–∫—Ç!
        print(line.strip())

# –ó–∞–ø–∏—Å—å –≤ —Ñ–∞–π–ª
with open("/tmp/report.txt", "w") as f:    # w ‚Äî –ø–µ—Ä–µ–∑–∞–ø–∏—Å—å
    f.write("Scan Report\n")
    f.write("=" * 40 + "\n")

with open("/tmp/report.txt", "a") as f:    # a ‚Äî –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ
    f.write("Additional data\n")

# –ó–∞–ø–∏—Å—å –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Å—Ç—Ä–æ–∫
lines = ["192.168.1.1 - open\n", "192.168.1.2 - closed\n"]
with open("/tmp/ips.txt", "w") as f:
    f.writelines(lines)
    # –∏–ª–∏:
    # f.write("\n".join(lines))

# –ö–æ–¥–∏—Ä–æ–≤–∫–∞ ‚Äî –≤–∞–∂–Ω–æ –¥–ª—è –ª–æ–≥–æ–≤ —Å –∫–∏—Ä–∏–ª–ª–∏—Ü–µ–π
with open("log.txt", "r", encoding="utf-8", errors="ignore") as f:
    content = f.read()

# –î–≤–æ–∏—á–Ω—ã–π —Ä–µ–∂–∏–º ‚Äî –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º–∏ —Ñ–∞–π–ª–∞–º–∏
with open("/usr/bin/ssh", "rb") as f:
    header = f.read(4)
    print(header.hex())  # "7f454c46" ‚Äî ELF magic bytes

# pathlib ‚Äî —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π —Å–ø–æ—Å–æ–± —Ä–∞–±–æ—Ç—ã —Å –ø—É—Ç—è–º–∏ (Python 3.6+)
from pathlib import Path

log_dir = Path("/var/log")
auth_log = log_dir / "auth.log"    # –æ–ø–µ—Ä–∞—Ç–æ—Ä / –¥–ª—è –ø—É—Ç–µ–π!

print(auth_log.exists())           # True/False
print(auth_log.is_file())
print(auth_log.stat().st_size)     # —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞
print(auth_log.name)               # "auth.log"
print(auth_log.stem)               # "auth"
print(auth_log.suffix)             # ".log"
print(auth_log.parent)             # Path("/var/log")

# –ü–µ—Ä–µ–±–æ—Ä —Ñ–∞–π–ª–æ–≤ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
log_dir = Path("/var/log")
for log_file in log_dir.glob("*.log"):
    print(log_file)

# –†–µ–∫—É—Ä—Å–∏–≤–Ω—ã–π –ø–æ–∏—Å–∫
for log_file in log_dir.rglob("*.log"):
    print(log_file)

# –°–æ–∑–¥–∞–Ω–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π
Path("/tmp/security/reports").mkdir(parents=True, exist_ok=True)

# –ß—Ç–µ–Ω–∏–µ/–∑–∞–ø–∏—Å—å —á–µ—Ä–µ–∑ pathlib
content = Path("/etc/passwd").read_text()
Path("/tmp/output.txt").write_text("Hello\n")
```

---

## 4.1.12 –ú–æ–¥—É–ª–∏ –∏ –ø–∞–∫–µ—Ç—ã

```php
<?php
// PHP –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤
require_once 'scanner.php';
include 'utils.php';

// Composer autoload
require_once 'vendor/autoload.php';
use App\Security\Scanner;
```

```python
# Python –∏–º–ø–æ—Ä—Ç –º–æ–¥—É–ª–µ–π

# –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞
import os
import sys
import socket
import re
import json
import csv
import hashlib
import datetime
import threading
from pathlib import Path

# –ò–º–ø–æ—Ä—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤
from datetime import datetime, timedelta
from collections import defaultdict, Counter, OrderedDict
from typing import List, Dict, Optional

# –ò–º–ø–æ—Ä—Ç —Å –ø—Å–µ–≤–¥–æ–Ω–∏–º–æ–º
import socket as sock
from datetime import datetime as dt

# –°–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π –º–æ–¥—É–ª—å
# –§–∞–π–ª: tools/scanner.py
# –ò–º–ø–æ—Ä—Ç: from tools.scanner import PortScanner
# –∏–ª–∏: import tools.scanner

# –£—Å–ª–æ–≤–Ω—ã–π –∏–º–ø–æ—Ä—Ç
try:
    import requests
except ImportError:
    print("Please install requests: pip install requests")
    sys.exit(1)

# –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ Python ‚Äî –±–æ–≥–∞—Ç–µ–π—à–∏–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞—Ä–∏–π
import hashlib
# MD5, SHA1, SHA256 –±–µ–∑ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫
md5 = hashlib.md5(b"hello").hexdigest()
sha256 = hashlib.sha256(b"password").hexdigest()

import base64
encoded = base64.b64encode(b"secret data")
decoded = base64.b64decode(encoded)

import struct
# –†–∞–±–æ—Ç–∞ —Å –±–∏–Ω–∞—Ä–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ (–ø–æ–ª–µ–∑–Ω–æ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–≤)
packed = struct.pack(">HH", 80, 443)  # big-endian –¥–≤–∞ uint16
port1, port2 = struct.unpack(">HH", packed)

import subprocess
# –ó–∞–ø—É—Å–∫ –≤–Ω–µ—à–Ω–∏—Ö –∫–æ–º–∞–Ω–¥
result = subprocess.run(
    ["nmap", "-sV", "192.168.1.1"],
    capture_output=True,
    text=True,
    timeout=60
)
print(result.stdout)
print(result.returncode)

# __name__ ‚Äî –∏–¥–∏–æ–º–∞ –∑–∞—â–∏—Ç—ã –æ—Ç –Ω–µ–ø—Ä–µ–¥–Ω–∞–º–µ—Ä–µ–Ω–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞
# (–∞–Ω–∞–ª–æ–≥ –Ω–µ—Ç –≤ PHP, –Ω–æ –∫–æ–Ω—Ü–µ–ø—Ç—É–∞–ª—å–Ω–æ –ø–æ—Ö–æ–∂–µ –Ω–∞ index.php –ø—Ä–æ–≤–µ—Ä–∫–∏)
if __name__ == "__main__":
    # –≠—Ç–æ—Ç –∫–æ–¥ –≤—ã–ø–æ–ª–Ω–∏—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –ø—Ä—è–º–æ–º –∑–∞–ø—É—Å–∫–µ,
    # –Ω–µ –ø—Ä–∏ –∏–º–ø–æ—Ä—Ç–µ –º–æ–¥—É–ª—è
    main()
```

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–∞–∫–µ—Ç–∞ Python

```python
# tools/__init__.py ‚Äî –¥–µ–ª–∞–µ—Ç –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –ø–∞–∫–µ—Ç–æ–º
"""
Security tools package.
"""
from .scanner import PortScanner
from .parser import LogParser
from .reporter import Report

__version__ = "1.0.0"
__all__ = ["PortScanner", "LogParser", "Report"]

# tools/scanner.py
class PortScanner:
    pass

# tools/parser.py
class LogParser:
    pass

# main.py ‚Äî —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞
from tools import PortScanner, LogParser

def main():
    scanner = PortScanner("192.168.1.1")
    # ...

if __name__ == "__main__":
    main()
```

---

## 4.1.13 –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

```python
# collections ‚Äî –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö
from collections import Counter, defaultdict

# Counter ‚Äî –ø–æ–¥—Å—á—ë—Ç —ç–ª–µ–º–µ–Ω—Ç–æ–≤
log_lines = ["192.168.1.1", "10.0.0.1", "192.168.1.1", "192.168.1.1"]
ip_counts = Counter(log_lines)
print(ip_counts.most_common(3))  # —Ç–æ–ø-3 IP –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É

# defaultdict ‚Äî —Å–ª–æ–≤–∞—Ä—å —Å –∑–Ω–∞—á–µ–Ω–∏–µ–º –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
attacks = defaultdict(list)
attacks["192.168.1.1"].append("ssh")  # –Ω–µ –Ω—É–∂–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ –∫–ª—é—á–∞
attacks["192.168.1.1"].append("http")

# datetime ‚Äî —Ä–∞–±–æ—Ç–∞ —Å –¥–∞—Ç–∞–º–∏ –∏ –≤—Ä–µ–º–µ–Ω–µ–º
from datetime import datetime, timedelta
import time

now = datetime.now()
print(now.strftime("%Y-%m-%d %H:%M:%S"))

# –ü–∞—Ä—Å–∏–Ω–≥ –≤—Ä–µ–º–µ–Ω–Ω–æ–π –º–µ—Ç–∫–∏ –∏–∑ –ª–æ–≥–∞
log_time = datetime.strptime("2024-01-15 10:30:45", "%Y-%m-%d %H:%M:%S")
log_timestamp = log_time.timestamp()  # Unix timestamp

# –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –≤—Ä–µ–º—ë–Ω
one_hour_ago = datetime.now() - timedelta(hours=1)
if log_time > one_hour_ago:
    print("Recent event!")

# ipaddress ‚Äî —Ä–∞–±–æ—Ç–∞ —Å IP-–∞–¥—Ä–µ—Å–∞–º–∏ –∏ –ø–æ–¥—Å–µ—Ç—è–º–∏
import ipaddress

ip = ipaddress.ip_address("192.168.1.1")
network = ipaddress.ip_network("192.168.1.0/24")

print(ip in network)          # True
print(network.network_address)  # 192.168.1.0
print(network.broadcast_address)  # 192.168.1.255
print(list(network.hosts())[:5])  # –ø–µ—Ä–≤—ã–µ 5 —Ö–æ—Å—Ç–æ–≤

# –ü–µ—Ä–µ–±–æ—Ä –≤—Å–µ—Ö IP –≤ –ø–æ–¥—Å–µ—Ç–∏
for host_ip in network.hosts():
    print(host_ip)

# hashlib ‚Äî —Ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ
import hashlib

def hash_file(filepath: str) -> dict:
    """–í—ã—á–∏—Å–ª–∏—Ç—å MD5, SHA1, SHA256 —Ñ–∞–π–ª–∞."""
    hashes = {
        "md5": hashlib.md5(),
        "sha1": hashlib.sha1(),
        "sha256": hashlib.sha256()
    }
    with open(filepath, "rb") as f:
        for chunk in iter(lambda: f.read(8192), b""):
            for h in hashes.values():
                h.update(chunk)
    return {name: h.hexdigest() for name, h in hashes.items()}

# argparse ‚Äî —Ä–∞–∑–±–æ—Ä –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏
import argparse

parser = argparse.ArgumentParser(
    description="Security Scanner Tool",
    formatter_class=argparse.RawDescriptionHelpFormatter
)
parser.add_argument("target", help="Target IP or hostname")
parser.add_argument("-p", "--ports", default="1-1024",
                    help="Port range (default: 1-1024)")
parser.add_argument("-t", "--timeout", type=float, default=1.0,
                    help="Connection timeout in seconds")
parser.add_argument("-v", "--verbose", action="store_true",
                    help="Enable verbose output")
parser.add_argument("-o", "--output", help="Output file for results")

args = parser.parse_args()
print(args.target)   # "192.168.1.1"
print(args.verbose)  # True/False
```

---

## 4.1.14 –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—ã–≤–æ–¥–∞ –¥–ª—è –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

```python
# colorama ‚Äî —Ü–≤–µ—Ç–Ω–æ–π –≤—ã–≤–æ–¥ (—Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ Windows —Ç–æ–∂–µ)
from colorama import Fore, Back, Style, init
init(autoreset=True)  # –∞–≤—Ç–æ—Å–±—Ä–æ—Å —Ü–≤–µ—Ç–∞ –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ print

print(Fore.GREEN + "[+] Port 80 is OPEN")
print(Fore.RED + "[-] Port 81 is CLOSED")
print(Fore.YELLOW + "[*] Scanning...")
print(Fore.CYAN + "[i] Info message")

# tabulate ‚Äî —Ç–∞–±–ª–∏—Ü—ã
from tabulate import tabulate

scan_data = [
    ["192.168.1.1", 22, "SSH", "Open"],
    ["192.168.1.1", 80, "HTTP", "Open"],
    ["192.168.1.1", 443, "HTTPS", "Open"],
]
headers = ["IP", "Port", "Service", "Status"]
print(tabulate(scan_data, headers=headers, tablefmt="grid"))

# –†–µ–∑—É–ª—å—Ç–∞—Ç:
# +-------------+--------+---------+----------+
# | IP          |   Port | Service | Status   |
# +=============+========+=========+==========+
# | 192.168.1.1 |     22 | SSH     | Open     |
# +-------------+--------+---------+----------+
# | 192.168.1.1 |     80 | HTTP    | Open     |
# +-------------+--------+---------+----------+

# –ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä –¥–ª—è –¥–ª–∏—Ç–µ–ª—å–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
from tqdm import tqdm

ports = range(1, 1025)
for port in tqdm(ports, desc="Scanning", unit="port"):
    # scan logic
    pass

# –ü—Ä–æ—Å—Ç–æ–π —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä
def progress_bar(current, total, width=50):
    filled = int(width * current / total)
    bar = "‚ñà" * filled + "‚ñë" * (width - filled)
    percent = current / total * 100
    print(f"\r[{bar}] {percent:.1f}% ({current}/{total})", end="", flush=True)
    if current == total:
        print()  # –ø–µ—Ä–µ–≤–æ–¥ —Å—Ç—Ä–æ–∫–∏ –≤ –∫–æ–Ω—Ü–µ
```

---

## üîß –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –∑–∞–¥–∞–Ω–∏—è

### –ó–∞–¥–∞–Ω–∏–µ 1: –ö–æ–Ω–≤–µ—Ä—Ç–µ—Ä —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞

–ü–µ—Ä–µ–ø–∏—à–∏—Ç–µ —Å–ª–µ–¥—É—é—â–∏–π PHP-–∫–æ–¥ –Ω–∞ Python:

```php
<?php
function analyzeIps(array $logs): array {
    $result = [];
    foreach ($logs as $line) {
        if (preg_match('/(\d{1,3}\.){3}\d{1,3}/', $line, $matches)) {
            $ip = $matches[0];
            $result[$ip] = ($result[$ip] ?? 0) + 1;
        }
    }
    arsort($result);
    return array_slice($result, 0, 10, true);
}
```

### –ó–∞–¥–∞–Ω–∏–µ 2: –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç —Ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è —Ñ–∞–π–ª–æ–≤

–°–æ–∑–¥–∞–π—Ç–µ —Å–∫—Ä–∏–ø—Ç, –∫–æ—Ç–æ—Ä—ã–π:
- –ü—Ä–∏–Ω–∏–º–∞–µ—Ç –ø—É—Ç—å –∫ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –∫–∞–∫ –∞—Ä–≥—É–º–µ–Ω—Ç –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏
- –í—ã—á–∏—Å–ª—è–µ—Ç SHA256 –≤—Å–µ—Ö —Ñ–∞–π–ª–æ–≤ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
- –í—ã–≤–æ–¥–∏—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ —Ç–∞–±–ª–∏—Ü–µ (—Å tabulate)
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ JSON —Ñ–∞–π–ª

### –ó–∞–¥–∞–Ω–∏–µ 3: –ê–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä –ø–∞—Ä–æ–ª–µ–π

–ù–∞–ø–∏—à–∏—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é `analyze_password(password: str) -> dict`, –∫–æ—Ç–æ—Ä–∞—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç:
- –î–ª–∏–Ω—É –ø–∞—Ä–æ–ª—è
- –ù–∞–ª–∏—á–∏–µ –∑–∞–≥–ª–∞–≤–Ω—ã—Ö –±—É–∫–≤, —Ü–∏—Ñ—Ä, —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤
- –û—Ü–µ–Ω–∫—É —Å—Ç–æ–π–∫–æ—Å—Ç–∏ (weak/medium/strong)
- –í—Ä–µ–º—è –ø–µ—Ä–µ–±–æ—Ä–∞ (–ø—Ä–∏–±–ª–∏–∑–∏—Ç–µ–ª—å–Ω–æ–µ)

### –ó–∞–¥–∞–Ω–∏–µ 4: –°–∫–∞–Ω–µ—Ä –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π

–ù–∞–ø–∏—à–∏—Ç–µ –∫–ª–∞—Å—Å `DirectoryScanner`, –∫–æ—Ç–æ—Ä—ã–π:
- –ü—Ä–∏–Ω–∏–º–∞–µ—Ç –∫–æ—Ä–Ω–µ–≤—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é
- –ù–∞—Ö–æ–¥–∏—Ç —Ñ–∞–π–ª—ã —Å –æ–ø–∞—Å–Ω—ã–º–∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è–º–∏ (.php, .sh, .py, .exe)
- –ù–∞—Ö–æ–¥–∏—Ç —Ñ–∞–π–ª—ã —Å –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–º–∏ –∏–º–µ–Ω–∞–º–∏ (backdoor, shell, cmd)
- –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –æ—Ç—á—ë—Ç –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSON

---

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- **–û—Ñ–∏—Ü–∏–∞–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è Python:** https://docs.python.org/3/
- **Python –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–∏–∫–æ–≤:** "Black Hat Python" ‚Äî Justin Seitz
- **Real Python:** https://realpython.com ‚Äî –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞
- **Python Cookbook:** –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ —Ä–µ—Ü–µ–ø—Ç—ã –æ—Ç David Beazley
- **Type Hints:** https://mypy.readthedocs.io
- **PEP 8 ‚Äî Style Guide:** https://pep8.org
- **Python Security:** https://python-security.readthedocs.io

---

## ‚úÖ –ò—Ç–æ–≥–∏ –≥–ª–∞–≤—ã

–í —ç—Ç–æ–π –≥–ª–∞–≤–µ –≤—ã –æ—Å–≤–æ–∏–ª–∏ —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç Python —Å —Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è PHP-—Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞:

| –ö–æ–Ω—Ü–µ–ø—Ü–∏—è | PHP | Python |
|-----------|-----|--------|
| –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ | `$var` | `var` |
| –¢–∏–ø None | `null` | `None` |
| –õ–æ–≥–∏—á–µ—Å–∫–∏–µ | `true/false` | `True/False` |
| –°—Ç—Ä–æ–∫–∞ –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö | `"Hello $name"` | `f"Hello {name}"` |
| –ú–∞—Å—Å–∏–≤ | `array()` / `[]` | `list` / `[]` |
| –ê—Å—Å–æ—Ü–∏–∞—Ç–∏–≤–Ω—ã–π –º–∞—Å—Å–∏–≤ | `["key" => "val"]` | `{"key": "val"}` |
| –¶–∏–∫–ª –ø–æ –º–∞—Å—Å–∏–≤—É | `foreach` | `for item in list` |
| –§—É–Ω–∫—Ü–∏—è | `function foo($x)` | `def foo(x):` |
| –ö–ª–∞—Å—Å –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä | `__construct()` | `__init__()` |
| –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Ñ–∞–π–ª–∞ | `require_once` | `import` |
| –ë–ª–æ–∫ –∫–æ–¥–∞ | `{}` | `:` + –æ—Ç—Å—Ç—É–ø—ã |

**–ö–ª—é—á–µ–≤—ã–µ –≤—ã–≤–æ–¥—ã:**

1. Python –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –æ—Ç—Å—Ç—É–ø—ã –≤–º–µ—Å—Ç–æ —Ñ–∏–≥—É—Ä–Ω—ã—Ö —Å–∫–æ–±–æ–∫ ‚Äî —ç—Ç–æ –Ω–µ –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ
2. –ù–µ—Ç –∑–Ω–∞–∫–∞ `$` –ø–µ—Ä–µ–¥ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏
3. `True`, `False`, `None` ‚Äî —Å –∑–∞–≥–ª–∞–≤–Ω–æ–π –±—É–∫–≤—ã
4. f-strings ‚Äî —Å–∞–º—ã–π —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –∏ —É–¥–æ–±–Ω—ã–π —Å–ø–æ—Å–æ–± —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
5. List comprehensions –∑–∞–º–µ–Ω—è—é—Ç `array_map` + `array_filter`
6. `with` (context manager) ‚Äî –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥–ª—è —Ñ–∞–π–ª–æ–≤ –∏ —Å–µ—Ç–µ–≤—ã—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
7. –í–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞
8. `__name__ == "__main__"` ‚Äî —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞

–í —Å–ª–µ–¥—É—é—â–µ–π –≥–ª–∞–≤–µ –º—ã –ø–µ—Ä–µ–π–¥—ë–º –∫ –ø—Ä–∞–∫—Ç–∏–∫–µ: —Ä–∞–±–æ—Ç–µ —Å —Å–µ—Ç—å—é —á–µ—Ä–µ–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ `requests` –∏ `socket`.
